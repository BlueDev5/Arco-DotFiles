(()=>{"use strict";var e={3799:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AlgorithmValidator=void 0;var r=n(4471),o=n(4847),i=n(2374),a=n(7379),s="Algorithm",c={category:a.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:1,stop:4294967295,step:1}},u={category:a.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:Number.EPSILON,stop:1-Number.EPSILON}},l={type:u,documentation:"Learning rate for training the Q network (must be between 0 and 1)"},p={type:u,documentation:"Learning rate for training the policy network (must be between 0 and 1)"},d={type:{category:a.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:1e3,stop:2e6}},documentation:"Batch size for training (must be between 1000 and 2000000)"},m={category:a.TypeCategory.String,errorReported:!1,enumeratedConstraint:{items:[{name:"Linear",value:"linear"},{name:"Tanh",value:"tanh"},{name:"Relu",value:"relu"},{name:"Logistic",value:"logistic"},{name:"Softmax",value:"softmax"},{name:"Elu",value:"elu"},{name:"Default",value:"default"}]}},y={category:a.TypeCategory.Struct,errorReported:!1,fields:[{name:"Size",type:c,documentation:"Number of parameters in layer"},{name:"Activation",type:m,optional:!0,documentation:'Activation type (one of "linear", "tanh", "relu", "logistic", "softmax", "elu", or "default")'}]},g={type:{category:a.TypeCategory.Array,errorReported:!1,baseType:y,length:0},documentation:"Array of hidden layer descriptors"},h={fields:{QHiddenLayers:g,PolicyHiddenLayers:g},emitDeprecationWarning:!1,supportsDiscreteOutput:!1,supportsContinuousOutput:!0,supportsSelectorConcepts:!1},f={APEX:{fields:{HiddenLayers:g,QLearningRate:l},emitDeprecationWarning:!1,supportsDiscreteOutput:!0,supportsContinuousOutput:!1,supportsSelectorConcepts:!0},PPO:{fields:{HiddenLayers:g,PolicyLearningRate:p,BatchSize:d},emitDeprecationWarning:!1,supportsDiscreteOutput:!1,supportsContinuousOutput:!0,supportsSelectorConcepts:!1},SAC:h,CQLSAC:h},T={fields:{MemoryMode:{type:{category:a.TypeCategory.String,errorReported:!1,enumeratedConstraint:{items:[{name:"Default",value:"default"},{name:"None",value:"none"},{name:"State",value:"state"},{name:"StateAndAction",value:"state and action"}]}},documentation:'Which information from past iterations will be used as an implicit input (one of "default", "none", "state", or "state and action")'}}},v=function(){function e(){}return e.getAlgorithmFieldValue=function(e){var t=e.value.get(s);if(void 0!==t&&!t.errorReported&&t.category===a.TypeCategory.String)return t.value},e.getExpectedType=function(e){var t=[];if(Object.keys(T.fields).forEach((function(e){var n=T.fields[e];t.push({name:e,type:n.type,optional:!0,documentation:n.documentation})})),void 0===e)t.push({name:s,type:{category:a.TypeCategory.String,errorReported:!1}});else{var n=f[e];if(!n)return;Object.keys(n.fields).forEach((function(e){var r=n.fields[e];t.push({name:e,type:r.type,optional:!0,documentation:r.documentation})}))}return{category:a.TypeCategory.Struct,errorReported:!1,fields:t}},e.validateAlgorithmValue=function(e,t,n,r,c){var u,l,p=this,d=t.value.get(s),m=new Map,y=!0;if(t.value.forEach((function(t,n){var r=T.fields[n];r&&(p._validateAlgorithmField(e,t,r.type,n,c)||(y=!1),m.set(n,t))})),d){if(d.errorReported)return!1;if(d.category!==a.TypeCategory.String)return c.onWarning("Algorithm field must be a string value",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),!1;if(m.set(s,d),u=f[d.value],l=d.value,!u)return c.onWarning("'"+d.value+"' is not a known algorithm",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),!1;r&&!u.supportsSelectorConcepts&&(c.onWarning("Algorithm '"+l+"' does not support concept selection; this algorithm hint will be ignored",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),y=!1),i.TypeChecker.isTypeDiscrete(n)&&!u.supportsDiscreteOutput&&(c.onWarning("Algorithm '"+l+"' does not support outputs with nominal types; an example nominal type is 'number<Up = 0, Down = 1>'",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),y=!1),i.TypeChecker.isTypeContinuous(n)&&!u.supportsContinuousOutput&&(c.onWarning("Algorithm '"+l+"' supports outputs with nominal types only; an example nominal type is 'number<Up = 0, Down = 1>'",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),y=!1),u.emitDeprecationWarning&&c.onWarning("Algorithm '"+l+"' will be deprecated soon — new algorithm selection is recommended",o.ParseNodeUtils.getBestErrorNodeForField(e,s))}return t.value.forEach((function(n,r){if(!m.has(r)){var i=t.value.get(r),a=u?u.fields[r]:void 0;if(a)p._validateAlgorithmField(e,i,a.type,r,c)||(y=!1);else{var s="'"+r+"' is not a supported field";l&&(s+=" for algorithm '"+l+"'"),c.onWarning(s,o.ParseNodeUtils.getBestErrorNodeForField(e,r)),y=!1}}})),y},e._validateAlgorithmField=function(e,t,n,a,s){if(!i.TypeChecker.isValueAssignableToType(t,n)){var c=new r.DiagnosticAddendum;return c.addMessage("Expected type '"+i.TypeChecker.printType(n)+"'"),s.onWarning("Value for field '"+a+"' is incorrect type"+c.getString(),o.ParseNodeUtils.getBestErrorNodeForField(e,a)),!1}return!0},e}();t.AlgorithmValidator=v},2723:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Analyzer=void 0;var r=n(2250),o=n(4471),i=n(222),a=n(7585),s=n(3649),c=n(6155),u=n(4408),l=n(9948),p=n(2374),d=new o.TextPosition(0,0),m=new o.TextRange(d,d),y=function(){function e(e,t,n){var a=this;this._addError=function(e,t){a._addDiagnostic(e,t,o.DiagnosticType.AnalyzerError)},this._addWarning=function(e,t){a._addDiagnostic(e,t,o.DiagnosticType.Warning)},this._addUnreferencedCode=function(e,t){a._addDiagnostic(e,t,o.DiagnosticType.UnreferencedCode)},this._parseTreeToAnalyze=e.parseTree,this._diagnostics=t,this._compilerOptions=n||new i.CompilerOptions,this._analyzerResult=new r.AnalyzerResult(e,this._compilerOptions)}return e.prototype.analyzeProgram=function(){try{this._validateProgram()}catch(e){this._addDiagnostic("Internal compiler error",void 0,o.DiagnosticType.InternalError)}return this._analyzerResult},e.prototype.analyzeConstantExpression=function(e,t,n,r){void 0===t&&(t=a.EvaluationStepAction.Run);var o=this._createSymbolResolverAndContext(e);if(c.isExpressionNode(this._parseTreeToAnalyze)){var i=n||a.ExpressionEvaluator.createInterpreterContext(this._parseTreeToAnalyze,o.symbolContext,r);return a.ExpressionEvaluator.interpretExpression(i,t),i}this._addError("Invalid expression",this._parseTreeToAnalyze)},e.prototype.analyzeTypeExpression=function(e){var t=this._createSymbolResolverAndContext(e);if(c.isTypeNode(this._parseTreeToAnalyze))return p.TypeChecker.getTypeOfTypeNode(this._parseTreeToAnalyze,t.symbolContext);this._addError("Invalid type expression",this._parseTreeToAnalyze)},e.prototype._createSymbolResolverAndContext=function(e){s.setScopeDataForNode(this._parseTreeToAnalyze,{symbolTable:e._globalSymbolTable});var t=new u.SymbolResolver,n=new l.ResolveSymbolContext(this._addError,this._addWarning,this._addUnreferencedCode,this._compilerOptions,e._globalSymbolTable);return n.setResolver((function(e){return t.resolveSymbol(e,n)})),{symbolResolver:t,symbolContext:n}},e.prototype._addGlobalSymbol=function(e,t){var n={name:e.name.text,category:t,node:e,referenced:!1};return e.name.text&&(this._analyzerResult._globalSymbolTable.lookUpSymbol(e.name.text)?this._addError("Duplicate name '"+e.name.text+"' not allowed",e.name):this._analyzerResult._globalSymbolTable.addSymbol(n)),n},e.prototype._addGlobalReservedSymbol=function(e,t,n){var r={name:e,category:n,node:t,referenced:!1};return this._analyzerResult._globalSymbolTable.lookUpSymbol(e,!0)||this._analyzerResult._globalSymbolTable.addSymbol(r,!0),r},e.prototype._validateProgram=function(){var e=this,t=[],n=!1,r=this._createSymbolResolverAndContext(this._analyzerResult);this._parseTreeToAnalyze.type===c.ParseNodeType.Program?(this._parseTreeToAnalyze.statements.forEach((function(r){var o,i;switch(r.type){case c.ParseNodeType.Using:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Namespace));break;case c.ParseNodeType.Type:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Type));break;case c.ParseNodeType.Const:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Const));break;case c.ParseNodeType.Concept:var a=e._addGlobalSymbol(r,l.SymbolCategory.Concept);t.push(a),e._addWarning("Concepts must be declared within a graph statement",a.node.name),a.referenced=!0;break;case c.ParseNodeType.Simulator:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Simulator));break;case c.ParseNodeType.Data:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Data));break;case c.ParseNodeType.Function:t.push(e._addGlobalSymbol(r,l.SymbolCategory.Function));break;case c.ParseNodeType.Experiment:t.push(e._addGlobalReservedSymbol("experiment",r,l.SymbolCategory.Experiment));break;case c.ParseNodeType.Graph:var s=r;t.push(e._addGlobalReservedSymbol("graph_input",s,l.SymbolCategory.GraphInput)),t.push(e._addGlobalReservedSymbol("graph_output",s,l.SymbolCategory.GraphOutput)),n=!0,s.concepts.forEach((function(n){t.push(e._addGlobalSymbol(n,l.SymbolCategory.Concept))})),(null===(o=s.output)||void 0===o?void 0:o.outputSource.type)===c.ParseNodeType.Concept&&(a=e._addGlobalSymbol(null===(i=s.output)||void 0===i?void 0:i.outputSource,l.SymbolCategory.Concept),t.push(a),a.referenced=!0),e._compilerOptions.enableMultipleConcepts||s.concepts.length>1&&s.concepts.forEach((function(t){e._addError("We are redesigning how we handle brains with multiple concepts to improve usability. We would love to hear about your multi-concept use cases. Please contact victor.shnayder@microsoft.com.",t.name)}))}})),t.forEach((function(e){r.symbolContext.resolveSymbol(e,!1)})),t.forEach((function(e){r.symbolResolver.conditionallyReportUnreferencedSymbol(e,r.symbolContext)})),n||this._addDiagnostic("Graph statement is missing",void 0,o.DiagnosticType.AnalyzerError)):this._addError("Invalid program",this._parseTreeToAnalyze)},e.prototype._addDiagnostic=function(e,t,n){var r=t instanceof o.TextRange?t:t?t.range:m;this._diagnostics.push(new o.Diagnostic(r,e,n))},e}();t.Analyzer=y},2250:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerResult=t.ConceptCategory=t.DefaultNoProgressIterationLimit=t.DefaultAssessmentWindow=t.DefaultSuccessThreshold=t.DefaultEpisodeIterationLimit=t.DefaultTotalIterationLimit=void 0;var a=n(2357),s=n(2723),c=n(4471),u=n(7585),l=n(8312),p=n(6155),d=n(4847),m=n(785),y=n(9539),g=n(814),h=n(6172),f=n(9371),T=n(9948),v=n(9554),_=n(4393),C=n(8240),b=n(2374),k=n(7379),S=n(8240);Object.defineProperty(t,"DefaultTotalIterationLimit",{enumerable:!0,get:function(){return S.DefaultTotalIterationLimit}}),Object.defineProperty(t,"DefaultEpisodeIterationLimit",{enumerable:!0,get:function(){return S.DefaultEpisodeIterationLimit}}),Object.defineProperty(t,"DefaultSuccessThreshold",{enumerable:!0,get:function(){return S.DefaultSuccessThreshold}}),Object.defineProperty(t,"DefaultAssessmentWindow",{enumerable:!0,get:function(){return S.DefaultAssessmentWindow}}),Object.defineProperty(t,"DefaultNoProgressIterationLimit",{enumerable:!0,get:function(){return S.DefaultNoProgressIterationLimit}});var x,N=new c.TextPosition(0,0),R=new c.TextRange(N,N),E="#! ";!function(e){e[e.Learned=1]="Learned",e[e.Programmed=2]="Programmed",e[e.Imported=3]="Imported"}(x=t.ConceptCategory||(t.ConceptCategory={}));var P=function(){function e(e,t,n){this._globalSymbolTable=new f.SymbolTable,this._parseResult=e,this._compilerOptions=t,this._editedParseResult=n}return e.prototype.isGlobalSymbolDefined=function(e){var t=this._globalSymbolTable.lookUpSymbol(e);return!!(null==t?void 0:t.symbol)},e.prototype.getInklingLanguageVersion=function(){var e="";return this._parseResult.parseTree.type===p.ParseNodeType.Program&&this._parseResult.parseTree.inklingVersion&&(e=this._parseResult.parseTree.inklingVersion.versionString.value),e},e.prototype.getConcepts=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Concept).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getConcept=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Concept)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.prototype.getGlobalFunctions=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Function).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getGlobalFunction=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Function)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.prototype.getGlobalSimulators=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Simulator).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getGlobalSimulator=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Simulator)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.prototype.getGlobalDatas=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Data).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getGlobalData=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Data)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.prototype.getGlobalTypeDefinitions=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Type).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getGlobalTypeDefinition=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Type)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.prototype.getGlobalExperiment=function(){var e=this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Experiment,!0);if(e.length>0)return e[0].resolvedObject},e.prototype.getGraph=function(){if(this._parseResult.parseTree.type===p.ParseNodeType.Program){var e=this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.GraphInput,!0);if(0!==e.length){var t=e[0].resolvedObject,n=this._parseResult.parseTree.statements.find((function(e){return e.type===p.ParseNodeType.Graph}));if(n){var r={errorReported:t.errorReported,comments:t.node.comments,node:n,input:t},o=this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.GraphOutput,!0);return o.length>0&&(r.output=o[0].resolvedObject,r.output.errorReported&&(r.errorReported=!0)),r}}}},e.prototype.getGlobalConstants=function(){return this._globalSymbolTable.getSymbolsByCategory(T.SymbolCategory.Const).map((function(e){return e.resolvedObject})).filter((function(e){return void 0!==e}))},e.prototype.getGlobalConstant=function(e){var t,n=this._globalSymbolTable.lookUpSymbol(e);if((null==n?void 0:n.symbol.category)===T.SymbolCategory.Const)return null===(t=null==n?void 0:n.symbol)||void 0===t?void 0:t.resolvedObject},e.printEvaluatedType=function(e,t){return void 0===t&&(t=!0),b.TypeChecker.printType(e,t)},e.printTypeExpression=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),e.node?new g.Printer({omitComments:t,compactOutput:n}).printNode(e.node):b.TypeChecker.printType(e)},e.flattenType=function(e){return b.TypeChecker.flattenType(e)},e.unflattenType=function(e){return b.TypeChecker.unflattenType(e)},e.isTypeCastable=function(e,t){return b.TypeChecker.isTypeCastable(e,t,new c.DiagnosticAddendum)},e.printExpressionValue=function(e){return u.ExpressionEvaluator.printConstValue(e)},e.flattenValue=function(e){var t=this._convertToMapRecursive(e),n=l.flattenValue(t);return this._convertFromMapRecursive(n)},e.unflattenValue=function(e){var t=this._convertToMapRecursive(e);return this._convertFromMapRecursive(l.unflattenValue(t))},e.getDisplayNameFromFlattenedField=function(e,t){return b.TypeChecker.getDisplayNameFromFlattenedField(e,t)},e.prototype.convertParseTreeToText=function(){return(new g.Printer).printNode(this._parseResult.parseTree)},e.prototype.setSimulatorPackage=function(e,t,n){e.node.objectReference={type:p.ParseNodeType.Package,range:R,comments:n||[],expression:{type:p.ParseNodeType.StringLiteral,range:R,text:v.Tokenizer.encodeStringLiteral(t),value:t}}},e.prototype.removeSimulatorPackage=function(e){e.node.objectReference=void 0},e.prototype.setDataDataset=function(e,t,n){e.node.objectReference={type:p.ParseNodeType.Dataset,range:R,comments:n||[],expression:{type:p.ParseNodeType.StringLiteral,range:R,text:v.Tokenizer.encodeStringLiteral(t),value:t}}},e.prototype.setSourceName=function(e,t){e.node.name={type:p.ParseNodeType.Identifier,range:R,text:t}},e.prototype.setSourceActionType=function(e,t){e.node.actionParam.paramType=t},e.prototype.setSourceConfigType=function(e,t){t?e.node.configParam?e.node.configParam.paramType=t:e.node.configParam={type:p.ParseNodeType.FunctionInput,range:R,name:{type:p.ParseNodeType.Identifier,range:R,text:"config"},paramType:t}:e.node.configParam=void 0},e.prototype.setSourceStateType=function(e,t){e.node.stateType=t},e.prototype.setGraphInputType=function(e,t){e.node.inputType=t},e.prototype.setGraphOutputType=function(e,t){e.node.outputType=t},e.prototype.setConceptOutputType=function(e,t){e.node.outputType=t},e.prototype.setConstType=function(e,t){e.node&&(e.node.constantType=t)},e.prototype.setTypeDefinitionType=function(e,t){e.node&&(e.node.declaredType=t)},e.prototype.setFunctionReturnType=function(e,t){e.node&&(e.node.outputType=t)},e.prototype.setFunctionParameterType=function(e,t,n){e.node&&t<e.node.inputs.length&&(e.node.inputs[t].paramType=n)},e.prototype.setRewardFunction=function(e,t){e.node.reward=this._createFunctionReferenceNode(t),e.node.goal=void 0},e.prototype.setTerminalFunction=function(e,t){e.node.terminal=this._createFunctionReferenceNode(t),e.node.goal=void 0},e.prototype.setStateTransformFunction=function(e,t){e.node.state=this._createFunctionReferenceNode(t)},e.prototype.setActionTransformFunction=function(e,t){e.node.action=this._createFunctionReferenceNode(t)},e.prototype.setProgrammedFunction=function(e,t){e.node.programmedFunction=void 0===t?{type:p.ParseNodeType.FunctionReference,range:R,comments:[],functionRef:{type:p.ParseNodeType.Function,range:R,comments:[],name:{type:p.ParseNodeType.Identifier,range:R,text:""},functionToken:{token:_.Token.Function,range:R,text:"function"},inputs:[],block:{type:p.ParseNodeType.FunctionBlock,range:R,comments:[],statements:[{type:p.ParseNodeType.Return,range:R,comments:[],value:{type:p.ParseNodeType.NumericLiteral,range:R,comments:[],text:"0",value:0}}]}}}:this._createFunctionReferenceNode(t)},e.prototype.setObjectComments=function(e,t){e.node&&(e.node.comments=t)},e.prototype.removeGlobalObject=function(e){if(this._parseResult.parseTree.type===p.ParseNodeType.Program){var t=this._globalSymbolTable.lookUpSymbol(e);if(t){var n=t.symbol.resolvedObject;if((null==n?void 0:n.node)&&(this._parseResult.parseTree.statements=this._parseResult.parseTree.statements.filter((function(e){return e!==n.node})),n.node.type===p.ParseNodeType.Concept)){var r=this.getGraph();r&&(r.node.concepts=r.node.concepts.filter((function(e){return e!==n.node})))}}}},e.prototype.setGlobalConstantValue=function(e,t){e.node&&(e.node.value=this._createLiteralNodeForConst(t))},e.prototype.addGlobalTypeDefinition=function(e,t,n){if(this._parseResult.parseTree.type===p.ParseNodeType.Program){for(var r=0,o=!1,i=0;i<this._parseResult.parseTree.statements.length;i++){var a=this._parseResult.parseTree.statements[i];a.type===p.ParseNodeType.Type?(r=i+1,o=!0):a.type===p.ParseNodeType.Using&&(o||(r=i+1))}var s={type:p.ParseNodeType.Type,range:R,comments:n,name:{type:p.ParseNodeType.Identifier,range:R,text:e},declaredType:t};this._parseResult.parseTree.statements.splice(r,0,s)}},e.prototype.addGlobalSimulator=function(e){if(this._parseResult.parseTree.type===p.ParseNodeType.Program){var t=this.getGraph(),n=null==t?void 0:t.node.inputType;n||(n={type:p.ParseNodeType.Number,range:R});var r={type:p.ParseNodeType.Simulator,range:R,comments:[{text:"",fullLine:!0}],name:{type:p.ParseNodeType.Identifier,range:R,text:e},actionParam:{type:p.ParseNodeType.FunctionInput,range:R,name:{type:p.ParseNodeType.Identifier,range:R,text:"Action"},paramType:{type:p.ParseNodeType.Number,range:R}},stateType:n},o=this._parseResult.parseTree.statements.findIndex((function(e){return e.type===p.ParseNodeType.Graph}));o<0&&(o=0),this._parseResult.parseTree.statements.splice(o,0,r)}},e.prototype.setConceptInputs=function(e,t,n){e.node.inputs=[],t&&e.node.inputs.push({type:p.ParseNodeType.ConceptInput,range:R,inputSource:{type:p.ParseNodeType.Input,range:R}}),n.forEach((function(t){e.node.inputs.push({type:p.ParseNodeType.ConceptInput,range:R,inputSource:{type:p.ParseNodeType.Identifier,range:R,text:t.name}})}))},e.prototype.setGoalInputType=function(e,t){var n;(null===(n=e.node)||void 0===n?void 0:n.inputs[0])&&(e.node.inputs[0].paramType=t)},e.prototype.renameConcept=function(e,t){(new y.ConceptRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameLesson=function(e,t){(new y.LessonRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameGlobalSimulator=function(e,t){e.name&&(new y.SimulatorRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameGlobalData=function(e,t){e.name&&(new y.DataRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameGlobalConst=function(e,t){(new y.ConstRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameGlobalFunction=function(e,t){e.name&&(new y.FunctionRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.renameGlobalType=function(e,t){e.name&&(new y.TypeRenameWalker).rename(this._parseResult.parseTree,e.name,t)},e.prototype.insertSelectExpression=function(e,t,n){var r=e.node,o={type:p.ParseNodeType.Select,comments:[],range:R,targetConcept:{type:p.ParseNodeType.Identifier,text:t.name,range:R}};void 0===n?r.selects.push(o):r.selects[n]=o},e.prototype.removeSelectExpression=function(e,t){e.node.selects.splice(t,1)},e.prototype.insertNewLesson=function(e,t,n,o){var i=e.node.lessons||[],a=o||"Lesson "+(i.length+1),s={type:p.ParseNodeType.Lesson,range:R,name:{type:p.ParseNodeType.Identifier,range:R,text:a},comments:[{fullLine:!0,text:""}]};if(t){var c=t.node,u={type:p.ParseNodeType.Scenario,range:R,comments:[],scenarioType:r(r({},c),{range:R}),parent:e.node};u.scenarioType.parent=u,s.scenario=u}void 0===n?i.push(s):i.splice(n,0,s),e.node.lessons=i},e.prototype.removeLesson=function(e,t){e.node.lessons.splice(t,1)},e.prototype.addConceptDefinition=function(e,t){var n=this.getGraph();if(n){var r={type:p.ParseNodeType.Concept,range:R,comments:[],name:{type:p.ParseNodeType.Identifier,range:R,text:e},conceptToken:{token:_.Token.Concept,range:R,text:"concept"},inputs:[],outputType:{type:p.ParseNodeType.Number,range:R,comments:[]},selects:[]};switch(t){case x.Learned:var o=this.getGlobalSimulators(),i="MySimulator";o.length>0&&o[0].name&&(i=o[0].name),r.curriculum={type:p.ParseNodeType.Curriculum,range:R,comments:[],curriculumToken:{token:_.Token.Curriculum,range:R,text:"curriculum"},sources:[{type:p.ParseNodeType.DataSource,range:R,comments:[],dataSource:{type:p.ParseNodeType.Identifier,range:R,comments:[],text:i}}],lessons:[]};break;case x.Programmed:r.programmedFunction={type:p.ParseNodeType.FunctionReference,range:R,comments:[],functionRef:{type:p.ParseNodeType.Function,range:R,comments:[],name:{type:p.ParseNodeType.Identifier,range:R,text:""},functionToken:{token:_.Token.Function,range:R,text:"function"},inputs:[],block:{type:p.ParseNodeType.FunctionBlock,range:R,comments:[],statements:[{type:p.ParseNodeType.Return,range:R,comments:[],value:{type:p.ParseNodeType.NumericLiteral,range:R,comments:[],text:"0",value:0}}]}}};break;case x.Imported:r.importedModel={type:p.ParseNodeType.Import,range:R,comments:[],expression:{type:p.ParseNodeType.StructLiteral,range:R,comments:[],fields:[{type:p.ParseNodeType.StructLiteralField,range:R,comments:[],name:{type:p.ParseNodeType.Identifier,range:R,comments:[],text:"Model"},value:{type:p.ParseNodeType.StringLiteral,range:R,comments:[],text:'"MyModel"',value:"MyModel"}}]}};break;default:a.fail("Unexpected concept category")}n.node.concepts.length>0&&r.comments.push({text:"",fullLine:!0}),n.node.concepts.push(r)}},e.prototype.removeConcept=function(e){var t,n,r,o=this.getGraph(),i=null==o?void 0:o.node;(null===(t=e.node.parent)||void 0===t?void 0:t.type)===p.ParseNodeType.Program?this.removeGlobalObject(e.name):(null===(n=e.node.parent)||void 0===n?void 0:n.type)===p.ParseNodeType.Graph&&i&&(i.concepts=i.concepts.filter((function(t){return t!==e.node}))),this.getConcepts().forEach((function(t){t.node.inputs=t.node.inputs.filter((function(t){return t.inputSource.type!==p.ParseNodeType.Identifier||t.inputSource.text!==e.name}))})),(null===(r=null==o?void 0:o.output)||void 0===r?void 0:r.outputConcept)==e&&i&&(i.output=void 0)},e.prototype.getEffectiveTrainingParameterValues=function(e,t){var n=new Map;return C.TrainingValidator.getDefaultTrainingValues(!!e.goal,!!t).forEach((function(r,o){var i,a,s=null===(i=e.training)||void 0===i?void 0:i.value.value.get(o);if((null==s?void 0:s.category)===k.TypeCategory.Number&&(r=s.value),t){var c=null===(a=t.training)||void 0===a?void 0:a.value.value.get(o);(null==c?void 0:c.category)===k.TypeCategory.Number&&(r=c.value)}void 0!==r&&n.set(o,r)})),n},e.prototype.setCurriculumTrainingParameters=function(e,t){var n,r=this._buildStructNodeFromNumericValues(t);r.fields.length>0?e.node.training={type:p.ParseNodeType.Training,range:R,comments:(null===(n=e.node.training)||void 0===n?void 0:n.comments)||[{fullLine:!0,text:""}],expression:r}:e.node.training=void 0},e.prototype.setLessonTrainingParameters=function(e,t){var n,r=this._buildStructNodeFromNumericValues(t);e.node&&(r.fields.length>0?e.node.training={type:p.ParseNodeType.Training,range:R,comments:(null===(n=e.node.training)||void 0===n?void 0:n.comments)||[{fullLine:!0,text:""}],expression:r}:e.node.training=void 0)},e.prototype.setConceptImportedModelValue=function(e,t){e.node.expression={type:p.ParseNodeType.StructLiteral,comments:[],range:R,fields:[{type:p.ParseNodeType.StructLiteralField,range:R,name:{type:p.ParseNodeType.Identifier,range:R,text:"Model"},value:{type:p.ParseNodeType.StringLiteral,range:R,text:v.Tokenizer.encodeStringLiteral(t),value:t},comments:[]}]}},e.prototype.editFunctionDefinition=function(e,t){var n,r,o,i,u=[],l="edited",y=new m.Parser(t,u,this._compilerOptions,l),g=void 0!==e&&(null===(r=null===(n=e.node)||void 0===n?void 0:n.parent)||void 0===r?void 0:r.type)!==p.ParseNodeType.Program,h=y.parseFunctionDeclaration(g),f=u.some((function(e){return e.type===c.DiagnosticType.ParserError}));return f||(a(void 0!==h&&h.parseTree.type===p.ParseNodeType.Function),i=h.parseTree,e?d.ParseNodeUtils.replaceFunctionDeclarationNode(e.node,i):d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,i),(o=new s.Analyzer(this._parseResult,u,this._compilerOptions).analyzeProgram())._editedParseResult=h,e?d.ParseNodeUtils.replaceFunctionDeclarationNode(i,e.node):d.ParseNodeUtils.removeGlobalStatement(this._parseResult.parseTree,i),u=u.filter((function(e){return e.range.start.marker===l}))),{node:i,name:null==i?void 0:i.name.text,analyzerResult:o,hasParseErrors:f,diagnostics:u}},e.prototype.applyEditedFunctionDefinition=function(e,t){var n,r,o,i=[],s=new m.Parser(t,i,this._compilerOptions),u=void 0!==e&&(null===(r=null===(n=e.node)||void 0===n?void 0:n.parent)||void 0===r?void 0:r.type)!==p.ParseNodeType.Program,l=s.parseFunctionDeclaration(u),g=i.some((function(e){return e.type===c.DiagnosticType.ParserError}));return g||(a(void 0!==l&&l.parseTree.type===p.ParseNodeType.Function),o=l.parseTree,e?d.ParseNodeUtils.replaceFunctionDeclarationNode(e.node,o):d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,o),e&&e.node.parent.type===p.ParseNodeType.Program&&e.name&&e.name!==o.name.text&&(new y.FunctionRenameWalker).rename(this._parseResult.parseTree,e.name,o.name.text)),{node:o,name:null==o?void 0:o.name.text,hasParseErrors:g,diagnostics:i}},e.prototype.editGoalDefinition=function(e,t){var n,r,o=[],i="edited",u=new m.Parser(t,o,this._compilerOptions,i).parseGoalDeclaration(),l=o.some((function(e){return e.type===c.DiagnosticType.ParserError}));if(!l){a(void 0!==u&&u.parseTree.type===p.ParseNodeType.Goal),r=u.parseTree;var y=e.node.reward,g=e.node.terminal,h=e.node.goal;h?d.ParseNodeUtils.replaceGoalDeclarationNode(h,r):(a(!e.node.goal),e.node.goal=r,e.node.reward=void 0,e.node.terminal=void 0,r.parent=e.node),(n=new s.Analyzer(this._parseResult,o,this._compilerOptions).analyzeProgram())._editedParseResult=u,h?d.ParseNodeUtils.replaceGoalDeclarationNode(r,h):(e.node.goal=void 0,e.node.reward=y,e.node.terminal=g),o=o.filter((function(e){return e.range.start.marker===i}))}return{node:r,analyzerResult:n,hasParseErrors:l,diagnostics:o}},e.prototype.applyEditedGoalDefinition=function(e,t){var n,r=[],o=new m.Parser(t,r,this._compilerOptions).parseGoalDeclaration(),i=r.some((function(e){return e.type===c.DiagnosticType.ParserError}));if(!i){a(void 0!==o&&o.parseTree.type===p.ParseNodeType.Goal),n=o.parseTree;var s=e.node.goal;s?d.ParseNodeUtils.replaceGoalDeclarationNode(s,n):(a(!e.node.goal),e.node.goal=n,e.node.reward=void 0,e.node.terminal=void 0)}return{node:n,hasParseErrors:i,diagnostics:r}},e.prototype.editTypeDefinition=function(e,t){var n,r,o=[],i="edited",u=new m.Parser(t,o,this._compilerOptions,i).parseTypeDefinition(),l=o.some((function(e){return e.type===c.DiagnosticType.ParserError}));return l||(a(void 0!==u&&u.parseTree.type===p.ParseNodeType.Type),r=u.parseTree,e?d.ParseNodeUtils.replaceTypeDeclarationNode(e.node,r):d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,r),(n=new s.Analyzer(this._parseResult,o,this._compilerOptions).analyzeProgram())._editedParseResult=u,e?d.ParseNodeUtils.replaceTypeDeclarationNode(r,e.node):d.ParseNodeUtils.removeGlobalStatement(this._parseResult.parseTree,r),o=o.filter((function(e){return e.range.start.marker===i}))),{node:r,name:null==r?void 0:r.name.text,analyzerResult:n,hasParseErrors:l,diagnostics:o}},e.prototype.editLessonScenario=function(e,t){var n,r,o,i,a=[],u="edited",l=new m.Parser(t,a,this._compilerOptions,u).parseTypeExpression(),p=a.some((function(e){return e.type===c.DiagnosticType.ParserError})),y=null===(r=null===(n=null==e?void 0:e.node)||void 0===n?void 0:n.scenario)||void 0===r?void 0:r.scenarioType;return p||(i=l.parseTree,y?d.ParseNodeUtils.replaceScenarioTypeNode(y,i):d.ParseNodeUtils.addScenarioToLesson(e.node,this._createScenarioNode(e,i)),(o=new s.Analyzer(this._parseResult,a,this._compilerOptions).analyzeProgram())._editedParseResult=l,y?d.ParseNodeUtils.replaceScenarioTypeNode(i,y):d.ParseNodeUtils.removeScenarioFromLesson(e.node),a=a.filter((function(e){return e.range.start.marker===u}))),{node:i,analyzerResult:o,hasParseErrors:p,diagnostics:a}},e.prototype.applyEditedLessonScenario=function(e,t){var n,r,o,i=[],a=new m.Parser(t,i,this._compilerOptions,"edited").parseTypeExpression(),s=i.some((function(e){return e.type===c.DiagnosticType.ParserError})),u=null===(r=null===(n=null==e?void 0:e.node)||void 0===n?void 0:n.scenario)||void 0===r?void 0:r.scenarioType;return s||(o=a.parseTree,u?d.ParseNodeUtils.replaceScenarioTypeNode(u,o):d.ParseNodeUtils.addScenarioToLesson(e.node,this._createScenarioNode(e,o))),{node:o,hasParseErrors:s,diagnostics:i}},e.prototype.applyEditedTypeDefinition=function(e,t){var n,r=[],o=new m.Parser(t,r,this._compilerOptions).parseTypeDefinition(),i=r.some((function(e){return e.type===c.DiagnosticType.ParserError}));return i||(a(void 0!==o&&o.parseTree.type===p.ParseNodeType.Type),n=o.parseTree,e?d.ParseNodeUtils.replaceTypeDeclarationNode(e.node,n):d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,n),e&&e.name&&e.name!==n.name.text&&(new y.TypeRenameWalker).rename(this._parseResult.parseTree,e.name,n.name.text)),{node:n,name:null==n?void 0:n.name.text,hasParseErrors:i,diagnostics:r}},e.prototype.editConstDeclaration=function(e,t){var n,r,o=[],i="edited",u=new m.Parser(t,o,this._compilerOptions,i).parseConstDeclaration(),l=o.some((function(e){return e.type===c.DiagnosticType.ParserError}));return l||(a(void 0!==u&&u.parseTree.type===p.ParseNodeType.Const),r=u.parseTree,e?d.ParseNodeUtils.replaceConstDeclarationNode(e.node,r):d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,r),(n=new s.Analyzer(this._parseResult,o,this._compilerOptions).analyzeProgram())._editedParseResult=u,e?d.ParseNodeUtils.replaceConstDeclarationNode(r,e.node):d.ParseNodeUtils.removeGlobalStatement(this._parseResult.parseTree,r),o=o.filter((function(e){return e.range.start.marker===i}))),{node:r,name:null==r?void 0:r.name.text,analyzerResult:n,hasParseErrors:l,diagnostics:o}},e.prototype.applyEditedConstDeclaration=function(e,t){var n,r=[],o=new m.Parser(t,r,this._compilerOptions).parseConstDeclaration(),i=r.some((function(e){return e.type===c.DiagnosticType.ParserError}));if(!i){if(a(void 0!==o&&o.parseTree.type===p.ParseNodeType.Const),n=o.parseTree,e)d.ParseNodeUtils.replaceConstDeclarationNode(e.node,n);else if(this._parseResult.parseTree.type!==p.ParseNodeType.Program)d.ParseNodeUtils.addGlobalStatement(this._parseResult.parseTree,n);else{for(var s=0,u=!1,l=0;l<this._parseResult.parseTree.statements.length;l++){var g=this._parseResult.parseTree.statements[l];g.type===p.ParseNodeType.Const?(s=l+1,u=!0):g.type===p.ParseNodeType.Using&&(u||(s=l+1))}this._parseResult.parseTree.statements.splice(s,0,n)}e&&e.name&&e.name!==n.name.text&&(new y.ConstRenameWalker).rename(this._parseResult.parseTree,e.name,n.name.text)}return{node:n,name:null==n?void 0:n.name.text,hasParseErrors:i,diagnostics:r}},e.prototype.getClientEndOfFileComment=function(){var e;a(this._parseResult.parseTree.type===p.ParseNodeType.Program);var t=(null===(e=this._parseResult.parseTree.endComment)||void 0===e?void 0:e.comments)||[],n=o(this._findClientCommentRange(t),2),r=n[0],i=n[1];return r>=0?t.slice(r,i+1).map((function(e){return e.text.substr(E.length)})):[]},e.prototype.setClientEndOfFileComment=function(e){a(this._parseResult.parseTree.type===p.ParseNodeType.Program);var t=this._parseResult.parseTree.endComment?i([],o(this._parseResult.parseTree.endComment.comments)):[],n=o(this._findClientCommentRange(t),2),r=n[0],s=n[1];r>=0&&t.splice(r,s-r+1);var c=e.map((function(e){return{fullLine:!0,text:E+e}}));0===t.length&&t.push({fullLine:!0,text:""}),t.push.apply(t,i([],o(c))),this._parseResult.parseTree.endComment={type:p.ParseNodeType.Comment,range:R,comments:t}},e.printFunctionDefinition=function(e,t){return void 0===t&&(t=!1),new g.Printer({omitComments:t}).printNode(e.node)},e.printTypeDefinition=function(e,t){return void 0===t&&(t=!1),new g.Printer({omitComments:t}).printNode(e.node)},e.printGoal=function(e,t){return void 0===t&&(t=!1),new g.Printer({omitComments:t}).printNode(e.node)},e.printConstDefinition=function(e,t){return void 0===t&&(t=!1),new g.Printer({omitComments:t}).printNode(e.node)},e.prototype._buildStructNodeFromNumericValues=function(e){var t={type:p.ParseNodeType.StructLiteral,range:R,comments:[],fields:[]};return e.forEach((function(e,n){t.fields.push({type:p.ParseNodeType.StructLiteralField,range:R,name:{type:p.ParseNodeType.Identifier,range:R,text:n},value:{type:p.ParseNodeType.NumericLiteral,range:R,text:h.printValueSinglePrecision(e),value:e},comments:[]})})),t},e._convertToMapRecursive=function(e){var t=this;if(Array.isArray(e))return e.map((function(e){return t._convertToMapRecursive(e)}));if("object"==typeof e){var n=new Map;return Object.keys(e).forEach((function(r){n.set(r,t._convertToMapRecursive(e[r]))})),n}return e},e._convertFromMapRecursive=function(e){var t=this;if(Array.isArray(e))return e.map((function(e){return t._convertFromMapRecursive(e)}));if(e instanceof Map){var n={};return e.forEach((function(e,r){n[r]=t._convertFromMapRecursive(e)})),n}return e},e.prototype._createFunctionReferenceNode=function(e){if(e)return{type:p.ParseNodeType.FunctionReference,range:R,comments:[],functionRef:{type:p.ParseNodeType.Identifier,range:R,text:e}}},e.prototype._createScenarioNode=function(e,t){var n;if(null===(n=e.node)||void 0===n?void 0:n.parent)return{type:p.ParseNodeType.Scenario,range:R,comments:[],scenarioType:t,parent:e.node.parent}},e.prototype._createLiteralNodeForConst=function(e){return"string"==typeof e?{type:p.ParseNodeType.StringLiteral,range:R,text:v.Tokenizer.encodeStringLiteral(e),value:e}:{type:p.ParseNodeType.NumericLiteral,range:R,text:e.toString(),value:e}},e.prototype._findClientCommentRange=function(e){for(var t=function(e){return e.fullLine&&e.text.startsWith(E)},n=-1,r=-1,o=e.length-1;o>=0;o--)if(r<0)t(e[o])&&(r=o,n=o);else{if(!t(e[o]))break;r=o}return[r,n]},e}();t.AnalyzerResult=P},6599:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerUtils=void 0;var r,o=n(8312),i=n(3649),a=n(9948),s=n(2374);(r=t.AnalyzerUtils||(t.AnalyzerUtils={})).isTypeContinuous=function(e){return s.TypeChecker.isTypeContinuous(e)},r.isTypeDiscrete=function(e){return s.TypeChecker.isTypeDiscrete(e)},r.synthesizeConstraintForNumberType=function(e){return s.TypeChecker.synthesizeConstraintForNumberType(e)},r.isIdentifierVariable=function(e){var t=i.getIdentifierDataForNode(e);return!(!t||t.symbolCategory!==a.SymbolCategory.Var&&t.symbolCategory!==a.SymbolCategory.Param)},r.isIdentifierConst=function(e){var t=i.getIdentifierDataForNode(e);return!(!t||t.symbolCategory!==a.SymbolCategory.Const)},r.getConstExpressionForExpression=function(e){var t=i.getConstExpressionDataForNode(e);if(t)return t},r.isFunctionCallTypeConversion=function(e){var t=i.getFunctionCallDataForNode(e);return!(!t||!t.isTypeConversion)},r.getImplicitTypeConversionForArguments=function(e){var t=i.getFunctionCallDataForNode(e);if(t)return t.arguments},r.encodeProtobufFieldName=function(e){return o.encodeProtobufFieldName(e)},r.createEmptyInklingDocument=function(){return'inkling "2.0"\n\n# Define the input state for the concept graph.\n# Modify this type to match your problem state.\ntype ObservableState {\n    x: number,\n    y: number\n}\n\n# Define a concept graph.\ngraph (input: ObservableState) {\n}\n'}},8167:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIdentifierChar=t.isIdentifierStartChar=void 0;var r,o=n(6704);!function(e){e[e.NotIdentifierChar=0]="NotIdentifierChar",e[e.StartIdentifierChar=1]="StartIdentifierChar",e[e.IdentifierChar=2]="IdentifierChar"}(r||(r={}));var i=256,a=new Array(i),s={},c=!1;t.isIdentifierStartChar=function(e){return e<i?a[e]===r.StartIdentifierChar:(c||(d(!1),c=!0),s[e]===r.StartIdentifierChar)},t.isIdentifierChar=function(e){return e<i?a[e]===r.StartIdentifierChar||a[e]===r.IdentifierChar:s[e]===r.StartIdentifierChar||s[e]===r.IdentifierChar};var u=[[95,6277,6278,8472,8494,12443,12444],o.unicodeLu,o.unicodeLl,o.unicodeLt,o.unicodeLo,o.unicodeLm,o.unicodeNl],l=[[183,903,4969,4970,4971,4972,4973,4974,4975,4976,4977,6618],o.unicodeMn,o.unicodeMc,o.unicodeNd,o.unicodePc];function p(e,t,n){for(var r=0;r<e.length;r++){var o=e[r],c=void 0,u=void 0;Array.isArray(o)?(c=o[0],u=o[1]):c=u=o;for(var l=c;l<=u;l++)l<i?a[l]=t:s[l]=t;if(n&&c>=i)break}}function d(e){a.fill(r.NotIdentifierChar),l.forEach((function(t){p(t,r.IdentifierChar,e)})),u.forEach((function(t){p(t,r.StartIdentifierChar,e)}))}d(!0)},9194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentationFromComments=void 0,t.getDocumentationFromComments=function(e){if(e){var t="";return e.forEach((function(e){var n=e.text.trim();n.startsWith("#")&&(n=n.substr(1).trim()),t&&(t+=" "),t+=n})),t}}},4471:function(e,t){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticAddendum=t.Diagnostic=t.isDiagnosticInformational=t.isDiagnosticWarning=t.isDiagnosticError=t.DiagnosticType=t.TextRange=t.TextPosition=t.DefaultTextStreamMarker=void 0,t.DefaultTextStreamMarker=void 0;var i=function(){function e(e,n,r){void 0===r&&(r=t.DefaultTextStreamMarker),this.line=e,this.character=n,this.marker=r}return e.prototype.isBefore=function(e){return this.line<e.line||!(this.line>e.line)&&this.character<e.character},e.prototype.isBeforeOrSame=function(e){return this.line<e.line||!(this.line>e.line)&&this.character<=e.character},e}();t.TextPosition=i;var a,s=function(){function e(e,n,r){void 0===r&&(r=t.DefaultTextStreamMarker),this.start=e,this.end=n,this.marker=r}return e.prototype.isEmpty=function(){return this.start.line===this.end.line&&this.start.character===this.end.character},e.prototype.isPositionWithin=function(e){return!e.isBefore(this.start)&&e.isBeforeOrSame(this.end)},e.prototype.extendRange=function(t){var n=t.start.isBefore(this.start),r=this.end.isBefore(t.end);return n||r?new e(n?t.start:this.start,r?t.end:this.end,this.marker):this},e}();t.TextRange=s,function(e){e[e.ParserError=1]="ParserError",e[e.AnalyzerError=2]="AnalyzerError",e[e.InternalError=3]="InternalError",e[e.Warning=10]="Warning",e[e.Informational=11]="Informational",e[e.UnreferencedCode=12]="UnreferencedCode"}(a=t.DiagnosticType||(t.DiagnosticType={})),t.isDiagnosticError=function(e){return e===a.ParserError||e===a.AnalyzerError||e===a.InternalError},t.isDiagnosticWarning=function(e){return e===a.Warning},t.isDiagnosticInformational=function(e){return e===a.Informational};t.Diagnostic=function(e,t,n){this.range=e,this.message=t,this.type=n};var c=function(){function e(){this._messages=[],this._childAddenda=[]}return e.prototype.addMessage=function(e){this._messages.push(e)},e.prototype.createAddendum=function(){var t=new e;return this.addAddendum(t),t},e.prototype.getString=function(e,t){void 0===e&&(e=5),void 0===t&&(t=8);var n=this._getLinesRecursive(e,t);n.length>t&&(n=n.slice(0,t)).push("  ...");var r=n.join("\n");return r.length>0?"\n"+r:""},e.prototype.isEmpty=function(){return 0===this._getMessageCount()},e.prototype.addAddendum=function(e){this._childAddenda.push(e)},e.prototype.getChildren=function(){return this._childAddenda},e.prototype._getMessageCount=function(e){var t,r;if(void 0===e&&(e=0),e>64)return 0;var o=this._messages.length;try{for(var i=n(this._childAddenda),a=i.next();!a.done;a=i.next())o+=a.value._getMessageCount(e+1)}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return o},e.prototype._getLinesRecursive=function(e,t,i){var a,s;if(void 0===i&&(i=0),e<=0||i>64)return[];var c=[];try{for(var u=n(this._childAddenda),l=u.next();!l.done;l=u.next()){var p=l.value,d=this._messages.length>0?e-1:e;if(c.push.apply(c,o([],r(p._getLinesRecursive(d,t,i+1)))),c.length>=t){c=c.slice(0,t);break}}}catch(e){a={error:e}}finally{try{l&&!l.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}var m=this._messages.length>0?"  ":"";return this._messages.concat(c).map((function(e){return m+e}))},e}();t.DiagnosticAddendum=c},9281:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Comparator=void 0;var o=n(2357),i=n(6599),a=n(7585),s=n(6155),c=n(8240),u=n(2374),l=n(7379),p=n(1570),d=function(){function e(e,t){this._results1=e,this._results2=t}return e.prototype.getDifference=function(){var e=this._getGraphDifference(),t=this._getConceptDifferences(),n=new Map;return t.forEach((function(e){n.set(e.name,e)})),this._aggregateConceptDifferencesForGraph(e,n),{graphDifference:e,conceptDifferences:t}},e.prototype._getGraphDifference=function(){var e=this._results1.getGraph(),t=this._results2.getGraph();return{inputTypeChanged:!this._isTypeSame(e?e.input.inputType:void 0,t?t.input.inputType:void 0),outputTypeChanged:!this._isTypeSame(e&&e.output?e.output.outputType:void 0,t&&t.output?t.output.outputType:void 0),outputConceptChanged:void 0===e||void 0===t||void 0===e.output||void 0===t.output||void 0===e.output.outputConcept||void 0===t.output.outputConcept||e.output.outputConcept.name!==t.output.outputConcept.name}},e.prototype._aggregateConceptDifferencesForGraph=function(e,t){var n,o,i=e.inputTypeChanged,a=new Map;try{for(var s=r(t.values()),c=s.next();!c.done;c=s.next()){var u=c.value;u.conceptRemoved||u.conceptAdded||this._updateConceptDifferenceBasedOnInputs(u,i,t,a)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype._updateConceptDifferenceBasedOnInputs=function(e,t,n,r){var i=this;if(!r.has(e.name)){r.set(e.name,!0);var a=t,s=this._results2.getConcepts().find((function(t){return t.name===e.name}));o(void 0!==s),s.inputs.forEach((function(e){if(e.inputConcept){var o=n.get(e.inputConcept.name);i._updateConceptDifferenceBasedOnInputs(o,t,n,r),o.requiresReset&&(a=!0)}})),a&&(e.inputConceptsChanged=!0,e.requiresReset=!0)}},e.prototype._getConceptDifferences=function(){var e=this,t=this._results1.getConcepts(),n=this._results2.getConcepts(),r=[];return t.forEach((function(t){if(!n.find((function(e){return e.name===t.name}))){var o=e._createDefaultConceptDifference(t.name);o.conceptRemoved=!0,r.push(o)}})),n.forEach((function(n){var o=t.find((function(e){return e.name===n.name}));if(o)r.push(e._getConceptDifference(o,n));else{var i=e._createDefaultConceptDifference(n.name);i.conceptAdded=!0,r.push(i)}})),r},e.prototype._createDefaultConceptDifference=function(e){return{name:e,lessonDifferences:[],conceptAdded:!1,conceptRemoved:!1,requiresReset:!1,requiresAdditionalTraining:!1,inputTypeChanged:!1,inputConceptsChanged:!1,outputTypeChanged:!1,conceptImplementationChanged:!1,programmedFunctionChanged:!1,selectsChanged:!1,sourceChanged:!1,algorithmChanged:!1,rewardFunctionChanged:!1,actionFunctionChanged:!1,stateFunctionChanged:!1,terminalFunctionChanged:!1,goalChanged:!1,trainingChanged:!1}},e.prototype._getConceptDifference=function(e,t){var n,r,o,i,a,u,l,p,d,m,y,g,h=this,f=this._createDefaultConceptDifference(e.name);if(e.curriculum&&t.curriculum){var T=this._getStructLiteralFieldValue(null===(n=e.curriculum.training)||void 0===n?void 0:n.value,"EpisodeIterationLimit",c.DefaultEpisodeIterationLimit),v=this._getStructLiteralFieldValue(null===(r=e.curriculum.training)||void 0===r?void 0:r.value,"TotalIterationLimit",c.DefaultTotalIterationLimit),_=this._getStructLiteralFieldValue(null===(o=e.curriculum.training)||void 0===o?void 0:o.value,"LessonSuccessThreshold",c.DefaultSuccessThreshold),C=this._getStructLiteralFieldValue(null===(i=e.curriculum.training)||void 0===i?void 0:i.value,"LessonRewardThreshold",0),b=this._getStructLiteralFieldValue(null===(a=t.curriculum.training)||void 0===a?void 0:a.value,"LessonAssessmentWindow",c.DefaultAssessmentWindow),k=this._getStructLiteralFieldValue(null===(u=e.curriculum.training)||void 0===u?void 0:u.value,"NoProgressIterationLimit",c.DefaultNoProgressIterationLimit),S=this._getStructLiteralFieldValue(null===(l=t.curriculum.training)||void 0===l?void 0:l.value,"EpisodeIterationLimit",c.DefaultEpisodeIterationLimit),x=this._getStructLiteralFieldValue(null===(p=t.curriculum.training)||void 0===p?void 0:p.value,"TotalIterationLimit",c.DefaultTotalIterationLimit),N=this._getStructLiteralFieldValue(null===(d=t.curriculum.training)||void 0===d?void 0:d.value,"LessonSuccessThreshold",c.DefaultSuccessThreshold),R=this._getStructLiteralFieldValue(null===(m=t.curriculum.training)||void 0===m?void 0:m.value,"LessonRewardThreshold",0),E=this._getStructLiteralFieldValue(null===(y=t.curriculum.training)||void 0===y?void 0:y.value,"LessonAssessmentWindow",c.DefaultAssessmentWindow),P=this._getStructLiteralFieldValue(null===(g=t.curriculum.training)||void 0===g?void 0:g.value,"NoProgressIterationLimit",c.DefaultNoProgressIterationLimit);T!==S||v>x||_>N||C>R||k>P||b!==E?(f.requiresReset=!0,f.trainingChanged=!0):(v<x||_<N||C<R||k<P)&&(f.requiresAdditionalTraining=!0,f.trainingChanged=!0);var w=e.curriculum.lessons,D=t.curriculum.lessons;f.lessonDifferences=this._getLessonDifferences(w,_,C,b,D,N,R,E),f.lessonDifferences.some((function(e){return e.lessonAdded||e.requiresReset}))&&(f.requiresAdditionalTraining=!0),f.lessonDifferences.some((function(e){return e.scenarioChanged}))&&(f.requiresAdditionalTraining=!0),e.curriculum&&0===e.curriculum.lessons.length&&t.curriculum&&t.curriculum.lessons.length>0&&(f.requiresReset=!0),e.curriculum.sources.length!==t.curriculum.sources.length?f.sourceChanged=!0:e.curriculum.sources.forEach((function(e,n){var r=t.curriculum.sources[n];(e.node.type!==r.node.type||e.node.type===s.ParseNodeType.Data&&e.dataset!==r.dataset)&&(f.sourceChanged=!0)})),this._isAlgorithmSame(e.curriculum.algorithm,t.curriculum.algorithm)||(f.algorithmChanged=!0),this._isFunctionSame(e.curriculum.reward,t.curriculum.reward)||(f.rewardFunctionChanged=!0),this._isFunctionSame(e.curriculum.action,t.curriculum.action)||(f.actionFunctionChanged=!0),this._isFunctionSame(e.curriculum.state,t.curriculum.state)||(f.stateFunctionChanged=!0),this._isFunctionSame(e.curriculum.terminal,t.curriculum.terminal)||(f.terminalFunctionChanged=!0),this._isGoalSame(e.curriculum.goal,t.curriculum.goal)||(f.goalChanged=!0)}e.inputs.length!==t.inputs.length?(f.inputTypeChanged=!0,f.inputConceptsChanged=!0):t.inputs.forEach((function(t,n){var r,o,i=e.inputs[n];(null===(r=i.inputConcept)||void 0===r?void 0:r.name)!==(null===(o=t.inputConcept)||void 0===o?void 0:o.name)&&(f.inputConceptsChanged=!0),h._isTypeSame(i.inputType,t.inputType)||(f.inputTypeChanged=!0)})),this._isTypeSame(e.outputType,t.outputType)||(f.outputTypeChanged=!0),(e.curriculum&&!t.curriculum||!e.curriculum&&t.curriculum)&&(f.conceptImplementationChanged=!0),e.programmedFunction&&t.programmedFunction&&(this._isFunctionSame(e.programmedFunction,t.programmedFunction)||(f.programmedFunctionChanged=!0));var F=e.selects||[],O=t.selects||[];return F.length!==O.length?f.selectsChanged=!0:F.forEach((function(e,t){var n=O[t];e.concept!==n.concept&&(f.selectsChanged=!0),e.maskFunction&&n.maskFunction?h._isFunctionSame(e.maskFunction,n.maskFunction)||(f.selectsChanged=!0):(!e.maskFunction&&n.maskFunction||e.maskFunction&&!n.maskFunction)&&(f.selectsChanged=!0)})),(f.inputTypeChanged||f.inputConceptsChanged||f.outputTypeChanged||f.conceptImplementationChanged||f.programmedFunctionChanged||f.selectsChanged||f.algorithmChanged||f.sourceChanged||f.rewardFunctionChanged||f.actionFunctionChanged||f.stateFunctionChanged||f.terminalFunctionChanged||f.goalChanged)&&(f.requiresReset=!0),f},e.prototype._isAlgorithmSame=function(e,t){return!e&&!t||!(!e||!t)&&a.ExpressionEvaluator.isResultTypeSame(e.value,t.value,!0)},e.prototype._isGoalSame=function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;if(e.subgoals.length!==t.subgoals.length)return!1;for(var n=0;n<e.subgoals.length;n++)if(!this._isGoalAtomSame(e.subgoals[n],t.subgoals[n]))return!1;return!0},e.prototype._isGoalAtomSame=function(e,t){return e.operation===t.operation&&e.name===t.name&&e.withinValue===t.withinValue&&this._isExpressionSame(e.valueExpression,t.valueExpression)&&this._isExpressionSame(e.targetExpression,t.targetExpression)},e.prototype._isFunctionSame=function(e,t){var n=this;if(!e&&!t)return!0;if(!e||!t)return!1;if(e.signatures.length!==t.signatures.length)return!1;for(var r=function(r){var i=e.signatures[r],a=t.signatures[r];return i.parameters.length!==a.parameters.length?{value:!1}:o._isTypeSame(i.returnType,a.returnType)?i.parameters.some((function(e,t){var r=a.parameters[t];return e.name!==r.name||!n._isTypeSame(e.type,r.type)}))?{value:!1}:void 0:{value:!1}},o=this,i=0;i<e.signatures.length;i++){var a=r(i);if("object"==typeof a)return a.value}return!!this._isFunctionBlockSame(e.functionBlock,t.functionBlock)},e.prototype._isFunctionBlockSame=function(e,t){var n=this;return e.statements.length===t.statements.length&&!t.statements.some((function(t,r){var o=e.statements[r];return o.category!==t.category||!n._isFunctionStatementSame(o,t)}))},e.prototype._isFunctionStatementSame=function(e,t){if(e.category!==t.category)return!1;switch(e.category){case p.FunctionStatementCategory.Return:var n=t;return this._isTypeSame(e.returnType,t.returnType)&&this._isExpressionSame(e.value,n.value);case p.FunctionStatementCategory.VarAssignment:var r=t;return e.name===r.name&&this._isTypeSame(e.castToType,r.castToType)&&this._isExpressionSame(e.value,r.value);case p.FunctionStatementCategory.VarDeclaration:return r=t,e.name===r.name&&this._isTypeSame(e.castFromType,r.castFromType)&&this._isExpressionSame(e.initialValue,r.initialValue);case p.FunctionStatementCategory.IfElse:var o=t;return this._isIfElseStatementSame(e,o)}},e.prototype._isIfElseStatementSame=function(e,t){if(!this._isExpressionSame(e.condition,t.condition))return!1;if(!this._isFunctionBlockSame(e.ifBlock,t.ifBlock))return!1;if(e.elseBlock||t.elseBlock){if(!e.elseBlock||!t.elseBlock)return!1;if(!this._isFunctionBlockSame(e.elseBlock,t.elseBlock))return!1}return!0},e.prototype._isExpressionSame=function(e,t){return!e&&!t||!(!e||!t)&&this._isExpressionNodeSame(e.node,t.node)},e.prototype._isExpressionNodeSame=function(e,t){var n,o,c=this;if(e.type!==t.type)return!1;switch(e.type){case s.ParseNodeType.BinaryOperation:var u=t;return e.operator===u.operator&&this._isExpressionNodeSame(e.leftOperand,u.leftOperand)&&this._isExpressionNodeSame(e.rightOperand,u.rightOperand);case s.ParseNodeType.UnaryOperation:var l=t;return e.operator===l.operator&&this._isExpressionNodeSame(e.operand,l.operand);case s.ParseNodeType.FunctionCall:var p=t;if(e.arguments.length!==p.arguments.length)return!1;if(e.arguments.some((function(e,t){return!c._isExpressionNodeSame(e,p.arguments[t])})))return!1;if(i.AnalyzerUtils.isFunctionCallTypeConversion(e))return!!i.AnalyzerUtils.isFunctionCallTypeConversion(p);if(e.callExpression.type===s.ParseNodeType.Identifier){var d=e.callExpression.text;if(p.callExpression.type!==s.ParseNodeType.Identifier)return!1;var m=p.callExpression.text,y=this._results1.getGlobalFunctions().find((function(e){return e.name===d})),g=this._results2.getGlobalFunctions().find((function(e){return e.name===m}));return!(!y||!g)&&this._isFunctionSame(y,g)}return e.callExpression.type===s.ParseNodeType.MemberAccess&&p.callExpression.type===s.ParseNodeType.MemberAccess&&e.callExpression.leftExpression.type===s.ParseNodeType.Identifier&&p.callExpression.leftExpression.type===s.ParseNodeType.Identifier&&e.callExpression.leftExpression.text===p.callExpression.leftExpression.text&&e.callExpression.identifier.text===p.callExpression.identifier.text;case s.ParseNodeType.ParenthesizedExpression:var h=t;return this._isExpressionNodeSame(e.expression,h.expression);case s.ParseNodeType.Identifier:var f=t,T=i.AnalyzerUtils.getConstExpressionForExpression(e),v=i.AnalyzerUtils.getConstExpressionForExpression(f);if(T)return!!v&&a.ExpressionEvaluator.isResultTypeSame(T,v,!0);if(!i.AnalyzerUtils.isIdentifierVariable(e)||!i.AnalyzerUtils.isIdentifierVariable(f))throw new Error("Comparator encountered unexpected identifier type");return e.text===f.text;case s.ParseNodeType.MemberAccess:var _=t;return T=i.AnalyzerUtils.getConstExpressionForExpression(e),v=i.AnalyzerUtils.getConstExpressionForExpression(_),T?!!v&&a.ExpressionEvaluator.isResultTypeSame(T,v,!0):e.leftExpression.type===s.ParseNodeType.Identifier&&_.leftExpression.type===s.ParseNodeType.Identifier&&e.leftExpression.text===_.leftExpression.text&&e.identifier.text===_.identifier.text;case s.ParseNodeType.NumericLiteral:var C=t;return e.value===C.value;case s.ParseNodeType.False:case s.ParseNodeType.True:return e.type===t.type;case s.ParseNodeType.StringLiteral:var b=t;return e.value===b.value;case s.ParseNodeType.ArrayLiteral:var k=t;return e.values.length===k.values.length&&!e.values.some((function(e,t){return!c._isExpressionNodeSame(e,k.values[t])}));case s.ParseNodeType.StructLiteral:var S=t;if(e.fields.length!==S.fields.length)return!1;var x=function(e){var t=S.fields.find((function(t){return t.name.text===e.name.text}));return t&&N._isExpressionNodeSame(e.value,t.value)?void 0:{value:!1}},N=this;try{for(var R=r(e.fields),E=R.next();!E.done;E=R.next()){var P=x(E.value);if("object"==typeof P)return P.value}}catch(e){n={error:e}}finally{try{E&&!E.done&&(o=R.return)&&o.call(R)}finally{if(n)throw n.error}}return!0;case s.ParseNodeType.ArrayAccess:var w=t;return!!this._isExpressionNodeSame(e.index,w.index)&&this._isExpressionNodeSame(e.array,w.array);default:throw new Error("Comparator encountered unexpected expression type")}},e.prototype._getStructLiteralFieldValue=function(e,t,n){if(!e||e.category!==l.TypeCategory.Struct)return n;var r=e.value.get(t);return r?r.category!==l.TypeCategory.Number?n:r.value:n},e.prototype._getLessonDifferences=function(e,t,n,r,o,i,a,s){for(var c,u,l,p,d,m,y=[],g=!1,h=0;h<Math.max(e.length,o.length);h++){var f=!1,T=!1,v=!1,_=!1;if(h>=e.length)f=!0;else if(h>=o.length)T=!0,g=!0;else{var C=e[h],b=o[h];(v=!this._isTypeSame(C.scenario,b.scenario))&&(g=!0);var k=this._getStructLiteralFieldValue(null===(c=C.training)||void 0===c?void 0:c.value,"LessonRewardThreshold",n),S=this._getStructLiteralFieldValue(null===(u=C.training)||void 0===u?void 0:u.value,"LessonSuccessThreshold",t),x=this._getStructLiteralFieldValue(null===(l=C.training)||void 0===l?void 0:l.value,"LessonAssessmentWindow",r),N=this._getStructLiteralFieldValue(null===(p=b.training)||void 0===p?void 0:p.value,"LessonRewardThreshold",a),R=this._getStructLiteralFieldValue(null===(d=b.training)||void 0===d?void 0:d.value,"LessonSuccessThreshold",i),E=this._getStructLiteralFieldValue(null===(m=b.training)||void 0===m?void 0:m.value,"LessonAssessmentWindow",s);(k>N||S>R||x!==E)&&(_=!0,g=!0)}y.push({lessonAdded:f,lessonRemoved:T,requiresReset:g,scenarioChanged:v,trainingChanged:_})}return y},e.prototype._isTypeSame=function(e,t){return!e&&!t||!(!e||!t)&&u.TypeChecker.isTypeSame(e,t)},e}();t.Comparator=d},222:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompilerOptions=void 0;var n=function(){function e(e){this.enableExperimentalStatements=!1,this.enableMultipleConcepts=!1,this.enableSelectorConcepts=!1,this.enableProgrammedConcepts=!1,this.enableImportedConcepts=!1,this.enableDataSources=!1,this.enableMultipleSources=!1,e?this.enableAllFeatures():this.enableDefaultFeatures()}return e.prototype.enableAllFeatures=function(){this.enableExperimentalStatements=!0,this.enableMultipleConcepts=!0,this.enableSelectorConcepts=!0,this.enableProgrammedConcepts=!0,this.enableImportedConcepts=!0,this.enableDataSources=!0,this.enableMultipleSources=!0},e.prototype.enableDefaultFeatures=function(){this.enableExperimentalStatements=!0,this.enableSelectorConcepts=!0,this.enableMultipleConcepts=!0,this.enableProgrammedConcepts=!0,this.enableImportedConcepts=!0,this.enableDataSources=!0,this.enableMultipleSources=!0},e}();t.CompilerOptions=n},1206:(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CompletionProvider=t.CompletionItemKind=void 0;var o,i,a=n(4471),s=n(7499),c=n(3649),u=n(6155),l=n(4847),p=n(9948),d=n(9554),m=n(4393),y=n(2374),g=n(7379);!function(e){e[e.Type=0]="Type",e[e.Constant=1]="Constant",e[e.Variable=2]="Variable",e[e.Function=3]="Function",e[e.Field=4]="Field",e[e.Namespace=5]="Namespace",e[e.Keyword=6]="Keyword",e[e.Concept=7]="Concept",e[e.Simulator=8]="Simulator",e[e.Data=9]="Data",e[e.Other=10]="Other"}(o=t.CompletionItemKind||(t.CompletionItemKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.Program=1]="Program",e[e.Concept=2]="Concept",e[e.ConceptInputs=3]="ConceptInputs",e[e.Curriculum=4]="Curriculum",e[e.Select=5]="Select",e[e.Goal=6]="Goal",e[e.Lesson=7]="Lesson",e[e.Graph=8]="Graph",e[e.Type=9]="Type",e[e.Simulator=10]="Simulator",e[e.Data=11]="Data",e[e.Function=12]="Function",e[e.FunctionInputs=13]="FunctionInputs",e[e.Expression=14]="Expression",e[e.RangeExpression=15]="RangeExpression",e[e.MemberAccess=16]="MemberAccess",e[e.UsingExpression=17]="UsingExpression",e[e.StructLiteralOrType=18]="StructLiteralOrType"}(i||(i={}));var h=((r={})[i.Program]=["concept ","const ","experiment ","function ","graph ",'inkling "2.0"',"simulator ","data ","type ","using "],r[i.Concept]=["curriculum ","experiment ","import ","function ","programmed ","select "],r[i.Select]=["mask "],r[i.ConceptInputs]=["input"],r[i.Curriculum]=["action ","algorithm ","experiment ","goal ","lesson ","reward ","source ","state ","terminal ","training "],r[i.Lesson]=["experiment ","scenario ","training "],r[i.Goal]=["avoid","reach","drive","maximize","minimize","in","within"],r[i.Graph]=["concept ","input: ","output "],r[i.Type]=["number","string"],r[i.Simulator]=["package "],r[i.Data]=["dataset "],r[i.Function]=["else ","if ","return ","var "],r[i.FunctionInputs]=["action: ","config: ","state: "],r[i.Expression]=["and ","not ","or "],r[i.RangeExpression]=["step "],r),f=function(){function e(){}return e.getCompletionsForPosition=function(e,t,n,r,o){var s=r||t._editedParseResult||t._parseResult,c=s.lineStartPositions[n.line],u=n.line+1<s.lineStartPositions.length?s.lineStartPositions[n.line+1]:e.length,p=e.substring(c,u).substr(0,n.character),y=p.search(/(`|(`?\w+))$/),g=y>=0?p.substr(y):"";if(r&&!g&&!p.endsWith("."))return[];var h=new d.TokenProvider(s.tokens).getTokenAtOrBeforePosition(n);if(h&&h.token===m.Token.Comment&&h.text&&h.range.start.line===n.line)return[];var f=p.match(/\s+$/),T=n;f&&(T=new a.TextPosition(n.line,n.character-f[0].length));var v=l.ParseNodeUtils.getParseNodeForPosition(s.parseTree,T);if(!v)return[];var _=[],C=this._getContextFromNode(v);return C===i.MemberAccess?this._addMemberAccessCompletions(n,v,g,_):C===i.UsingExpression?this._addGlobalNamespaceCompletions(t,n,g,!1,_):C===i.StructLiteralOrType?this._addStructLiteralCompletions(n,v,g,_):(g.startsWith("`")||this._addKeywordCompletions(n,g,C,_),r||this._addLocalSymbolCompletions(n,g,v,_),o&&this._addLocalVariableCompletions(n,g,o,_),this._addGlobalSymbolCompletions(t,n,g,_),this._addGlobalNamespaceCompletions(t,n,g,void 0===r,_)),_},e._addLocalSymbolCompletions=function(e,t,n,r){for(var o=c.getScopeForNode(n);;){var i=o.getParent();if(!i)break;this._addSymbolsFromSymbolTable(o,e,t,r),o=i}},e._addLocalVariableCompletions=function(e,t,n,r){var i=this;n.forEach((function(n){if(i._isCompletionSimilar(t,n)){var s=y.TypeChecker.printIdentifier(n);r.push({label:s,kind:o.Variable,textEdit:{range:new a.TextRange(new a.TextPosition(e.line,e.character-t.length),e),newText:s},sortText:n})}}))},e._addGlobalSymbolCompletions=function(e,t,n,r){this._addSymbolsFromSymbolTable(e._globalSymbolTable,t,n,r)},e._addSymbolsFromSymbolTable=function(e,t,n,r){var i=this;e.getDefinedSymbols().forEach((function(e,s){if(i._isCompletionSimilar(n,s)){var c=void 0;switch(e.category){case p.SymbolCategory.Const:c=o.Constant;break;case p.SymbolCategory.Param:case p.SymbolCategory.Var:c=o.Variable;break;case p.SymbolCategory.Concept:c=o.Concept;break;case p.SymbolCategory.Function:c=o.Function;break;case p.SymbolCategory.Namespace:c=o.Namespace;break;case p.SymbolCategory.Simulator:c=o.Simulator;break;case p.SymbolCategory.Data:c=o.Data;break;case p.SymbolCategory.Type:c=o.Type;break;default:c=o.Other}var u=void 0;if(e.resolvedObject){var l=e.resolvedObject;l.comments&&(u=l.comments.map((function(e){return e.text})).join("\n"))}var d=y.TypeChecker.printIdentifier(s);r.push({label:d,kind:c,textEdit:{range:new a.TextRange(new a.TextPosition(t.line,t.character-n.length),t),newText:d},sortText:s,detail:u})}}))},e._addGlobalNamespaceCompletions=function(e,t,n,r,i){var c,l=this,d=e._globalSymbolTable.getSymbolsByCategory(p.SymbolCategory.Namespace),m=s.getBuiltInNamespaces();r&&!e._editedParseResult&&e._parseResult.parseTree.type===u.ParseNodeType.Program&&(e._parseResult.parseTree.statements.forEach((function(e){e.type===u.ParseNodeType.Using&&(c=e.range.end.line+1)})),void 0===c&&e._parseResult.parseTree.inklingVersion&&(c=e._parseResult.parseTree.inklingVersion.range.end.line+1)),m.forEach((function(e){if(l._isCompletionSimilar(n,e)&&!d.some((function(t){return t.name===e}))){var s={label:e,kind:o.Namespace,textEdit:{range:new a.TextRange(new a.TextPosition(t.line,t.character-n.length),t),newText:e},sortText:e};if(r){var u=new a.TextPosition(c||0,0);s.additionalTextEdits=[{range:new a.TextRange(u,u),newText:"using "+e+"\n"}]}i.push(s)}}))},e._addKeywordCompletions=function(e,t,n,r){var i=this,s=h[n];s&&s.forEach((function(n){if(i._isCompletionSimilar(t,n)){var s=n.search(/[ :]/),c=s<0?n:n.substr(0,s);r.push({label:c,kind:o.Keyword,textEdit:{range:new a.TextRange(new a.TextPosition(e.line,e.character-t.length),e),newText:n},sortText:c})}}))},e._addStructLiteralCompletions=function(e,t,n,r){for(var i=this,s=t;s.type!==u.ParseNodeType.StructLiteral&&s.type!==u.ParseNodeType.StructType;){if(!s.parent)return;s=s.parent}var l=new Map;s.fields.forEach((function(e){l.set(e.name.text,e.name.text)}));var p=c.getStructLiteralDataForNode(s);p&&p.expectedType.fields.forEach((function(t){if((!n||"`"===n||i._isCompletionSimilar(n,t.name))&&!l.has(t.name)){var s=y.TypeChecker.printIdentifier(t.name);r.push({label:s,kind:o.Field,textEdit:{range:new a.TextRange(new a.TextPosition(e.line,e.character-n.length),e),newText:s},sortText:t.name,detail:t.documentation})}}))},e._addMemberAccessCompletions=function(e,t,n,r){for(var i,s,l,d=this,m=t;m&&m.type!==u.ParseNodeType.MemberAccess;)m=m.parent;if(m){var h=c.getMemberAccessDataForNode(m);if(!h)return;i=h.baseNamespace,l=h.baseType}else{if(t.type!==u.ParseNodeType.Identifier)return;var f=c.getIdentifierDataForNode(t);if(!f||!f.resolvedObject)return;switch(f.symbolCategory){case p.SymbolCategory.Namespace:i=f.resolvedObject;break;case p.SymbolCategory.Type:l=(s=f.resolvedObject).type;break;case p.SymbolCategory.Const:var T=f.resolvedObject;T.type.category===g.TypeCategory.Struct&&(s=f.resolvedObject,l=T.type);break;case p.SymbolCategory.Param:case p.SymbolCategory.Var:var v=f.resolvedObject;v.type.category===g.TypeCategory.Struct&&(s=f.resolvedObject,l=v.type)}}var _=[];i?i.symbolTable.getDefinedSymbols().forEach((function(e,t){var n=o.Other;e.category===p.SymbolCategory.Function?n=o.Function:e.category===p.SymbolCategory.Const?n=o.Constant:e.category===p.SymbolCategory.Type&&(n=o.Type),_.push({name:t,kind:n,object:e.resolvedObject})})):l&&(l.category===g.TypeCategory.Struct?l.fields.forEach((function(e){_.push({name:e.name,kind:o.Field,object:s,documentation:e.documentation})})):l.category===g.TypeCategory.Number?l.enumeratedConstraint&&l.enumeratedConstraint.items.forEach((function(e){e.name&&_.push({name:e.name,kind:o.Other,object:s})})):l.category===g.TypeCategory.String&&l.enumeratedConstraint&&l.enumeratedConstraint.items.forEach((function(e){e.name&&_.push({name:e.name,kind:o.Other,object:s})}))),_.forEach((function(t){var o,i;if(!n||"`"===n||d._isCompletionSimilar(n,t.name)){var s=t.documentation||(null===(i=null===(o=t.object)||void 0===o?void 0:o.comments)||void 0===i?void 0:i.map((function(e){return e.text})).join("\n")),c=y.TypeChecker.printIdentifier(t.name);r.push({label:c,kind:t.kind,textEdit:{range:new a.TextRange(new a.TextPosition(e.line,e.character-n.length),e),newText:c},sortText:t.name,detail:s})}}))},e._getContextFromNode=function(e){for(var t,n=e;n;){switch(n.type){case u.ParseNodeType.Curriculum:return i.Curriculum;case u.ParseNodeType.Concept:return n.inputs.some((function(e){return e===t}))?i.ConceptInputs:n.outputType===t?i.Type:i.Concept;case u.ParseNodeType.Select:return i.Select;case u.ParseNodeType.Lesson:return i.Lesson;case u.ParseNodeType.Goal:return i.Goal;case u.ParseNodeType.Graph:return n.outputType===t||n.inputType===t?i.Type:i.Graph;case u.ParseNodeType.Type:return i.Type;case u.ParseNodeType.Simulator:return n.stateType===t?i.Type:i.Simulator;case u.ParseNodeType.Data:return n.stateType===t?i.Type:i.Data;case u.ParseNodeType.Function:return n.inputs.some((function(e){return e===t}))?i.FunctionInputs:n.outputType===t?i.Type:i.Function;case u.ParseNodeType.FunctionInput:return n.paramType===t?i.Type:i.FunctionInputs;case u.ParseNodeType.TypeArgument:if(n.argumentType===t)return i.Type;break;case u.ParseNodeType.Var:if(n.varType===t)return i.Type;break;case u.ParseNodeType.Program:return i.Program;case u.ParseNodeType.DotRange:return i.RangeExpression;case u.ParseNodeType.MemberAccess:return i.MemberAccess;case u.ParseNodeType.Using:return i.UsingExpression;case u.ParseNodeType.StructLiteral:case u.ParseNodeType.StructType:return i.StructLiteralOrType;case u.ParseNodeType.StructField:if(n.fieldType===t)return i.Type;break;case u.ParseNodeType.ArrayType:if(n.baseType===t)return i.Type;break;case u.ParseNodeType.Scenario:if(n.scenarioType===t)return i.Type}t=n,n=n.parent}return i.Unknown},e._isCompletionSimilar=function(e,t){var n=e;if(e.startsWith("`")&&(n=e.substr(1)),t.startsWith(n))return!0;var r=t.toLocaleLowerCase(),o=n.toLocaleLowerCase();return!!r.startsWith(o)},e}();t.CompletionProvider=f},4879:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerUtils=void 0;var r,o=n(2723),i=n(7585),a=n(785);(r=t.DebuggerUtils||(t.DebuggerUtils={})).evaluateConstantExpression=function(e,t,n,r,s){void 0===n&&(n=i.EvaluationStepAction.Run);var c=[],u=new a.Parser(e,c,t._compilerOptions).parseValueExpression(),l=new o.Analyzer(u,c,t._compilerOptions).analyzeConstantExpression(t,n,r,s);return{diagnostics:c,parseResult:u,value:null==l?void 0:l.value,stepResult:l?l.lastStepResults.join("\n"):void 0,context:l}},r.evaluateTypeExpression=function(e,t){var n=[],r=new a.Parser(e,n,t._compilerOptions).parseTypeExpression(),i=new o.Analyzer(r,n,t._compilerOptions).analyzeTypeExpression(t);return{diagnostics:n,parseResult:r,typeExpression:r.parseTree,type:i}},r.getCallStack=function(e){return i.ExpressionEvaluator.getCallStack(e)}},1616:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionProvider=void 0;var r=n(3649),o=n(6155),i=n(4847),a=function(){function e(){}return e.getDefinitionForPosition=function(e,t){var n,a=i.ParseNodeUtils.getParseNodeForPosition((null===(n=e._editedParseResult)||void 0===n?void 0:n.parseTree)||e._parseResult.parseTree,t);if(a&&a.type===o.ParseNodeType.Identifier){var s=r.getIdentifierDataForNode(a);if(s&&s.resolvedObject)return s.resolvedObject.nameRange||s.resolvedObject.declarationRange}},e}();t.DefinitionProvider=a},7585:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionEvaluator=t.EvaluationStepAction=void 0;var o,i,a=n(9194),s=n(4471),c=n(3649),u=n(6155),l=n(814),p=n(5454),d=n(6172),m=n(9948),y=n(9554),g=n(4393),h=n(2374),f=n(7379),T=n(1570);!function(e){e[e.StatementBlock=0]="StatementBlock",e[e.Expression=1]="Expression"}(o||(o={})),function(e){e[e.Run=0]="Run",e[e.Step=1]="Step"}(i=t.EvaluationStepAction||(t.EvaluationStepAction={}));var v=function(){function e(){}return e.createInterpreterContext=function(e,t,n){return{evaluationStack:new p.Stack([{type:o.Expression,node:e,operands:[]}]),lastStepResults:[],globalSymbolContext:t,localSymbolContext:n}},e.evaluateConstantExpression=function(e,t){var n=this.createInterpreterContext(e,t);return this.interpretExpression(n,i.Run),n.value||this._createInvalidValue()},e.interpretExpression=function(e,t){var n=!1;for(e.lastStepResults=[];;){var r=e.evaluationStack.getTop();if(r.type===o.Expression)switch(r.node.type){case u.ParseNodeType.BinaryOperation:0===r.operands.length?this._pushExpressionContext(e,r.node.leftOperand):1===r.operands.length?this._pushExpressionContext(e,r.node.rightOperand):this._popEvaluationContext(e,this._evaluateBinaryOperator(e,r.node,r.operands[0],r.operands[1]));break;case u.ParseNodeType.ParenthesizedExpression:0===r.operands.length?this._pushExpressionContext(e,r.node.expression):this._popEvaluationContext(e,r.operands[0]);break;case u.ParseNodeType.UnaryOperation:0===r.operands.length?this._pushExpressionContext(e,r.node.operand):this._popEvaluationContext(e,this._evaluateUnaryOperator(e,r.node,r.operands[0]));break;case u.ParseNodeType.Identifier:this._popEvaluationContext(e,this._evaluateIdentifier(e,r.node));break;case u.ParseNodeType.MemberAccess:this._popEvaluationContext(e,this._evaluateMemberAccess(e,r.node));break;case u.ParseNodeType.NumericLiteral:this._popEvaluationContext(e,{category:f.TypeCategory.Number,errorReported:!1,value:this._roundToFloat(r.node.value)});break;case u.ParseNodeType.False:case u.ParseNodeType.True:this._popEvaluationContext(e,{category:f.TypeCategory.Number,errorReported:!1,value:r.node.type===u.ParseNodeType.False?0:1});break;case u.ParseNodeType.StringLiteral:this._popEvaluationContext(e,{category:f.TypeCategory.String,errorReported:!1,value:r.node.value});break;case u.ParseNodeType.ArrayLiteral:r.operands.length<r.node.values.length?this._pushExpressionContext(e,r.node.values[r.operands.length]):this._popEvaluationContext(e,this._evaluateArrayLiteral(e,r.node,r.operands));break;case u.ParseNodeType.StructLiteral:r.operands.length<r.node.fields.length?this._pushExpressionContext(e,r.node.fields[r.operands.length].value):this._popEvaluationContext(e,this._evaluateStructLiteral(e,r.node,r.operands));break;case u.ParseNodeType.FunctionCall:if(r.returnValue){this._popEvaluationContext(e,r.returnValue);var i=new l.Printer({compactOutput:!0});e.lastStepResults.push("'"+i.printNode(r.node)+"' returned '"+this.printConstValue(r.returnValue)+"'")}else r.operands.length<r.node.arguments.length?this._pushExpressionContext(e,r.node.arguments[r.operands.length]):n=this._evaluateTransformOrFunctionCall(e,r,t);break;case u.ParseNodeType.ArrayAccess:0===r.operands.length?this._pushExpressionContext(e,r.node.array):1===r.operands.length?this._pushExpressionContext(e,r.node.index):this._popEvaluationContext(e,this._evaluateArrayAccess(e,r.node,r.operands[0],r.operands[1]));break;case u.ParseNodeType.ExpressionError:this._popEvaluationContext(e,this._createInvalidValue())}else r.type===o.StatementBlock&&(n=this._interpretStatement(e,r,t));if(void 0!==e.value||n)break}},e.isResultTypeSame=function(e,t,n){var r=this;if(e.category!==t.category)return!1;if(e.category===f.TypeCategory.Array){var o=e,i=t;return o.value.length===i.value.length&&!o.value.some((function(e,t){return!r.isResultTypeSame(e,i.value[t],n)}))}if(e.category===f.TypeCategory.Struct){var a=e,s=t,c=[];a.value.forEach((function(e,t){c.push(t)}));var u=[];if(s.value.forEach((function(e,t){u.push(t)})),c.length!==u.length)return!1;var l=!0;return c.forEach((function(e){s.value.has(e)&&r.isResultTypeSame(a.value.get(e),s.value.get(e),n)||(l=!1)})),l}if(e.category===f.TypeCategory.Number){if(n){var p=t;if(e.value!==p.value)return!1}}else if(e.category===f.TypeCategory.String){if(n){var d=t;if(e.value!==d.value)return!1}}else if(e.category===f.TypeCategory.Complex){var m=e,y=t;return h.TypeChecker.isTypeSame(m.type,y.type)}return!0},e.printConstValue=function(e){var t=this;switch(e.category){case f.TypeCategory.Number:return d.printValueSinglePrecision(e.value);case f.TypeCategory.String:return y.Tokenizer.encodeStringLiteral(e.value);case f.TypeCategory.Array:return"["+e.value.map((function(e){return t.printConstValue(e)})).join(", ")+"]";case f.TypeCategory.Struct:var n=[];return e.value.forEach((function(e,r){n.push(y.Tokenizer.encodeIdentifier(r)+": "+t.printConstValue(e))})),"{ "+n.join(", ")+" }";case f.TypeCategory.Complex:return h.TypeChecker.printType(e.type);default:throw new Error("printConstValue received unexpected type category")}},e.castValueToType=function(e,t){var n,o,i,a,s,c,u=this;if(e.category===t.category)switch(e.category){case f.TypeCategory.Number:var l=t.value;if(isNaN(l)||!isFinite(l))return;var p=e;if(p.rangeConstraint||p.enumeratedConstraint||(p=h.TypeChecker.synthesizeConstraintForNumberType(e)),p.rangeConstraint){var d=p.rangeConstraint;if(l<d.start)l=d.start;else if(l>d.stop&&(l=d.stop),void 0!==d.step){var m=Math.floor((d.stop-d.start)/d.step),y=Math.min(Math.round((l-d.start)/d.step),m);l=d.start+y*d.step}}else if(p.enumeratedConstraint){var g=void 0,T=void 0;try{for(var v=r(p.enumeratedConstraint.items),_=v.next();!_.done;_=v.next()){var C=_.value,b=Math.abs(l-C.value);(void 0===T||b<T)&&(g=C.value,T=b)}}catch(e){n={error:e}}finally{try{_&&!_.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}l=g}return{category:f.TypeCategory.Number,errorReported:!1,value:l};case f.TypeCategory.String:var k=t.value;if(e.enumeratedConstraint){var S=!1;try{for(var x=r(e.enumeratedConstraint.items),N=x.next();!N.done;N=x.next())(C=N.value).value===k&&(S=!0)}catch(e){i={error:e}}finally{try{N&&!N.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}if(!S){if(0===e.enumeratedConstraint.items.length)return;k=e.enumeratedConstraint.items[0].value}}return{category:f.TypeCategory.String,errorReported:!1,value:k};case f.TypeCategory.Array:var R=t;if(e.length!==R.value.length)return;var E={category:f.TypeCategory.Array,errorReported:!1,value:[]};try{for(var P=r(R.value),w=P.next();!w.done;w=P.next()){var D=w.value,F=this.castValueToType(e.baseType,D);if(!F)return;E.value.push(F)}}catch(e){s={error:e}}finally{try{w&&!w.done&&(c=P.return)&&c.call(P)}finally{if(s)throw s.error}}return E;case f.TypeCategory.Struct:var O=t,I={category:f.TypeCategory.Struct,errorReported:!1,value:new Map};return e.fields.forEach((function(e){var t=O.value.get(e.name);if(void 0===t)e.optional||(I.errorReported=!0);else{var n=u.castValueToType(e.type,t);n?I.value.set(e.name,n):I.errorReported=!0}})),I.errorReported?void 0:I}},e.getCallStack=function(e){var t=this,n=[],r=!0;return e.evaluationStack.forEachReversed((function(e){if(e.type===o.Expression)r||n.push({position:e.node.range.end,variables:new Map}),r=!0;else{if(r)if(e.statementIndex<e.block.statements.length){var i={position:e.block.statements[e.statementIndex].node.range.start,variables:new Map};t._addLocalVarValuesToStackEntry(e,i),n.push(i)}else e.block.statements.length>0&&(i={position:e.block.statements[e.statementIndex-1].node.range.end,variables:new Map},t._addLocalVarValuesToStackEntry(e,i),n.push(i));else if(n.length>0){var a=n[n.length-1];t._addLocalVarValuesToStackEntry(e,a)}r=!1}return!1})),n.length>0&&n.pop(),n},e._addLocalVarValuesToStackEntry=function(e,t){e.localVarValues.forEach((function(e,n){t.variables.set(n,e)}))},e._roundToFloat=function(e){return Math.fround(e)},e._evaluateBinaryOperator=function(e,t,n,r){if(n.errorReported||r.errorReported)return this._createInvalidValue();if(n.category!==f.TypeCategory.Number)return e.globalSymbolContext.onError("Expected numeric value",t.leftOperand),this._createInvalidValue();if(r.category!==f.TypeCategory.Number)return e.globalSymbolContext.onError("Expected numeric value",t.rightOperand),this._createInvalidValue();var o=this._roundToFloat(n.value),i=this._roundToFloat(r.value),a=0;switch(t.operator){case g.Token.Or:a=o||i?1:0;break;case g.Token.And:a=o&&i?1:0;break;case g.Token.EqualTo:a=o===i?1:0;break;case g.Token.NotEqualTo:a=o!==i?1:0;break;case g.Token.LessThan:a=o<i?1:0;break;case g.Token.LessEqual:a=o<=i?1:0;break;case g.Token.GreaterThan:a=o>i?1:0;break;case g.Token.GreaterEqual:a=o>=i?1:0;break;case g.Token.Plus:a=o+i;break;case g.Token.Minus:a=o-i;break;case g.Token.Multiply:a=o*i;break;case g.Token.Divide:a=o/i;break;case g.Token.Mod:a=o%i;break;case g.Token.Exponent:a=Math.pow(o,i)}return{category:f.TypeCategory.Number,errorReported:!1,value:this._roundToFloat(a)}},e._evaluateUnaryOperator=function(e,t,n){if(n.errorReported)return this._createInvalidValue();if(n.category!==f.TypeCategory.Number)return e.globalSymbolContext.onError("Expected numeric value",t.operand),this._createInvalidValue();var r=0,o=this._roundToFloat(n.value);switch(t.operator){case g.Token.Plus:r=o;break;case g.Token.Minus:r=-o;break;case g.Token.Not:r=o?0:1}return{category:f.TypeCategory.Number,errorReported:!1,value:this._roundToFloat(r)}},e._evaluateIdentifier=function(e,t){var n=this._lookUpLocalSymbol(e,t.text);if(null===n)return e.globalSymbolContext.onError("'"+t.text+"' has not been assigned a value",t),this._createInvalidValue();if(n)return n;var r=h.TypeChecker.resolveIdentifier(t,e.globalSymbolContext);return r?(c.setIdentifierDataForNode(t,{symbolCategory:r.category,resolvedObject:r.resolvedObject}),r.category!==m.SymbolCategory.Const?(e.globalSymbolContext.onError("Identifier '"+t.text+"' does not refer to a constant value",t),this._createInvalidValue()):e.globalSymbolContext.resolveSymbol(r).value):this._createInvalidValue()},e._evaluateMemberAccess=function(e,t){var n;if(t.leftExpression.type===u.ParseNodeType.Identifier){if(null===(n=this._lookUpLocalSymbol(e,t.leftExpression.text)))return e.globalSymbolContext.onError("'"+t.leftExpression.text+"' has not been assigned a value",t),this._createInvalidValue();if(!n){var r=h.TypeChecker.resolveIdentifier(t.leftExpression,e.globalSymbolContext);if(!r)return this._createInvalidValue();if(r.category===m.SymbolCategory.Namespace){var o=e.globalSymbolContext.resolveSymbol(r);return o.errorReported?this._createInvalidValue():(c.setMemberAccessDataForNode(t,{baseNamespace:o}),c.setIdentifierDataForNode(t.leftExpression,{symbolCategory:r.category,resolvedObject:o}),this.evaluateConstantExpression(t.identifier,e.globalSymbolContext.createNewContext(o.symbolTable)))}if(r.category===m.SymbolCategory.Type&&t.identifier.type===u.ParseNodeType.Identifier){var i=t.identifier.text,a=r;if(a&&a.category===m.SymbolCategory.Type){var s=e.globalSymbolContext.resolveSymbol(a);if(s.errorReported)return this._createInvalidValue();if(c.setMemberAccessDataForNode(t,{baseType:s.type}),s.type.category===f.TypeCategory.Number){if(s.type.enumeratedConstraint&&(l=s.type.enumeratedConstraint.items.find((function(e){return e.name===i}))))return{category:f.TypeCategory.Number,errorReported:!1,value:l.value}}else if(s.type.category===f.TypeCategory.String){var l;if(s.type.enumeratedConstraint&&(l=s.type.enumeratedConstraint.items.find((function(e){return e.name===i}))))return{category:f.TypeCategory.String,errorReported:!1,value:l.value}}}return e.globalSymbolContext.onError("'"+t.identifier.text+"' is not a named enumeration type",t),this._createInvalidValue()}}}if(n||(n=this.evaluateConstantExpression(t.leftExpression,e.globalSymbolContext)),n.errorReported)return n;if(n.category===f.TypeCategory.Struct){var p=t.identifier.text;return n.category===f.TypeCategory.Struct&&n.value.has(p)?n=n.value.get(p):(e.globalSymbolContext.onError("'"+p+"' is not a valid field name",t.identifier),this._createInvalidValue())}var d=t.identifier.text;return e.globalSymbolContext.onError("Cannot access member '"+d+"'",t),this._createInvalidValue()},e._evaluateArrayLiteral=function(e,t,n){var r=this,o=void 0!==n.find((function(e){return e.errorReported}));if(0===t.values.length)e.globalSymbolContext.onError("Array literal must contain at least one element",t),o=!0;else{var i=n.findIndex((function(e){return!r.isResultTypeSame(e,n[0],!1)}));i>=0&&(e.globalSymbolContext.onError("Elements in array literal must be same type",t.values[i]),o=!0)}return{category:f.TypeCategory.Array,errorReported:o,value:n}},e._evaluateStructLiteral=function(e,t,n){var r=new Map,o=!1;return t.fields.forEach((function(t,i){r.has(t.name.text)&&e.globalSymbolContext.onError("Duplicate field names not allowed in struct literal",t.name);var s=n[i];c.setIdentifierDataForNode(t.name,{symbolCategory:m.SymbolCategory.Field,documentation:t.comments.length>0?a.getDocumentationFromComments(t.comments):void 0,constExpressionData:s}),r.set(t.name.text,s),s.errorReported&&(o=!0)})),0===t.fields.length&&(e.globalSymbolContext.onError("Struct literal must define at least one field",t),o=!0),{category:f.TypeCategory.Struct,errorReported:o,value:r}},e._evaluateArrayAccess=function(e,t,n,r){return n.errorReported||r.errorReported?this._createInvalidValue():n.category!==f.TypeCategory.Array?(e.globalSymbolContext.onError("Value cannot be indexed like an array",t.index),this._createInvalidValue()):r.category===f.TypeCategory.Number&&Number.isInteger(r.value)?r.value<0?(e.globalSymbolContext.onError("Index cannot be negative",t.index),this._createInvalidValue()):r.value>=n.value.length?(e.globalSymbolContext.onError("Index "+r.value+" is out of range for array; maximum allowed index is "+(n.value.length-1),t.index),this._createInvalidValue()):n.value[r.value]:(e.globalSymbolContext.onError("Index must be an integer value",t.index),this._createInvalidValue())},e._evaluateTransformOrFunctionCall=function(e,t,n){var r,o=this,a=t.node;if(a.callExpression.type===u.ParseNodeType.MemberAccess){if(a.callExpression.leftExpression.type===u.ParseNodeType.Identifier&&(r=h.TypeChecker.resolveIdentifier(a.callExpression.leftExpression,e.globalSymbolContext))&&r.category===m.SymbolCategory.Namespace){var s=e.globalSymbolContext.resolveSymbol(r);s.errorReported||(c.setIdentifierDataForNode(a.callExpression.leftExpression,{symbolCategory:r.category,resolvedObject:s}),c.setMemberAccessDataForNode(a.callExpression,{baseNamespace:s}),(r=h.TypeChecker.resolveIdentifier(a.callExpression.identifier,e.globalSymbolContext.createNewContext(s.symbolTable)))&&r.resolvedObject&&c.setIdentifierDataForNode(a.callExpression.identifier,{symbolCategory:r.category,resolvedObject:r.resolvedObject}))}}else a.callExpression.type===u.ParseNodeType.Identifier&&(r=h.TypeChecker.resolveIdentifier(a.callExpression,e.globalSymbolContext));if(r){if(r.category===m.SymbolCategory.Type)return this._evaluateTransformCall(e,t,r.resolvedObject),!1;if(r.category===m.SymbolCategory.Function){var p=r.resolvedObject,d=this._verifyFunctionCallArguments(e,t,p);if(d){if(p.implementation){var y=void 0;try{y=p.implementation(t.operands)}catch(t){t.message&&e.globalSymbolContext.onError(t.message,a),y=this._createInvalidValue()}return this._popEvaluationContext(e,y),!1}var g=new Map;d.parameters.forEach((function(e,n){var r=t.operands[n],i=o.castValueToType(e.type,r);i&&(r=i.value),g.set(e.name,t.operands[n])})),this._pushStatementContext(e,p.functionBlock,g,p);var f=new l.Printer({compactOutput:!0});return e.lastStepResults.push("Stepped into '"+f.printNode(a.callExpression)+"'"),n!==i.Run}}}var T=new l.Printer({compactOutput:!0});return e.globalSymbolContext.onError("'"+T.printNode(a.callExpression)+"' is not callable",a),this._popEvaluationContext(e,this._createInvalidValue()),!1},e._evaluateTransformCall=function(e,t,n){var r=t.node;if(0===t.operands.length)e.globalSymbolContext.onError("Type cast requires one argument",r.callExpression);else if(t.operands.length>1)e.globalSymbolContext.onError("Type cast requires only one argument",r.arguments[1]);else{var o=n.type,i=h.TypeChecker.synthesizeTypeFromValue(t.operands[0]),a=new s.DiagnosticAddendum;if(h.TypeChecker.isTypeCastable(i,o,a)){var c=this.castValueToType(o,t.operands[0]);if(c)return void this._popEvaluationContext(e,c);e.globalSymbolContext.onError("Value of expression cannot be cast",r.arguments[0])}else e.globalSymbolContext.onError("Value of expression cannot be cast"+a.getString(),r.arguments[0])}this._popEvaluationContext(e,this._createInvalidValue())},e._getBestSignature=function(e,t){var n,o;if(1===e.length)return e[0];try{for(var i=r(e),a=i.next();!a.done;a=i.next()){var c=a.value;if(c.parameters.length===t.length){for(var u=!0,l=0;l<t.length;l++){var p=h.TypeChecker.synthesizeTypeFromValue(t[l]);if(!h.TypeChecker.isTypeAssignable(p,c.parameters[l].type,new s.DiagnosticAddendum)&&!h.TypeChecker.isTypeCastable(p,c.parameters[l].type,new s.DiagnosticAddendum)){u=!1;break}}if(u)return c}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return e[0]},e._verifyFunctionCallArguments=function(e,t,n){var r=t.operands,o=this._getBestSignature(n.signatures,r),i=t.node,a=o.parameters.length;if(r.length===a){for(var c=0;c<r.length;c++){var u=o.parameters[c],l=r[c],p=h.TypeChecker.synthesizeTypeFromValue(l),d=new s.DiagnosticAddendum;if(!h.TypeChecker.isTypeAssignable(p,u.type,d)){if(h.TypeChecker.isTypeCastable(p,u.type,new s.DiagnosticAddendum)){var m=this.castValueToType(u.type,l);if(m){r[c]=m;continue}}return void e.globalSymbolContext.onError("Argument "+(c+1)+" is not assignable to parameter '"+o.parameters[c].name+"'"+d.getString(),i.arguments[c])}}return o}e.globalSymbolContext.onError("Expected "+a+" argument"+(1===a?"":"s")+" but received "+r.length,i)},e._lookUpLocalSymbol=function(e,t){var n,r=!1;return e.evaluationStack.forEachReversed((function(e){if(r&&e.type===o.Expression)return!0;if(e.type===o.StatementBlock){r=!0;var i=e.localVarValues.get(t);if(void 0!==i)return n=i,!0}return!1})),void 0===n&&!r&&e.localSymbolContext?this._lookUpLocalSymbol(e.localSymbolContext,t):n},e._setLocalSymbolValue=function(e,t,n){var r=!1;e.evaluationStack.forEachReversed((function(e){return!(!r||e.type!==o.Expression)||!(e.type!==o.StatementBlock||(r=!0,!e.block.localSymbols.lookUpSymbol(t,!1,!1)))&&(e.localVarValues.set(t,n),!0)}))},e._moveToNextStatement=function(e,t){var n=new l.Printer({compactOutput:!0}),r=t.block.statements[t.statementIndex];r.node.type!==u.ParseNodeType.If&&e.lastStepResults.push("Stepped past statement '"+n.printNode(r.node)+"'"),t.statementIndex++,t.statementPhase=0},e._interpretStatement=function(e,t,n){if(t.returnValue)return this._popEvaluationContext(e,t.returnValue,!0),!1;var r=t.block.statements;if(t.statementIndex>=r.length){this._popEvaluationContext(e,this._createInvalidValue());var a=e.evaluationStack.getTop();return(null==a?void 0:a.type)!==o.StatementBlock&&n!==i.Run}var s=r[t.statementIndex];switch(s.category){case T.FunctionStatementCategory.Return:if(0!==t.statementPhase){var c=t.operands.pop()||this._createInvalidValue();return s.castToType&&(l=this.castValueToType(s.castToType,c))&&(c=l),t.returnValue=c,this._moveToNextStatement(e,t),e.lastStepResults.push("Returning value "+this.printConstValue(c)),n!==i.Run}this._pushExpressionContext(e,s.value.node);break;case T.FunctionStatementCategory.VarDeclaration:if(!s.initialValue)return this._moveToNextStatement(e,t),n!==i.Run;if(0!==t.statementPhase){var u=t.operands.pop()||this._createInvalidValue();return s.castFromType&&(l=this.castValueToType(s.type,u))&&(u=l),this._setLocalSymbolValue(e,s.name,u),this._moveToNextStatement(e,t),e.lastStepResults.push(s.name+" = "+this.printConstValue(u)),n!==i.Run}this._pushExpressionContext(e,s.initialValue.node);break;case T.FunctionStatementCategory.VarAssignment:var l;if(0!==t.statementPhase)return u=t.operands.pop()||this._createInvalidValue(),s.castToType&&(l=this.castValueToType(s.castToType,u))&&(u=l),this._setLocalSymbolValue(e,s.name,u),this._moveToNextStatement(e,t),e.lastStepResults.push(s.name+" = "+this.printConstValue(u)),n!==i.Run;this._pushExpressionContext(e,s.value.node);break;case T.FunctionStatementCategory.IfElse:if(0===t.statementPhase)this._pushExpressionContext(e,s.condition.node);else{if(1!==t.statementPhase)return this._moveToNextStatement(e,t),!1;if(u=t.operands.pop()||this._createInvalidValue(),this._isValueTruthy(u))this._pushStatementContext(e,s.ifBlock);else{if(!s.elseBlock)return this._moveToNextStatement(e,t),!1;this._pushStatementContext(e,s.elseBlock)}}break;default:e.globalSymbolContext.onError("Unsupported statement type",s),this._popEvaluationContext(e,this._createInvalidValue(),!0)}return!1},e._isValueTruthy=function(e){return e.category!==f.TypeCategory.Number||0!==e.value},e._pushExpressionContext=function(e,t){e.evaluationStack.push({type:o.Expression,node:t,operands:[]})},e._pushStatementContext=function(e,t,n,r){var i=new Map;t.localSymbols.getSymbolsByCategory(m.SymbolCategory.Var).forEach((function(e){i.set(e.name,null)})),n&&n.forEach((function(e,t){i.set(t,e)}));var a={type:o.StatementBlock,function:r,block:t,statementIndex:0,statementPhase:0,localVarValues:i,operands:[]};return e.evaluationStack.push(a),a},e._popEvaluationContext=function(e,t,n){void 0===n&&(n=!1);var r=e.evaluationStack.pop();if(r.type===o.Expression&&c.setConstExpressionDataForNode(r.node,t),e.evaluationStack.isEmpty())e.value=t;else{var i=e.evaluationStack.getTop();i.type===o.Expression?n?i.returnValue=t:i.operands.push(t):i.type===o.StatementBlock&&(i.statementPhase++,n?i.returnValue=t:i.operands.push(t))}},e._createInvalidValue=function(){return{category:f.TypeCategory.Number,errorReported:!0,value:0}},e}();t.ExpressionEvaluator=v},8312:function(e,t){var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getFromPartitions=t.partition=t.decodeFlattenedFieldName=t.encodeProtobufFieldName=t.encodeFlattenedFieldName=t.unflattenValue=t.flattenValue=void 0;var o="_schema_",i=/^[A-Za-z_][A-Za-z0-9_]*$/;function a(e,t){for(var n,r="",o=0;o<e.length;o++){var i=e[o];i.match(t)?r+=i:r+="%"+m((n=e.charCodeAt(o))>>4&15)+m(15&n)}return r}function s(e){var t=/^[A-Za-z0-9_]+$/;return e.match(t)?e:a(unescape(encodeURIComponent(e)),t)}function c(e){return decodeURI(e)}function u(e,t){return l(e,t)}function l(e,t){var n=new Map;return e.forEach((function(e,r){var o=r,i="";if(t&&""===r)throw new Error("Invalid flattened field name: Missing field name");if(r.startsWith("[")){if((a=r.indexOf("]"))<1)throw new Error("Invalid flattened field name: Missing close bracket");if(o=r.substr(0,a+1),(i=r.substr(a+1)).length>0)if(i.startsWith("."))i=i.substr(1);else if(!i.startsWith("["))throw new Error("Invalid flattened field name: Token after ] must be [ or .")}else{var a,s=r.indexOf(".");if((a=r.indexOf("["))>=0&&(s<0||s>a))o=r.substr(0,a),i=r.substr(a);else if(s>=0&&(o=r.substr(0,s),!(""!==(i=r.substr(s+1))&&""!==o||t&&r.startsWith("."))))throw new Error("Invalid flattened field name: Missing field name")}n.has(o)||n.set(o,new Map),n.get(o).set(i,e)})),n}function p(e){var t=r([],n(e.keys()));if(0===t.length)return new Map;var o=t[0];if(""===o){var i=e.get(o);if(i.has("")){if(1===t.length&&1===i.size)return i.get("");throw new Error("Invalid flattened field name: Cannot assign scalar with array or field")}return p(m=u(i,!1))}if(o.startsWith("[")){for(var a=[],s=0;;){var l="["+s+"]",d=e.get(l);if(!d)break;var m=u(d,!1);a.push(p(m)),e.delete(l),s++}if(e.size>0)throw new Error("Invalid flattened field name: Array must contain contiguous entries and cannot be combined with struct fields or scalars");if(0===a.length)throw new Error("Invalid flattened field name: Array must contain at least one entry");return a}var y=new Map;return t.forEach((function(t){if(""===t)throw new Error("Invalid flattened field name: Cannot assign scalar with field");if(t.startsWith("["))throw new Error("Invalid flattened field name: Cannot assign array with field");var n=u(e.get(t),!1),r=c(t);y.set(r,p(n))})),y}function d(e,t,n){if("object"==typeof t)if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=(n||".")+"["+r+"]";d(e,t[r],o)}else{var i=n?n+".":"";t.forEach((function(t,n){d(e,t,i+s(n))}))}else o=n||".",e.set(o,t)}function m(e){return e<=9?String.fromCharCode(48+e):String.fromCharCode(65+e-10)}t.flattenValue=function(e){var t=new Map;return d(t,e),t},t.unflattenValue=function(e){return p(u(e,!0))},t.encodeFlattenedFieldName=s,t.encodeProtobufFieldName=function(e){if(!function(e){return!e.match(i)||!!e.startsWith(o)}(e))return e;var t=a(e,/^[A-Za-z0-9]+$/);return o+t.replace(/%/g,"_")},t.decodeFlattenedFieldName=c,t.partition=l,t.getFromPartitions=p},3412:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HoverProvider=void 0;var r=n(9194),o=n(7585),i=n(3649),a=n(6155),s=n(4847),c=n(9948),u=n(2374),l=function(){function e(){}return e.getHoverForPosition=function(e,t){var n,r=s.ParseNodeUtils.getParseNodeForPosition((null===(n=e._editedParseResult)||void 0===n?void 0:n.parseTree)||e._parseResult.parseTree,t);if(r&&r.type===a.ParseNodeType.Identifier){var o="",c="",l=i.getIdentifierDataForNode(r);l&&(o="("+l.symbolCategory+") ",c=this._getAdditionalTypeInfoForIdentifier(l));var p=[{isInkling:!0,text:""+o+u.TypeChecker.printIdentifier(r.text)+c}];return l&&this._addCommentParts(l,p),{parts:p,range:r.range}}},e._getAdditionalTypeInfoForIdentifier=function(e){if(!e.resolvedObject)return"";switch(e.symbolCategory){case c.SymbolCategory.Function:return e.resolvedObject.signatures.map((function(e){var t=u.TypeChecker.printType(e.returnType);return"("+e.parameters.map((function(e){return e.name+": "+u.TypeChecker.printType(e.type)})).join(", ")+"): "+t})).join("\n");case c.SymbolCategory.Const:var t=e.resolvedObject;return" = "+o.ExpressionEvaluator.printConstValue(t.value);case c.SymbolCategory.Concept:var n=e.resolvedObject;return"("+n.inputs.map((function(e){var t="input";return e.inputConcept&&(t=e.inputConcept.name),t})).join(", ")+"): "+u.TypeChecker.printType(n.outputType);case c.SymbolCategory.Type:var r=e.resolvedObject;return" "+u.TypeChecker.printType(r.type,!1);case c.SymbolCategory.Field:var i=void 0;if(e.fieldType?i=e.fieldType:e.constExpressionData&&(i=u.TypeChecker.synthesizeTypeFromValue(e.constExpressionData)),i)return": "+u.TypeChecker.printType(i);break;case c.SymbolCategory.Var:case c.SymbolCategory.Param:var a=e.resolvedObject;return": "+u.TypeChecker.printType(a.type);case c.SymbolCategory.Simulator:case c.SymbolCategory.Data:var s=e.resolvedObject,l=u.TypeChecker.printType(s.actionType),p=s.configType?u.TypeChecker.printType(s.configType):void 0;return"(action: "+l+(p?", config: "+p:"")+"): "+u.TypeChecker.printType(s.stateType)}return""},e._addCommentParts=function(e,t){if(e.resolvedObject&&e.resolvedObject.comments){var n=r.getDocumentationFromComments(e.resolvedObject.comments);n&&t.push({text:n})}else e.documentation&&t.push({text:e.documentation})},e}();t.HoverProvider=l},6234:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportValidator=void 0;var r=n(4471),o=n(4847),i=n(2374),a={Model:{type:{category:n(7379).TypeCategory.String,errorReported:!1},documentation:"Reference to a model object"}},s=function(){function e(){}return e.validateImportValue=function(e,t,n){var s=!0;return t.value.forEach((function(t,c){var u=a[c];if(u){if(!i.TypeChecker.isValueAssignableToType(t,u.type)){var l=new r.DiagnosticAddendum;l.addMessage("Expected value of type '"+i.TypeChecker.printType(u.type)+"'"),n.onError("Value for field '"+c+"' is incorrect type"+l.getString(),o.ParseNodeUtils.getBestErrorNodeForField(e,c)),s=!1}}else n.onError("'"+c+"' is not a supported import field",o.ParseNodeUtils.getBestErrorNodeForField(e,c)),s=!1})),t.value.has("Model")||(n.onError("Required field 'Model' is missing",e),s=!1),s},e}();t.ImportValidator=s},5212:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2723),t),o(n(2250),t),o(n(6599),t),o(n(4471),t),o(n(9281),t),o(n(222),t),o(n(1206),t),o(n(4879),t),o(n(1616),t),o(n(7585),t),o(n(3412),t),o(n(6155),t),o(n(785),t),o(n(814),t),o(n(7220),t),o(n(5561),t),o(n(9554),t),o(n(4393),t),o(n(7379),t),o(n(1570),t)},7499:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBuiltInNamespaces=t.builtInNamespaces=void 0;var r=n(4471),o=n(6155),i=n(9371),a=n(9948),s=n(4393),c=n(7379);t.builtInNamespaces={};var u=c.getDefaultNumberType(),l={category:c.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[{name:"False",value:0},{name:"True",value:1}]},symbolicNamespace:"Number",symbolicName:"Bool"},p={category:c.TypeCategory.Number,rangeConstraint:{start:-128,stop:127,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"Int8"},d={category:c.TypeCategory.Number,rangeConstraint:{start:-32768,stop:32767,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"Int16"},m={category:c.TypeCategory.Number,rangeConstraint:{start:-2147483648,stop:2147483647,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"Int32"},y={category:c.TypeCategory.Number,rangeConstraint:{start:-0x8000000000000000,stop:0x8000000000000000,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"Int64"},g={category:c.TypeCategory.Number,rangeConstraint:{start:0,stop:255,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"UInt8"},h={category:c.TypeCategory.Number,rangeConstraint:{start:0,stop:65535,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"UInt16"},f={category:c.TypeCategory.Number,rangeConstraint:{start:0,stop:4294967295,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"UInt32"},T={category:c.TypeCategory.Number,rangeConstraint:{start:0,stop:0x10000000000000000,step:1},errorReported:!1,symbolicNamespace:"Number",symbolicName:"UInt64"},v={category:c.TypeCategory.Number,errorReported:!1,symbolicNamespace:"Number",symbolicName:"Float32"},_={category:c.TypeCategory.Number,rangeConstraint:{start:-Number.MAX_VALUE,stop:Number.MAX_VALUE},errorReported:!1,symbolicNamespace:"Number",symbolicName:"Float64"},C={category:c.TypeCategory.Number,rangeConstraint:{start:0,stop:1},errorReported:!1},b=g,k={category:c.TypeCategory.Array,errorReported:!1,baseType:u,length:1},S={category:c.TypeCategory.Array,errorReported:!1,baseType:u,length:2},x={category:c.TypeCategory.Array,errorReported:!1,baseType:u,length:3},N={category:c.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:1,stop:65535,step:1}},R={category:c.TypeCategory.Complex,errorReported:!1,usage:c.ComplexTypeUsage.GraphInput|c.ComplexTypeUsage.NonLearnedConceptInput|c.ComplexTypeUsage.SourceState,internalClass:c.ComplexTypeClass.ImageGray,typeArguments:[],typeParameters:[{name:"Width",validationTypes:[N],validateMustConstrain:!0,validateSingleValue:!0},{name:"Height",validationTypes:[N],validateMustConstrain:!0,validateSingleValue:!0},{name:"ElementType",defaultType:C,validationTypes:[C],validateExactMatch:!0}]},E={category:c.TypeCategory.Complex,errorReported:!1,usage:c.ComplexTypeUsage.GraphInput|c.ComplexTypeUsage.NonLearnedConceptInput|c.ComplexTypeUsage.SourceState,internalClass:c.ComplexTypeClass.ImageRGB,typeArguments:[],typeParameters:[{name:"Width",validationTypes:[N],validateMustConstrain:!0,validateSingleValue:!0},{name:"Height",validationTypes:[N],validateMustConstrain:!0,validateSingleValue:!0},{name:"ElementType",defaultType:C,validationTypes:[C,b],validateExactMatch:!0}]},P={category:c.TypeCategory.Complex,errorReported:!1,usage:c.ComplexTypeUsage.None,internalClass:c.ComplexTypeClass.GoalTargetRegion,typeArguments:[],typeParameters:[{name:"Dimensions",validationTypes:[N],validateMustConstrain:!0,validateSingleValue:!1},{name:"UnboundedMin",validationTypes:[l],validateMustConstrain:!0,validateSingleValue:!1},{name:"UnboundedMax",validationTypes:[l],validateMustConstrain:!0,validateSingleValue:!1}]},w=new r.TextRange(new r.TextPosition(0,0),new r.TextPosition(0,0));function D(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r={category:c.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[{value:e}]}},o={category:c.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[{value:t?1:0}]}},i={category:c.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[{value:n?1:0}]}};return{category:c.TypeCategory.Complex,errorReported:!1,usage:P.usage,internalClass:P.internalClass,typeParameters:P.typeParameters,typeArguments:[r,o,i]}}function F(e,t,n){var r={errorReported:!1,name:e,type:t,comments:[{fullLine:!0,text:n}]};return{name:e,category:a.SymbolCategory.Type,resolvedObject:r,referenced:!0,node:{type:o.ParseNodeType.Type,range:w,comments:[{fullLine:!0,text:n}],name:{type:o.ParseNodeType.Identifier,range:w,text:""},declaredType:{type:o.ParseNodeType.Number,range:w}}}}function O(e,t,n,r){return{name:e,category:a.SymbolCategory.Const,resolvedObject:{errorReported:!1,name:e,comments:[{fullLine:!0,text:r}],type:t,value:{errorReported:!1,category:c.TypeCategory.Number,value:n}},referenced:!0,node:{type:o.ParseNodeType.Const,range:w,comments:[],name:{type:o.ParseNodeType.Identifier,range:w,text:""},value:{type:o.ParseNodeType.NumericLiteral,range:w,text:"",value:n}}}}function I(e,t,n,r){return{name:e,category:a.SymbolCategory.Function,resolvedObject:{errorReported:!1,comments:[{fullLine:!0,text:n}],signatures:t,functionBlock:{errorReported:!1,comments:[],localSymbols:new i.SymbolTable,statements:[]},implementation:r},referenced:!0,node:{range:w,name:{type:o.ParseNodeType.Identifier,range:w,text:""},comments:[],type:o.ParseNodeType.Function,functionToken:{token:s.Token.Function,text:"function",range:w},inputs:[],block:{type:o.ParseNodeType.FunctionBlock,range:w,statements:[]}}}}function A(e,t,n){if(t.length!==n)throw new Error(e+": Expecting "+n+" argument"+(1===n?"":"s")+" but received "+t.length);for(var r=[],o=0;o<t.length;o++){if(t[o].category!==c.TypeCategory.Number)throw new Error(e+": Argument "+o+" is not a numeric type");if(isNaN(t[o].value))throw new Error(e+": Argument "+o+" is not a number (NaN)");if(!isFinite(t[o].value))throw new Error(e+": Argument "+o+" is infinite");r.push(Math.fround(t[o].value))}return r}function L(e){return{category:c.TypeCategory.Number,errorReported:!1,value:e}}!function(){var e=new i.SymbolTable;e.addSymbol(F("Bool",l,"Boolean value, either 0 or 1")),e.addSymbol(F("Int8",p,"Signed 8-bit integer")),e.addSymbol(F("Int16",d,"Signed 16-bit integer")),e.addSymbol(F("Int32",m,"Signed 32-bit integer")),e.addSymbol(F("Int64",y,"Signed 64-bit integer")),e.addSymbol(F("UInt8",g,"Unsigned 8-bit integer")),e.addSymbol(F("UInt16",h,"Unsigned 16-bit integer")),e.addSymbol(F("UInt32",f,"Unsigned 32-bit integer")),e.addSymbol(F("UInt64",T,"Unsigned 64-bit integer")),e.addSymbol(F("Float32",v,"32-bit floating point")),e.addSymbol(F("Float64",_,"64-bit floating point")),t.builtInNamespaces.Number=e;var n=new i.SymbolTable;n.addSymbol(F("Gray",R,"Gray-scale image (2D luminance map)")),n.addSymbol(F("RGB",E,"RGB image (three color channels)")),t.builtInNamespaces.Image=n;var r=new i.SymbolTable;r.addSymbol(F("TargetRegion",P,"Target region for a goal")),r.addSymbol(I("Range",[{parameters:[{name:"Min",type:u},{name:"Max",type:u}],returnType:D(1)}],"Creates a one-dimensional inclusive range (Min to Max)",(function(e){return{category:c.TypeCategory.Complex,value:void 0,errorReported:!1,type:D(1)}}))),r.addSymbol(I("RangeAbove",[{parameters:[{name:"Min",type:u}],returnType:D(1,!1,!0)}],"Creates a one-dimensional inclusive range with a floor but no ceiling",(function(e){return{category:c.TypeCategory.Complex,value:void 0,errorReported:!1,type:D(1,!1,!0)}}))),r.addSymbol(I("RangeBelow",[{parameters:[{name:"Min",type:u}],returnType:D(1,!0,!1)}],"Creates a one-dimensional inclusive range with a ceiling but no floor",(function(e){return{category:c.TypeCategory.Complex,value:void 0,errorReported:!1,type:D(1,!0,!1)}}))),r.addSymbol(I("Sphere",[{parameters:[{name:"Point",type:u},{name:"Radius",type:u}],returnType:D(1)},{parameters:[{name:"Point",type:k},{name:"Radius",type:u}],returnType:D(1)},{parameters:[{name:"Point",type:S},{name:"Radius",type:u}],returnType:D(2)},{parameters:[{name:"Point",type:x},{name:"Radius",type:u}],returnType:D(3)}],"Creates an n-dimensional spherical region",(function(e){var t=e[0],n=t.category===c.TypeCategory.Array?t.value.length:1;return{category:c.TypeCategory.Complex,value:void 0,errorReported:!1,type:D(n)}}))),t.builtInNamespaces.Goal=r;var o=new i.SymbolTable;o.addSymbol(O("Pi",u,Math.PI,"Ratio of circumference to diameter")),o.addSymbol(O("E",u,Math.E,"Base of natural logarithm"));var a=[{parameters:[{name:"X",type:u}],returnType:u}],s=[{parameters:[{name:"X",type:u},{name:"Y",type:u}],returnType:u}],C=[{parameters:[{name:"Y",type:u},{name:"X",type:u}],returnType:u}];o.addSymbol(I("Abs",a,"Absolute value",(function(e){var t=A("Math.Abs",e,1);return L(Math.abs(t[0]))}))),o.addSymbol(I("ArcCos",a,"Inverse cosine (return value in radians)",(function(e){var t=A("Math.ArcCos",e,1);return L(Math.acos(t[0]))}))),o.addSymbol(I("ArcSin",a,"Inverse sine (return value in radians)",(function(e){var t=A("Math.ArcSin",e,1);return L(Math.asin(t[0]))}))),o.addSymbol(I("ArcTan",a,"Inverse tangent (return value in radians)",(function(e){var t=A("Math.ArcTan",e,1);return L(Math.atan(t[0]))}))),o.addSymbol(I("ArcTan2",C,"Two-parameter form of inverse tangent (return value in radians)",(function(e){var t=A("Math.ArcTan2",e,2);return L(Math.atan2(t[0],t[1]))}))),o.addSymbol(I("Ceil",a,"Rounds up to nearest integer",(function(e){var t=A("Math.Ceil",e,1);return L(Math.ceil(t[0]))}))),o.addSymbol(I("Cos",a,"Cosine of angle (specified in radians)",(function(e){var t=A("Math.Cos",e,1);return L(Math.cos(t[0]))}))),o.addSymbol(I("Floor",a,"Rounds down to nearest integer",(function(e){var t=A("Math.Floor",e,1);return L(Math.floor(t[0]))}))),o.addSymbol(I("Hypot",s,"Hypotenuse of triangle with specified side lengths",(function(e){var t=A("Math.Hypot",e,2);return L(Math.hypot(t[0],t[1]))}))),o.addSymbol(I("Log",a,"Natural logarithm",(function(e){var t=A("Math.Log",e,1);return L(Math.log(t[0]))}))),o.addSymbol(I("Max",s,"Maximum of two values",(function(e){var t=A("Math.Max",e,2);return L(Math.max(t[0],t[1]))}))),o.addSymbol(I("Min",s,"Minimum of two values",(function(e){var t=A("Math.Min",e,2);return L(Math.min(t[0],t[1]))}))),o.addSymbol(I("Sin",a,"Sine of angle (specified in radians)",(function(e){var t=A("Math.Sin",e,1);return L(Math.sin(t[0]))}))),o.addSymbol(I("Sqrt",a,"Square root",(function(e){var t=A("Math.Sqrt",e,1);return L(Math.sqrt(t[0]))}))),o.addSymbol(I("Tan",a,"Tangent of angle (specified in radians)",(function(e){var t=A("Math.Tan",e,1);return L(Math.tan(t[0]))}))),t.builtInNamespaces.Math=o}(),t.getBuiltInNamespaces=function(){return Object.keys(t.builtInNamespaces)}},3649:(e,t)=>{function n(e){return e._analyzerData||(e._analyzerData={}),e._analyzerData}function r(e){var t=e._analyzerData;if(t)return t.scopeData}Object.defineProperty(t,"__esModule",{value:!0}),t.setMemberAccessDataForNode=t.getMemberAccessDataForNode=t.setStructLiteralDataForNode=t.getStructLiteralDataForNode=t.setConstExpressionDataForNode=t.getConstExpressionDataForNode=t.setFunctionCallDataForNode=t.getFunctionCallDataForNode=t.setUnaryOperationDataForNode=t.getUnaryOperationDataForNode=t.setBinaryOperationDataForNode=t.getBinaryOperationDataForNode=t.setIdentifierDataForNode=t.getIdentifierDataForNode=t.getScopeForNode=t.setScopeDataForNode=t.getScopeDataForNode=void 0,t.getScopeDataForNode=r,t.setScopeDataForNode=function(e,t){n(e).scopeData=t},t.getScopeForNode=function(e){for(;;){var t=r(e);if(t)return t.symbolTable;if(void 0===e.parent)throw"Did not find scope";e=e.parent}},t.getIdentifierDataForNode=function(e){var t=e._analyzerData;if(t)return t.identifierData},t.setIdentifierDataForNode=function(e,t){n(e).identifierData=t},t.getBinaryOperationDataForNode=function(e){var t=e._analyzerData;if(t)return t.binaryOperationData},t.setBinaryOperationDataForNode=function(e,t){n(e).binaryOperationData=t},t.getUnaryOperationDataForNode=function(e){var t=e._analyzerData;if(t)return t.unaryOperationData},t.setUnaryOperationDataForNode=function(e,t){n(e).unaryOperationData=t},t.getFunctionCallDataForNode=function(e){var t=e._analyzerData;if(t)return t.functionCallData},t.setFunctionCallDataForNode=function(e,t){n(e).functionCallData=t},t.getConstExpressionDataForNode=function(e){var t=e._analyzerData;if(t)return t.constExpressionData},t.setConstExpressionDataForNode=function(e,t){n(e).constExpressionData=t},t.getStructLiteralDataForNode=function(e){var t=e._analyzerData;if(t)return t.structLiteralData},t.setStructLiteralDataForNode=function(e,t){n(e).structLiteralData=t},t.getMemberAccessDataForNode=function(e){var t=e._analyzerData;if(t)return t.memberAccessData},t.setMemberAccessDataForNode=function(e,t){n(e).memberAccessData=t}},4847:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseNodeUtils=void 0;var a=n(2357),s=n(6155),c=function(){function e(){}return e.getParseNodeForPosition=function(e,t){for(var n=e;;){var r=this.getChildNodes(n).find((function(e){return e&&e.range.isPositionWithin(t)}));if(!r)return n;n=r}},e.getParseNodeBeforePosition=function(e,t){for(var n,o,i=e;;){var a=this.getChildNodes(i);if(0===a.length)return i;var s=!1,c=void 0;try{for(var u=(n=void 0,r(a)),l=u.next();!l.done;l=u.next()){var p=l.value;if(p){if(p.range.isPositionWithin(t)){s=!0,c=p;break}p.range.end.isBeforeOrSame(t)&&(c&&!c.range.start.isBefore(p.range.end)||(c=p))}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}if(!c)return i;if(!s)return c;i=c}},e.getBestErrorNodeForField=function(e,t){return e.type!==s.ParseNodeType.StructLiteral?e:e.fields.find((function(e){return e.name.text===t}))||e},e.addParentLinks=function(e){var t=this;this.getChildNodes(e).forEach((function(n){n&&(n.parent=e,t.addParentLinks(n))}))},e.getChildNodes=function(e){switch(e.type){case s.ParseNodeType.Algorithm:return[e.expression];case s.ParseNodeType.ArrayAccess:return[e.array,e.index];case s.ParseNodeType.ArrayLiteral:return e.values;case s.ParseNodeType.ArrayType:return[e.baseType,e.length];case s.ParseNodeType.BinaryOperation:return[e.leftOperand,e.rightOperand];case s.ParseNodeType.Comment:return[];case s.ParseNodeType.Concept:return i(i(i(i([e.name,e.experiment],o(e.inputs)),[e.outputType,e.curriculum]),o(e.selects)),[e.programmedFunction,e.endComment]);case s.ParseNodeType.ConceptInput:return[e.inputSource];case s.ParseNodeType.Const:return[e.constantType,e.value,e.name];case s.ParseNodeType.Curriculum:return i(i(i(i([e.experiment,e.algorithm],o(e.sources)),[e.state,e.action,e.reward,e.terminal,e.goal,e.training]),o(e.lessons)),[e.endComment]);case s.ParseNodeType.Data:return[e.name,e.actionParam,e.stateType,e.configParam,e.objectReference,e.endComment];case s.ParseNodeType.Dataset:return[e.expression];case s.ParseNodeType.DataSource:return[e.dataSource];case s.ParseNodeType.DotRange:return[e.start,e.stop,e.step];case s.ParseNodeType.Experiment:case s.ParseNodeType.Import:return[e.expression];case s.ParseNodeType.Function:return i(i([e.name],o(e.inputs)),[e.outputType,e.block]);case s.ParseNodeType.FunctionBlock:return i(i([],o(e.statements)),[e.endComment]);case s.ParseNodeType.FunctionCall:return i([e.callExpression],o(e.arguments));case s.ParseNodeType.FunctionInput:return[e.name,e.paramType];case s.ParseNodeType.FunctionReference:return[e.functionRef];case s.ParseNodeType.Goal:return i(i(i([],o(e.inputs)),o(e.subgoals)),[e.endComment]);case s.ParseNodeType.GoalAtom:return[e.name,e.valueExpression,e.targetExpression];case s.ParseNodeType.Graph:return i(i([],o(e.concepts)),[e.inputType,e.output,e.outputType,e.endComment]);case s.ParseNodeType.Identifier:return[];case s.ParseNodeType.If:return[e.condition,e.ifBlock,e.elseBlock,e.elseIfStatement];case s.ParseNodeType.Inkling:return[e.versionString];case s.ParseNodeType.Input:return[];case s.ParseNodeType.Lesson:return[e.scenario,e.experiment,e.name,e.training,e.endComment];case s.ParseNodeType.MemberAccess:return[e.leftExpression,e.identifier];case s.ParseNodeType.NumericLiteral:return[];case s.ParseNodeType.Output:return[e.outputSource];case s.ParseNodeType.ParenthesizedExpression:return[e.expression];case s.ParseNodeType.Number:case s.ParseNodeType.String:return[];case s.ParseNodeType.Package:return[e.expression];case s.ParseNodeType.Program:return i(i([e.inklingVersion],o(e.statements)),[e.endComment]);case s.ParseNodeType.Return:return[e.value];case s.ParseNodeType.Scenario:return[e.scenarioType];case s.ParseNodeType.Select:return[e.targetConcept,e.maskFunction,e.endComment];case s.ParseNodeType.Simulator:return[e.name,e.actionParam,e.stateType,e.configParam,e.objectReference,e.endComment];case s.ParseNodeType.SpecializedType:return[e.baseType,e.specialization];case s.ParseNodeType.StringLiteral:return[];case s.ParseNodeType.StructField:return[e.name,e.fieldType];case s.ParseNodeType.StructLiteral:return i(i([],o(e.fields)),[e.endComment]);case s.ParseNodeType.StructLiteralField:return[e.name,e.value];case s.ParseNodeType.StructType:return i(i([],o(e.fields)),[e.endComment]);case s.ParseNodeType.Training:return[e.expression];case s.ParseNodeType.TypeArgument:return[e.argumentName,e.argumentType];case s.ParseNodeType.TypeArgumentsList:return e.typeArguments;case s.ParseNodeType.Type:return[e.name,e.declaredType];case s.ParseNodeType.UnaryOperation:return[e.operand];case s.ParseNodeType.Using:return[e.name];case s.ParseNodeType.Var:return[e.name,e.varType,e.value];case s.ParseNodeType.VarAssignment:return[e.name,e.value]}return[]},e.replaceFunctionDeclarationNode=function(e,t){var n=e.parent;if(n||a.fail("Existing function is not part of a parse tree"),n.type===s.ParseNodeType.Program){var r=n.statements.findIndex((function(t){return t===e}));r<0&&a.fail("Could not find global function declaration"),n.statements[r]=t,t.parent=n}else n.type===s.ParseNodeType.FunctionReference?(n.functionRef=t,t.parent=n):a.fail("Unexpected parent for function declaration")},e.replaceGoalDeclarationNode=function(e,t){var n=e.parent;n||a.fail("Existing goal is not part of a parse tree"),n.type===s.ParseNodeType.Curriculum?(n.goal=t,t.parent=n):a.fail("Unexpected parent for goal declaration")},e.replaceTypeDeclarationNode=function(e,t){var n=e.parent;if(n||a.fail("Existing type declaration is not part of a parse tree"),n.type===s.ParseNodeType.Program){var r=n.statements.findIndex((function(t){return t===e}));r<0&&a.fail("Could not find global type declaration"),n.statements[r]=t,t.parent=n}else a.fail("Unexpected parent for type declaration")},e.replaceConstDeclarationNode=function(e,t){var n=e.parent;if(n||a.fail("Existing const declaration is not part of a parse tree"),n.type===s.ParseNodeType.Program){var r=n.statements.findIndex((function(t){return t===e}));r<0&&a.fail("Could not find global const declaration"),n.statements[r]=t,t.parent=n}else a.fail("Unexpected parent for const declaration")},e.replaceScenarioTypeNode=function(e,t){var n=e.parent;n||a.fail("Existing type declaration is not part of a parse tree"),n.scenarioType=t,t.parent=n},e.addScenarioToLesson=function(e,t){e.scenario&&a.fail("Lesson already has an existing scenario"),e.scenario=t},e.removeScenarioFromLesson=function(e){e.scenario||a.fail("Lesson does not have a scenario to remove"),e.scenario=void 0},e.addGlobalStatement=function(e,t){e.statements.push(t),t.parent=e},e.removeGlobalStatement=function(e,t){e.statements=e.statements.filter((function(e){return e!==t}))},e}();t.ParseNodeUtils=c},6155:(e,t)=>{var n;function r(e){switch(e.type){case n.BinaryOperation:case n.ParenthesizedExpression:case n.FunctionCall:case n.UnaryOperation:case n.Identifier:case n.MemberAccess:case n.NumericLiteral:case n.StringLiteral:case n.ArrayLiteral:case n.StructLiteral:case n.ArrayAccess:case n.ExpressionError:return!0}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.isTypeNode=t.isExpressionNode=t.ParseNodeType=void 0,function(e){e[e.Algorithm=0]="Algorithm",e[e.ArrayAccess=1]="ArrayAccess",e[e.ArrayLiteral=2]="ArrayLiteral",e[e.ArrayType=3]="ArrayType",e[e.BinaryOperation=4]="BinaryOperation",e[e.Comment=5]="Comment",e[e.Concept=6]="Concept",e[e.ConceptInput=7]="ConceptInput",e[e.Const=8]="Const",e[e.Curriculum=9]="Curriculum",e[e.Data=10]="Data",e[e.DataSource=11]="DataSource",e[e.DotRange=12]="DotRange",e[e.Experiment=13]="Experiment",e[e.ExpressionError=14]="ExpressionError",e[e.Import=15]="Import",e[e.False=16]="False",e[e.Function=17]="Function",e[e.FunctionBlock=18]="FunctionBlock",e[e.FunctionCall=19]="FunctionCall",e[e.FunctionInput=20]="FunctionInput",e[e.FunctionReference=21]="FunctionReference",e[e.Graph=22]="Graph",e[e.Goal=23]="Goal",e[e.GoalAtom=24]="GoalAtom",e[e.Identifier=25]="Identifier",e[e.If=26]="If",e[e.Inkling=27]="Inkling",e[e.Input=28]="Input",e[e.Lesson=29]="Lesson",e[e.MemberAccess=30]="MemberAccess",e[e.Number=31]="Number",e[e.NumericLiteral=32]="NumericLiteral",e[e.Output=33]="Output",e[e.Package=34]="Package",e[e.Dataset=35]="Dataset",e[e.ParenthesizedExpression=36]="ParenthesizedExpression",e[e.Program=37]="Program",e[e.Return=38]="Return",e[e.Scenario=39]="Scenario",e[e.Select=40]="Select",e[e.Simulator=41]="Simulator",e[e.SpecializedType=42]="SpecializedType",e[e.String=43]="String",e[e.StringLiteral=44]="StringLiteral",e[e.StructField=45]="StructField",e[e.StructLiteral=46]="StructLiteral",e[e.StructLiteralField=47]="StructLiteralField",e[e.StructType=48]="StructType",e[e.Training=49]="Training",e[e.True=50]="True",e[e.Type=51]="Type",e[e.TypeArgument=52]="TypeArgument",e[e.TypeArgumentsList=53]="TypeArgumentsList",e[e.UnaryOperation=54]="UnaryOperation",e[e.Using=55]="Using",e[e.Var=56]="Var",e[e.VarAssignment=57]="VarAssignment"}(n=t.ParseNodeType||(t.ParseNodeType={})),t.isExpressionNode=r,t.isTypeNode=function(e){switch(e.type){case n.SpecializedType:case n.Number:case n.String:case n.ArrayType:case n.StructType:return!0}return r(e)}},9539:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeRenameWalker=t.FunctionRenameWalker=t.ConstRenameWalker=t.DataRenameWalker=t.SimulatorRenameWalker=t.SourceRenameWalker=t.LessonRenameWalker=t.ConceptRenameWalker=t.RenameWalker=void 0;var s=n(6155),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._oldName="",t._newName="",t}return o(t,e),t.prototype.rename=function(e,t,n){this._oldName=t,this._newName=n,this.walk(e)},t.prototype.visitMemberAccess=function(e){return!1},t.prototype.visitIdentifier=function(e){return e.text===this._oldName&&(void 0!==e.parent&&e.parent.name===e||(e.text=this._newName)),!0},t.prototype.visitTypeArgument=function(e){return this.walk(e.argumentType),!1},t}(n(4759).ParseTreeWalker);t.RenameWalker=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitConceptDeclaration=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),!0},t}(c);t.ConceptRenameWalker=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitLesson=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),!0},t}(c);t.LessonRenameWalker=l;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitSourceDeclaration=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),!0},t.prototype.visitDataSource=function(e){return e.dataSource.type===s.ParseNodeType.Identifier&&e.dataSource.text===this._oldName&&(e.dataSource.text=this._newName),!1},t}(c);t.SourceRenameWalker=p;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitSimulatorDeclaration=function(e){return this.visitSourceDeclaration(e)},t}(p);t.SimulatorRenameWalker=d;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitDataDeclaration=function(e){return this.visitSourceDeclaration(e)},t}(p);t.DataRenameWalker=m;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitConstDeclaration=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),this.walk(e.value),!1},t}(c);t.ConstRenameWalker=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitFunctionDeclaration=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),this.walkMultiple(a(a([],i(e.inputs)),[e.outputType,e.block])),!1},t}(c);t.FunctionRenameWalker=g;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.visitTypeDeclaration=function(e){return e.name.text===this._oldName&&(e.name.text=this._newName),this.walk(e.declaredType),!1},t}(c);t.TypeRenameWalker=h},4759:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeWalker=void 0;var r=n(6155),o=n(4847),i=function(){function e(){}return e.prototype.walk=function(e){var t=this.visitNode(e);t.length>0&&this.walkMultiple(t)},e.prototype.walkMultiple=function(e){var t=this;e.forEach((function(e){e&&t.walk(e)}))},e.prototype.visitNode=function(e){var t=!0;switch(e.type){case r.ParseNodeType.Algorithm:t=this.visitAlgorithm(e);break;case r.ParseNodeType.ArrayAccess:t=this.visitArrayAccess(e);break;case r.ParseNodeType.ArrayLiteral:t=this.visitArrayLiteral(e);break;case r.ParseNodeType.ArrayType:t=this.visitArrayType(e);break;case r.ParseNodeType.BinaryOperation:t=this.visitBinaryOperation(e);break;case r.ParseNodeType.Comment:t=this.visitComment(e);break;case r.ParseNodeType.Concept:t=this.visitConceptDeclaration(e);break;case r.ParseNodeType.ConceptInput:t=this.visitConceptInput(e);break;case r.ParseNodeType.Const:t=this.visitConstDeclaration(e);break;case r.ParseNodeType.Curriculum:t=this.visitCurriculum(e);break;case r.ParseNodeType.Data:t=this.visitDataDeclaration(e);break;case r.ParseNodeType.DataSource:t=this.visitDataSource(e);break;case r.ParseNodeType.DotRange:t=this.visitDotRange(e);break;case r.ParseNodeType.Experiment:t=this.visitExperiment(e);break;case r.ParseNodeType.ExpressionError:t=this.visitExpressionError(e);break;case r.ParseNodeType.Import:t=this.visitImport(e);break;case r.ParseNodeType.False:t=this.visitNumericLiteral(e);break;case r.ParseNodeType.Function:t=this.visitFunctionDeclaration(e);break;case r.ParseNodeType.FunctionBlock:t=this.visitFunctionBlock(e);break;case r.ParseNodeType.FunctionCall:t=this.visitFunctionCall(e);break;case r.ParseNodeType.FunctionInput:t=this.visitFunctionInput(e);break;case r.ParseNodeType.FunctionReference:t=this.visitFunctionReference(e);break;case r.ParseNodeType.Graph:t=this.visitGraphDeclaration(e);break;case r.ParseNodeType.Goal:t=this.visitGoalDeclaration(e);break;case r.ParseNodeType.GoalAtom:t=this.visitGoalAtom(e);break;case r.ParseNodeType.Identifier:t=this.visitIdentifier(e);break;case r.ParseNodeType.If:t=this.visitIfElseStatement(e);break;case r.ParseNodeType.Inkling:t=this.visitInklingVersion(e);break;case r.ParseNodeType.Input:t=this.visitInput(e);break;case r.ParseNodeType.Lesson:t=this.visitLesson(e);break;case r.ParseNodeType.MemberAccess:t=this.visitMemberAccess(e);break;case r.ParseNodeType.Number:t=this.visitPrimitiveType(e);break;case r.ParseNodeType.NumericLiteral:t=this.visitNumericLiteral(e);break;case r.ParseNodeType.Output:t=this.visitOutput(e);break;case r.ParseNodeType.Package:t=this.visitPackage(e);break;case r.ParseNodeType.Dataset:t=this.visitDataset(e);break;case r.ParseNodeType.ParenthesizedExpression:t=this.visitParenthesizedExpression(e);break;case r.ParseNodeType.Program:t=this.visitProgram(e);break;case r.ParseNodeType.Return:t=this.visitReturnStatement(e);break;case r.ParseNodeType.Scenario:t=this.visitScenario(e);break;case r.ParseNodeType.Select:t=this.visitSelect(e);break;case r.ParseNodeType.Simulator:t=this.visitSimulatorDeclaration(e);break;case r.ParseNodeType.SpecializedType:t=this.visitSpecializedType(e);break;case r.ParseNodeType.String:t=this.visitPrimitiveType(e);break;case r.ParseNodeType.StringLiteral:t=this.visitStringLiteral(e);break;case r.ParseNodeType.StructField:t=this.visitStructField(e);break;case r.ParseNodeType.StructLiteral:t=this.visitStructLiteral(e);break;case r.ParseNodeType.StructLiteralField:t=this.visitStructLiteralField(e);break;case r.ParseNodeType.StructType:t=this.visitStructType(e);break;case r.ParseNodeType.Training:t=this.visitTraining(e);break;case r.ParseNodeType.True:t=this.visitNumericLiteral(e);break;case r.ParseNodeType.Type:t=this.visitTypeDeclaration(e);break;case r.ParseNodeType.TypeArgument:t=this.visitTypeArgument(e);break;case r.ParseNodeType.TypeArgumentsList:t=this.visitTypeArgumentsList(e);break;case r.ParseNodeType.UnaryOperation:t=this.visitUnaryOperation(e);break;case r.ParseNodeType.Using:t=this.visitUsing(e);break;case r.ParseNodeType.Var:t=this.visitVarDeclaration(e);break;case r.ParseNodeType.VarAssignment:t=this.visitVariableAssignment(e)}return t?o.ParseNodeUtils.getChildNodes(e):[]},e.prototype.visitAlgorithm=function(e){return!0},e.prototype.visitArrayAccess=function(e){return!0},e.prototype.visitArrayLiteral=function(e){return!0},e.prototype.visitArrayType=function(e){return!0},e.prototype.visitBinaryOperation=function(e){return!0},e.prototype.visitComment=function(e){return!0},e.prototype.visitConceptDeclaration=function(e){return!0},e.prototype.visitConceptInput=function(e){return!0},e.prototype.visitConstDeclaration=function(e){return!0},e.prototype.visitCurriculum=function(e){return!0},e.prototype.visitDataDeclaration=function(e){return!0},e.prototype.visitDataSource=function(e){return!0},e.prototype.visitDotRange=function(e){return!0},e.prototype.visitExperiment=function(e){return!0},e.prototype.visitExpressionError=function(e){return!0},e.prototype.visitFunctionDeclaration=function(e){return!0},e.prototype.visitFunctionBlock=function(e){return!0},e.prototype.visitFunctionCall=function(e){return!0},e.prototype.visitFunctionInput=function(e){return!0},e.prototype.visitFunctionReference=function(e){return!0},e.prototype.visitGraphDeclaration=function(e){return!0},e.prototype.visitGoalDeclaration=function(e){return!0},e.prototype.visitGoalAtom=function(e){return!0},e.prototype.visitIdentifier=function(e){return!0},e.prototype.visitIfElseStatement=function(e){return!0},e.prototype.visitImport=function(e){return!0},e.prototype.visitInklingVersion=function(e){return!0},e.prototype.visitInput=function(e){return!0},e.prototype.visitLesson=function(e){return!0},e.prototype.visitMemberAccess=function(e){return!0},e.prototype.visitNumericLiteral=function(e){return!0},e.prototype.visitOutput=function(e){return!0},e.prototype.visitPackage=function(e){return!0},e.prototype.visitDataset=function(e){return!0},e.prototype.visitParenthesizedExpression=function(e){return!0},e.prototype.visitPrimitiveType=function(e){return!0},e.prototype.visitProgram=function(e){return!0},e.prototype.visitReturnStatement=function(e){return!0},e.prototype.visitScenario=function(e){return!0},e.prototype.visitSelect=function(e){return!0},e.prototype.visitSimulatorDeclaration=function(e){return!0},e.prototype.visitSpecializedType=function(e){return!0},e.prototype.visitStringLiteral=function(e){return!0},e.prototype.visitStructField=function(e){return!0},e.prototype.visitStructLiteral=function(e){return!0},e.prototype.visitStructLiteralField=function(e){return!0},e.prototype.visitStructType=function(e){return!0},e.prototype.visitTraining=function(e){return!0},e.prototype.visitTypeDeclaration=function(e){return!0},e.prototype.visitTypeArgument=function(e){return!0},e.prototype.visitTypeArgumentsList=function(e){return!0},e.prototype.visitUnaryOperation=function(e){return!0},e.prototype.visitUsing=function(e){return!0},e.prototype.visitVarDeclaration=function(e){return!0},e.prototype.visitVariableAssignment=function(e){return!0},e}();t.ParseTreeWalker=i},785:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.CurrentInklingVersion=void 0;var r,o,i=n(4471),a=n(222),s=n(6155),c=n(4847),u=n(9554),l=n(4393);t.CurrentInklingVersion={major:2,minor:0},function(e){e[e.Expression=0]="Expression",e[e.LogicalOr=1]="LogicalOr",e[e.LogicalAnd=2]="LogicalAnd",e[e.Equality=3]="Equality",e[e.Relational=4]="Relational",e[e.AddSub=5]="AddSub",e[e.MultDivMod=6]="MultDivMod",e[e.Exponent=7]="Exponent",e[e.Unary=8]="Unary"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.DisallowRelationalOperators=1]="DisallowRelationalOperators"}(o||(o={}));var p=new i.TextRange(new i.TextPosition(0,0),new i.TextPosition(0,0)),d=function(){function e(e,n,r,o){this._placeholderName={type:s.ParseNodeType.Identifier,range:p,text:""},this._inklingMinorVersion=t.CurrentInklingVersion.minor,this._text=e;var i=new u.Tokenizer;this._tokenizerResults=i.tokenize(this._text,o,this._inklingMinorVersion),this._tokenProvider=new u.TokenProvider(this._tokenizerResults.tokens),this._diagnostics=n,this._compilerOptions=r||new a.CompilerOptions}return e.prototype.parse=function(){for(var e=this,n={type:s.ParseNodeType.Program,range:p,statements:[]},r=!1,o=!1,a=!1,u=!1,d=!1,m=function(t){o||a||(e._addError("Program must start with inkling statement",t.range),a=!0)};;){var y=this._getNextToken();if(y.token===l.Token.EndOfInput){m(y);break}if(y.token===l.Token.Invalid&&(m(y),this._addError("Invalid token",y.range)),y.token===l.Token.Inkling){var g=this._parseInklingStatement(y);o=!0,n.statements.length>0&&this._addError("Inkling statement must be before any other statements",y.range),n.inklingVersion?this._addError("Only one inkling statement is allowed in the program",y.range):(n.inklingVersion=g,this._extendRangeToChild(n,g),g.version.major>t.CurrentInklingVersion.major?(this._addError("Inkling major version is newer than expected",g.range,i.DiagnosticType.Warning),this._inklingMinorVersion=t.CurrentInklingVersion.minor):g.version.major===t.CurrentInklingVersion.major&&(g.version.minor>t.CurrentInklingVersion.minor?this._addError("Inkling minor version is newer than expected",g.range,i.DiagnosticType.Warning):this._inklingMinorVersion=g.version.minor))}else if(m(y),y.token===l.Token.Experiment){var h=this._parseExperimentStatement(y);u?this._addError("Only one experiment statement is allowed at the top level of the program",y.range):u=!0,n.statements.push(h),this._extendRangeToChild(n,h)}else if(y.token===l.Token.Graph){var f=this._parseGraphStatement(y);d?this._addError("Only one graph statement is allowed",y.range):d=!0,n.statements.push(f),this._extendRangeToChild(n,f)}else{var T=this._parseTopLevelStatement(y);T&&(r||n.inklingVersion||(this._addError("Program must start with inkling statement",y.range),r=!0),n.statements.push(T),this._extendRangeToChild(n,T))}}return n.endComment=this._parseEndComment(),c.ParseNodeUtils.addParentLinks(n),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:n,characterCount:this._text.length}},e.prototype.parseValueExpression=function(){var e=this._parseExpression(),t=this._getNextToken();return t.token!==l.Token.EndOfInput&&this._addError("Invalid syntax for expression",t.range),c.ParseNodeUtils.addParentLinks(e),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:e,characterCount:this._text.length}},e.prototype.parseTypeExpression=function(){var e=this._parseTypeExpression(),t=this._getNextToken();return t.token!==l.Token.EndOfInput&&this._addError("Invalid syntax for type expression",t.range),c.ParseNodeUtils.addParentLinks(e),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:e,characterCount:this._text.length}},e.prototype.parseFunctionDeclaration=function(e){var t,n=this._getNextToken();return n.token!==l.Token.Function?(this._addError("Expected 'function'",n.range),t=this._placeholderName):(t=this._parseFunctionDeclaration(n,e),(n=this._getNextToken()).token!==l.Token.EndOfInput&&this._addError("Invalid syntax for function declaration",n.range),c.ParseNodeUtils.addParentLinks(t)),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:t,characterCount:this._text.length}},e.prototype.parseGoalDeclaration=function(){var e,t=this._getNextToken();return t.token!==l.Token.Goal?(this._addError("Expected 'goal'",t.range),e=this._placeholderName):(e=this._parseGoalDeclaration(t),(t=this._getNextToken()).token!==l.Token.EndOfInput&&this._addError("Invalid syntax for goal declaration",t.range),c.ParseNodeUtils.addParentLinks(e)),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:e,characterCount:this._text.length}},e.prototype.parseTypeDefinition=function(){var e,t=this._getNextToken();return t.token!==l.Token.Type?(this._addError("Expected 'type'",t.range),e=this._placeholderName):(e=this._parseTypeDeclaration(t),(t=this._getNextToken()).token!==l.Token.EndOfInput&&this._addError("Invalid syntax for type declaration",t.range),c.ParseNodeUtils.addParentLinks(e)),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:e,characterCount:this._text.length}},e.prototype.parseConstDeclaration=function(){var e,t=this._getNextToken();return t.token!==l.Token.Const?(this._addError("Expected 'const'",t.range),e=this._placeholderName):(e=this._parseConstDeclaration(t),(t=this._getNextToken()).token!==l.Token.EndOfInput&&this._addError("Invalid syntax for const declaration",t.range),c.ParseNodeUtils.addParentLinks(e)),{lineStartPositions:this._tokenizerResults.lineStartPositions,tokens:this._tokenizerResults.tokens,parseTree:e,characterCount:this._text.length}},e.prototype._parseInklingStatement=function(e){var n={type:s.ParseNodeType.Inkling,range:e.range,comments:this._getAccumulatedComments(),version:t.CurrentInklingVersion,versionString:this._makeStringLiteralNode(void 0)},r=this._getNextToken();if(r.token===l.Token.StringLiteral){n.versionString=this._makeStringLiteralNode(r),this._extendRangeToChild(n,n.versionString);var o=this._parseVersionString(n.versionString.value);o?n.version=o:this._addError('Version string must take the form "2.x" where x is minor version number',r.range)}else this._addError("Expected inkling version string",r.range);return this._addEndOfLineComment(n.range.end.line,n.comments),n},e.prototype._parseTopLevelStatement=function(e){switch(e.token){case l.Token.Using:return this._parseUsingStatement(e);case l.Token.Const:return this._parseConstDeclaration(e);case l.Token.Type:return this._parseTypeDeclaration(e);case l.Token.Concept:return this._parseConceptDeclaration(e);case l.Token.Simulator:case l.Token.Data:return this._parseSourceDeclaration(e,!1);case l.Token.Function:return this._parseFunctionDeclaration(e,!1);default:return this._addError("Expected statement but found unrecognized token '"+e.text+"'",e.range),void this._swallowTokensUntilEndOfBlock(void 0,!0)}},e.prototype._parseConceptDeclaration=function(e){var t=this,n={type:s.ParseNodeType.Concept,name:this._placeholderName,conceptToken:e,comments:this._getAccumulatedComments(),range:e.range,inputs:[],outputType:{type:s.ParseNodeType.Number,range:p},selects:[]},r=this._peekNextToken(),o=this._parseIdentifier();return o?(n.name=o,this._extendRangeToChild(n,o)):this._addError("Expected concept name",r.range),this._parseWithinParentheses((function(){var e=t._parseConceptInputList(),r=e.params,o=e.hangingComma;n.inputs=r,n.hangingComma=o}),!0)?((r=this._getNextToken()).token===l.Token.Colon?n.outputType=this._parseTypeExpression():(this._addError("Output type expected",r.range),this._rejectToken(r)),this._addEndOfLineComment(n.range.end.line,n.comments),this._parseWithinBraces(n,(function(){for(;;){if((r=t._getNextToken()).token===l.Token.CloseBrace){t._rejectToken(r),t._extendRangeToToken(n,r);break}if(r.token===l.Token.Curriculum){var e=t._parseCurriculum(r);n.curriculum?t._addError("Only one curriculum is allowed within a concept",r.range):n.programmedFunction?t._addError("Concept can have either a curriculum or programmed function but not both",r.range):n.importedModel?t._addError("Concept can have either an imported model or programmed function but not both",r.range):n.curriculum=e,t._extendRangeToChild(n,e)}else if(r.token===l.Token.Programmed){var o=t._parseFunctionRef();n.programmedFunction?t._addError("Only one programmed function is allowed within a concept",r.range):n.curriculum?t._addError("Concept can have either a curriculum or programmed function but not both",r.range):n.importedModel?t._addError("Concept can have either an imported model or programmed function but not both",r.range):n.programmedFunction=o,t._extendRangeToChild(n,o)}else if(r.token===l.Token.Import){var i=t._parseImport(r);n.importedModel?t._addError("Only one import statement is allowed within a concept",r.range):n.programmedFunction?t._addError("Concept can have either an imported model or a programmed function but not both",r.range):n.curriculum?t._addError("Concept can have either an imported model or programmed function but not both",r.range):n.importedModel=i,t._extendRangeToChild(n,i)}else if(r.token===l.Token.Select){var a=t._parseSelectStatement(r);a&&n.selects.push(a)}else if(r.token===l.Token.Experiment){var s=t._parseExperimentStatement(r);n.experiment?t._addError("Only one experiment statement is allowed per concept",r.range):(n.experiment=s,t._extendRangeToChild(n,n.experiment))}else if(t._extendRangeToToken(n,r),t._addError("Concept statement expected, instead found '"+r.text+"'",r.range),t._swallowTokensUntilEndOfBlock(n,!1))break}})),n.selects.length>0&&!n.curriculum&&this._addError("Select statement can be used only if a curriculum statement is present",n.selects[0].targetConcept.range),n.endComment=this._parseEndComment(),n):n},e.prototype._parseSelectStatement=function(e){var t=this._peekNextToken(),n=this._parseIdentifier();if(n){var r={type:s.ParseNodeType.Select,comments:this._getAccumulatedComments(),range:e.range,targetConcept:n};if(this._extendRangeToChild(r,n),this._addEndOfLineComment(r.range.start.line,r.comments),(t=this._getNextToken()).token!==l.Token.OpenBrace)this._rejectToken(t);else{for(;;){if((t=this._getNextToken()).token===l.Token.CloseBrace){this._extendRangeToToken(r,t),this._rejectToken(t);break}if(t.token!==l.Token.Mask){this._rejectToken(t);break}var o=this._parseFunctionRef();this._extendRangeToChild(r,o),r.maskFunction?this._addError("Only one mask function is allowed in a select statement",t.range):r.maskFunction=o}(t=this._getNextToken()).token!==l.Token.CloseBrace?(this._rejectToken(t),this._addError("Expected '}'",t.range)):this._extendRangeToToken(r,t),r.endComment=this._parseEndComment()}return r}this._addError("Expected concept name after 'select'",t.range)},e.prototype._parseConceptInputList=function(){var e=this,t=[],n=this._parseCommaSeparatedList(l.Token.CloseParenthesis,(function(){var n=e._parseConceptInput();return!!n&&(t.push(n),!0)}));return{params:t,hangingComma:n}},e.prototype._parseConceptInput=function(){var e,t=this._parseIdentifier([l.Token.Input]),n=this._peekNextToken();if(!(e=t)){var r=this._parseIdentifier([l.Token.Input]);if(r)e=r;else{var o=this._getNextToken();if(o.token!==l.Token.Input)return void this._addError("Concept parameters must be 'input' or another concept",o.range);e={type:s.ParseNodeType.Input,range:o.range}}}var i={type:s.ParseNodeType.ConceptInput,range:n.range,inputSource:e};return this._extendRangeToChild(i,i.inputSource),i},e.prototype._parseImport=function(e){var t={type:s.ParseNodeType.Import,range:e.range,comments:this._getAccumulatedComments(),expression:this._parseExpression()};return this._extendRangeToChild(t,t.expression),t},e.prototype._parseCurriculum=function(e){var t=this,n={type:s.ParseNodeType.Curriculum,range:e.range,curriculumToken:e,comments:this._getAccumulatedComments(),sources:[],lessons:[]};return this._addEndOfLineComment(n.range.start.line,n.comments),this._parseWithinBraces(n,(function(){for(;;){var e=t._getNextToken();if(e.token===l.Token.CloseBrace){t._rejectToken(e),t._extendRangeToToken(n,e);break}if(e.token===l.Token.Algorithm){var r=t._parseAlgorithm(e);n.algorithm?t._addError("Only one algorithm statement is allowed in a curriculum",e.range):(n.algorithm=r,t._extendRangeToChild(n,r))}else if(e.token===l.Token.Source){var o=t._parseDataSource(e);n.sources.push(o),t._extendRangeToChild(n,o)}else if(e.token===l.Token.Reward){var i=t._parseFunctionRef();n.reward?t._addError("Only one reward statement is allowed in a curriculum",e.range):(n.reward=i,t._extendRangeToChild(n,i)),n.goal&&t._addError("Reward cannot be used in conjunction with goal",e.range)}else if(e.token===l.Token.Terminal){var a=t._parseFunctionRef();n.terminal?t._addError("Only one terminal statement is allowed in a curriculum",e.range):(n.terminal=a,t._extendRangeToChild(n,a)),n.goal&&t._addError("Terminal cannot be used in conjunction with goal",e.range)}else if(e.token===l.Token.Goal){var s=t._parseGoalDeclaration(e);n.goal?t._addError("Only one goal statement is allowed in a curriculum",e.range):(n.goal=s,t._extendRangeToChild(n,s)),(n.terminal||n.reward)&&t._addError("Goal cannot be used in conjunction with reward or terminal",e.range)}else if(e.token===l.Token.State)a=t._parseFunctionRef(),n.state?t._addError("Only one state transform is allowed in a curriculum",e.range):(n.state=a,t._extendRangeToChild(n,a));else if(e.token===l.Token.Action)a=t._parseFunctionRef(),n.action?t._addError("Only one action transform is allowed in a curriculum",e.range):(n.action=a,t._extendRangeToChild(n,a));else if(e.token===l.Token.Lesson){var c=t._parseLesson(e);c&&(n.lessons.push(c),t._extendRangeToChild(n,c))}else if(e.token===l.Token.Experiment){var u=t._parseExperimentStatement(e);n.experiment?t._addError("Only one experiment statement is allowed in a curriculum",e.range):(n.experiment=u,t._extendRangeToChild(n,u))}else if(e.token===l.Token.Training){var p=t._parseTraining(e);n.training?t._addError("Only one training statement is allowed in a curriculum",e.range):(n.training=p,t._extendRangeToChild(n,p))}else if(t._extendRangeToToken(n,e),t._addError("Unexpected statement in curriculum",e.range),t._swallowTokensUntilEndOfBlock(n,!1))break}})),n.endComment=this._parseEndComment(),n},e.prototype._parseLesson=function(e){var t=this,n=this._parseIdentifier();n||this._addError("Expected name after lesson",e.range);var r={type:s.ParseNodeType.Lesson,range:e.range,comments:this._getAccumulatedComments(),name:n||this._placeholderName};return this._addEndOfLineComment(r.range.start.line,r.comments),r.name&&this._extendRangeToChild(r,r.name),this._parseWithinBraces(r,(function(){for(;;){var e=t._getNextToken();if(e.token===l.Token.CloseBrace){t._rejectToken(e),t._extendRangeToToken(r,e);break}if(e.token===l.Token.Constraint||e.token===l.Token.Scenario){e.token===l.Token.Constraint&&t._addError('The keyword "constraint" is deprecated; use "scenario" instead',e.range,i.DiagnosticType.Warning);var n=t._getAccumulatedComments(),o={type:s.ParseNodeType.Scenario,range:e.range,comments:n,scenarioType:t._parseTypeExpression()};t._extendRangeToChild(o,o.scenarioType),t._addEndOfLineComment(o.range.start.line,o.comments),r.scenario?t._addError("Only one scenario statement is allowed per lesson",e.range):r.scenario=o,t._extendRangeToChild(r,o)}else if(e.token===l.Token.Training){var a=t._parseTraining(e);r.training?t._addError("Only one training statement is allowed in a lesson",e.range):r.training=a,t._extendRangeToChild(r,a)}else if(e.token===l.Token.Experiment){var c=t._parseExperimentStatement(e);r.experiment?t._addError("Only one experiment statement is allowed per lesson",e.range):r.experiment=c}else if(t._extendRangeToToken(r,e),t._addError("Unexpected statement in lesson",e.range),t._swallowTokensUntilEndOfBlock(r,!1))break}})),r.endComment=this._parseEndComment(),r},e.prototype._parseGraphStatement=function(e){var t,n=this,r={type:s.ParseNodeType.Graph,comments:this._getAccumulatedComments(),range:e.range,graphToken:e,inputType:{type:s.ParseNodeType.Number,range:p},concepts:[]};return this._parseWithinParentheses((function(){(t=n._getNextToken()).token!==l.Token.Input&&n._addError("Expected 'input'",t.range),(t=n._getNextToken()).token!==l.Token.Colon&&n._addError("Expected ':'",t.range),r.inputType=n._parseTypeExpression()})),(t=this._getNextToken()).token!==l.Token.Colon?this._rejectToken(t):r.outputType=this._parseTypeExpression(),this._addEndOfLineComment(r.range.end.line,r.comments),this._parseWithinBraces(r,(function(){for(;;){if((t=n._getNextToken()).token===l.Token.CloseBrace){n._rejectToken(t),n._extendRangeToToken(r,t);break}if(t.token===l.Token.Concept){var e=n._parseConceptDeclaration(t);r.concepts.push(e),n._extendRangeToChild(r,e)}else if(t.token===l.Token.Output){var o=t,i=void 0;if((t=n._getNextToken()).token===l.Token.Input)i={type:s.ParseNodeType.Output,range:o.range,comments:n._getAccumulatedComments(),isConceptInlined:!1,outputSource:{type:s.ParseNodeType.Input,range:t.range}},n._extendRangeToChild(i,i.outputSource);else if(t.token===l.Token.Concept)(e=n._parseConceptDeclaration(t)).hasInlineOutput=!0,r.concepts.push(e),n._extendRangeToChild(r,e),i={type:s.ParseNodeType.Output,range:o.range,isConceptInlined:!0,comments:n._getAccumulatedComments(),outputSource:e.name},n._extendRangeToChild(i,i.outputSource);else{n._rejectToken(t);var a=n._parseIdentifier();a?(i={type:s.ParseNodeType.Output,range:o.range,isConceptInlined:!1,comments:n._getAccumulatedComments(),outputSource:a},n._extendRangeToChild(i,i.outputSource),n._addEndOfLineComment(i.range.end.line,i.comments)):n._addError("Expected 'input', concept declaration, or reference after 'output'",t.range)}i&&(r.output?n._addError("Only one output concept is permitted in each concept graph",i.range):r.output=i,n._extendRangeToChild(r,i))}else if(n._extendRangeToToken(r,t),n._addError("Expected statement in graph",t.range),n._swallowTokensUntilEndOfBlock(r,!1))break}})),r.endComment=this._parseEndComment(),r},e.prototype._parseExperimentStatement=function(e){var t={type:s.ParseNodeType.Experiment,range:e.range,comments:this._getAccumulatedComments(),expression:this._parseExpression()};return this._extendRangeToChild(t,t.expression),this._addEndOfLineComment(t.range.end.line,t.comments),this._compilerOptions.enableExperimentalStatements||this._addError("Experiment statements not enabled",e.range),t},e.prototype._parseAlgorithm=function(e){var t={type:s.ParseNodeType.Algorithm,range:e.range,comments:this._getAccumulatedComments(),expression:this._parseExpression()};return this._extendRangeToChild(t,t.expression),t},e.prototype._parseTraining=function(e){var t={type:s.ParseNodeType.Training,range:e.range,comments:this._getAccumulatedComments(),expression:this._parseExpression()};return this._extendRangeToChild(t,t.expression),t},e.prototype._parseGoalDeclaration=function(e){var t=this,n={type:s.ParseNodeType.Goal,comments:this._getAccumulatedComments(),goalToken:e,hangingComma:!1,inputs:[],range:e.range,subgoals:[]};return this._addEndOfLineComment(n.range.start.line,n.comments),this._parseWithinParentheses((function(){var e=t._parseFunctionInputList(),r=e.params,o=e.hangingComma;n.inputs=r,n.hangingComma=o,r.length>0&&t._extendRangeToChild(n,r[r.length-1])}),!0),this._parseWithinBraces(n,(function(){for(;;){var e=t._getNextToken();if(e.token===l.Token.CloseBrace){t._rejectToken(e),t._extendRangeToToken(n,e);break}if(u.Tokenizer.isGoalOperator(e.token)){var r=t._parseGoalAtom(e);n.subgoals.push(r),t._extendRangeToChild(n,r)}else if(t._addError("Goal statement expected, instead found '"+e.text+"'",e.range),t._swallowTokensUntilEndOfBlock(n,!1))break}})),0===n.subgoals.length&&this._addError("Goal declaration must include at least one goal statement",n.range),n.endComment=this._parseEndComment(),n},e.prototype._parseGoalAtom=function(e){var t=this._getAccumulatedComments(),n=this._parseIdentifier();n||(this._addError("Expected subgoal name after '"+e.text+"'",e.range),n=this._placeholderName);var r=this._getNextToken();r.token!==l.Token.Colon&&(this._addError("Expected ':' after subgoal name",r.range),this._rejectToken(r));var o=this._parseExpression(),i={comments:t,name:n,range:e.range,type:s.ParseNodeType.GoalAtom,operation:e.token,valueExpression:o};if(this._extendRangeToChild(i,n),this._extendRangeToChild(i,o),this._addEndOfLineComment(i.range.end.line,i.comments),(r=this._getNextToken()).token!==l.Token.In)this._rejectToken(r),this._addError("Goal target region required; expecting 'in' after value expression",o.range);else{var a=this._parseExpression();if(i.targetExpression=a,this._extendRangeToChild(i,a),(r=this._getNextToken()).token===l.Token.Within){var c=this._parseExpression();i.operation!==l.Token.Drive?this._addError("Goal is not compatible with 'within' clause",r.range):i.withinExpression=c,this._extendRangeToChild(i,c)}else this._rejectToken(r)}return i},e.prototype._parseSourceDeclaration=function(e,t){var n=this,r=e.token===l.Token.Simulator,o=r?l.Token.Package:l.Token.Dataset,i={type:r?s.ParseNodeType.Simulator:s.ParseNodeType.Data,name:this._placeholderName,comments:this._getAccumulatedComments(),range:e.range,actionParam:{type:s.ParseNodeType.FunctionInput,range:p,name:this._placeholderName,paramType:{type:s.ParseNodeType.Number,range:p}},stateType:{type:s.ParseNodeType.Number,range:p}};this._addEndOfLineComment(i.range.start.line,i.comments);var a=this._peekNextToken(),c=this._parseIdentifier();c?i.name=c:t||this._addError("Expected identifier",a.range);var u=[];return this._parseWithinParentheses((function(){var e=n._parseFunctionInputList(),t=e.params,r=e.hangingComma;i.hangingComma=r,u=t}),!0)?(u.length>=1?i.actionParam=u[0]:this._addError("Missing action parameter",c?c.range:e.range),u.length>=2&&(i.configParam=u[1]),u.length>=3&&this._addError("Unexpected parameter",u[2].name.range),u.length>0&&this._extendRangeToChild(i,u[u.length-1]),(a=this._getNextToken()).token!==l.Token.Colon?(this._addError("Expected ':' followed by state type",a.range),this._rejectToken(a),i):(i.stateType=this._parseTypeExpression(),this._parseWithinBraces(i,(function(){for(;;){if((a=n._getNextToken()).token===l.Token.CloseBrace){n._rejectToken(a),n._extendRangeToToken(i,a);break}if(a.token===o){var e=n._getAccumulatedComments(),t=n._parseExpression();i.objectReference?r?n._addError("Only one package statement is allowed in a simulator declaration",a.range):n._addError("Only one dataset statement is allowed in a data declaration",a.range):(i.objectReference={type:s.ParseNodeType.Package,range:a.range,comments:e,expression:t},n._extendRangeToChild(i.objectReference,i.objectReference.expression),n._extendRangeToChild(i,i.objectReference),n._addEndOfLineComment(i.objectReference.range.start.line,i.objectReference.comments))}else if(n._extendRangeToToken(i,a),n._addError("Statement expected, instead found '"+a.text+"'",a.range),n._swallowTokensUntilEndOfBlock(i,!1))break}})),r||i.objectReference||this._addError("Data declaration is missing a dataset statement",i.name.range),i.endComment=this._parseEndComment(),i)):i},e.prototype._parseFunctionInput=function(){var e=this._parseIdentifier(),t=this._peekNextToken();e||this._addError("Expected parameter name",t.range),(t=this._getNextToken()).token!==l.Token.Colon&&(this._addError("Expected ':'",t.range),this._rejectToken(t));var n={type:s.ParseNodeType.FunctionInput,range:t.range,name:e||this._placeholderName,paramType:this._parseTypeExpression()};return this._extendRangeToChild(n,n.paramType),this._extendRangeToChild(n,n.name),n},e.prototype._parseFunctionInputList=function(){var e=this,t=[],n=this._parseCommaSeparatedList(l.Token.CloseParenthesis,(function(){var n=e._parseFunctionInput();return!!n&&(t.push(n),!0)}));return{params:t,hangingComma:n}},e.prototype._parseFunctionDeclaration=function(e,t){var n=this,r=[];t||(r=this._getAccumulatedComments());var o={type:s.ParseNodeType.FunctionBlock,range:e.range,statements:[]},i={type:s.ParseNodeType.Function,range:e.range,comments:r,functionToken:e,name:this._placeholderName,inputs:[],block:o};this._addEndOfLineComment(i.range.start.line,i.comments);var a=this._peekNextToken(),c=this._parseIdentifier();return c?(i.name=c,this._extendRangeToChild(i,c)):t||this._addError("Expected function name",a.range),this._parseWithinParentheses((function(){var e=n._parseFunctionInputList(),t=e.params,r=e.hangingComma;i.inputs=t,i.hangingComma=r,t.length>0&&n._extendRangeToChild(i,t[t.length-1])}),!0)?((a=this._getNextToken()).token===l.Token.Colon?(i.outputType=this._parseTypeExpression(),this._extendRangeToChild(i,i.outputType)):this._rejectToken(a),o.range=a.range,this._parseWithinBraces(i,(function(){o.statements=n._parseFunctionBody(o)})),o.endComment=this._parseEndComment(),this._extendRangeToChild(i,o),i):i},e.prototype._parseFunctionBody=function(e){for(var t=[];;){var n=this._getNextToken();if(n.token===l.Token.CloseBrace){this._rejectToken(n),this._extendRangeToToken(e,n);break}if(n.token===l.Token.Var){var r=this._parseVarDeclaration(n);this._extendRangeToChild(e,r),t.push(r)}else if(n.token===l.Token.If)r=this._parseIfStatement(n),this._extendRangeToChild(e,r),t.push(r);else if(n.token===l.Token.Return)r=this._parseReturnStatement(n),this._extendRangeToChild(e,r),t.push(r);else{this._rejectToken(n);var o=this._parseAtomExpression();if(o){if(o.type===s.ParseNodeType.Identifier)r=this._parseVarAssignment(o),this._extendRangeToChild(e,r),t.push(r);else if(this._peekNextToken().token===l.Token.Assignment?o.type===s.ParseNodeType.ArrayAccess?this._addError("Arrays are immutable, so values cannot be assigned to elements",o.range):o.type===s.ParseNodeType.MemberAccess?this._addError("Structures are immutable, so values cannot be assigned to fields",o.range):this._addError("Left-hand side of assignment must be a variable name",o.range):this._addError("Expected statement but found expression",o.range),this._swallowTokensUntilEndOfBlock(e,!1))break}else if(this._addError("Expected statement or '}' but found '"+n.text+"'",n.range),this._swallowTokensUntilEndOfBlock(e,!1))break}}return t},e.prototype._parseIfStatement=function(e){var t=this,n={type:s.ParseNodeType.FunctionBlock,range:e.range,statements:[]},r={type:s.ParseNodeType.If,range:e.range,comments:this._getAccumulatedComments(),condition:this._parseExpression(),ifBlock:n};this._extendRangeToChild(r,r.condition),this._addEndOfLineComment(r.range.start.line,r.comments),n.range=this._peekNextToken().range,this._parseWithinBraces(r,(function(){n.statements=t._parseFunctionBody(n)})),n.endComment=this._parseEndComment(),this._extendRangeToChild(r,n);var o=this._getNextToken();if(o.token!==l.Token.Else)this._rejectToken(o);else if((o=this._getNextToken()).token===l.Token.If)r.elseIfStatement=this._parseIfStatement(o),this._extendRangeToChild(r,r.elseIfStatement);else{var i={type:s.ParseNodeType.FunctionBlock,range:o.range,statements:[]};this._rejectToken(o),this._parseWithinBraces(r,(function(){i.statements=t._parseFunctionBody(i)})),i.endComment=this._parseEndComment(),r.elseBlock=i,this._extendRangeToChild(r,i)}return r},e.prototype._parseReturnStatement=function(e){var t={type:s.ParseNodeType.Return,range:e.range,comments:this._getAccumulatedComments(),value:this._parseExpression()};return this._extendRangeToChild(t,t.value),this._addEndOfLineComment(t.range.end.line,t.comments),t},e.prototype._parseVarAssignment=function(e){var t,n=this._getAccumulatedComments(),r=this._getNextToken();r.token!==l.Token.Assignment?(this._addError("Expected '='",r.range),this._rejectToken(r),t=this._makeNumericLiteralNode(void 0)):t=this._parseExpression();var o={type:s.ParseNodeType.VarAssignment,range:e.range,comments:n,name:e,value:t};return this._extendRangeToChild(o,o.value),this._extendRangeToChild(o,o.name),this._addEndOfLineComment(o.range.end.line,o.comments),o},e.prototype._parseFunctionRef=function(){var e,t=this._getAccumulatedComments(),n=this._getNextToken();if(n.token===l.Token.Function)e=this._parseFunctionDeclaration(n,!0);else{this._rejectToken(n);var r=this._parseIdentifier();r?e=r:(this._addError("Expected function reference or declaration",n.range),e=this._placeholderName)}var o={type:s.ParseNodeType.FunctionReference,range:n.range,comments:t,functionRef:e};return this._extendRangeToChild(o,o.functionRef),this._addEndOfLineComment(o.range.end.line,o.comments),o},e.prototype._parseDataSource=function(e){var t,n=this._getAccumulatedComments(),r=this._getNextToken();if(r.token===l.Token.Simulator||r.token===l.Token.Data)t=this._parseSourceDeclaration(r,!0);else{this._rejectToken(r);var o=this._parseIdentifier();o?t=o:(this._addError("Expected a reference or declaration of a simulator or data source after 'source'",r.range),t=this._placeholderName)}var i={type:s.ParseNodeType.DataSource,range:e.range,comments:n,dataSource:t};return this._extendRangeToChild(i,i.dataSource),this._addEndOfLineComment(i.range.start.line,i.comments),i},e.prototype._isTypePrimitiveOrSymbol=function(e){if(u.Tokenizer.isPrimitiveType(e.token))return!0;if(e.token===l.Token.Identifier){var t=this._getNextToken();if(this._rejectToken(t),t.token===l.Token.Comma||t.token===l.Token.Dot||t.token===l.Token.LessThan||t.token===l.Token.OpenBracket)return!0}return!1},e.prototype._parseTypeExpression=function(){var e,t=this._getNextToken();if(t.token===l.Token.OpenBrace)e=this._parseStructType(t);else{if(!this._isTypePrimitiveOrSymbol(t))return this._rejectToken(t),this._parseExpression(o.DisallowRelationalOperators);this._rejectToken(t),e=this._parseSpecializableType()}if(!e)return{type:s.ParseNodeType.Number,range:p};for(;;){if((t=this._getNextToken()).token!==l.Token.OpenBracket){this._rejectToken(t);break}var n=this._parseExpression();(t=this._getNextToken()).token!==l.Token.CloseBracket&&(this._rejectToken(t),this._addError("Expected ']'",t.range));var r={type:s.ParseNodeType.ArrayType,range:t.range,baseType:e,length:n};this._extendRangeToChild(r,e),this._extendRangeToChild(r,n),e=r}return e},e.prototype._parseStructType=function(e){var t=this,n={comments:this._getAccumulatedComments(),type:s.ParseNodeType.StructType,range:e.range,fields:[]};this._addEndOfLineComment(n.range.start.line,n.comments),n.hangingComma=this._parseCommaSeparatedList(l.Token.CloseBrace,(function(){var e=t._peekNextToken(),r=t._getAccumulatedComments(),o=t._parseIdentifier();if(!o)return t._addError("Expected field name identifier",e.range),!1;var i=t._getNextToken();if(i.token!==l.Token.Colon)return t._addError("Expected ':' following field name identifier",i.range),t._rejectToken(i),!1;var a={type:s.ParseNodeType.StructField,range:e.range,comments:r,name:o,fieldType:t._parseTypeExpression()};return t._extendRangeToChild(a,a.fieldType),n.fields.push(a),t._extendRangeToChild(n,a),t._addEndOfLineComment(a.range.end.line,a.comments),!0}));var r=this._getNextToken();return r.token!==l.Token.CloseBrace?(this._extendRangeToToken(n,r),this._addError("Expected '}' following struct type definition",r.range),this._rejectToken(r),this._swallowTokensUntilEndOfBlock(n,!0)):this._extendRangeToToken(n,r),n.endComment=this._parseEndComment(),n},e.prototype._parseSpecializableType=function(){var e,t=this._getNextToken();if(t.token===l.Token.Number||t.token===l.Token.String?e={type:t.token===l.Token.String?s.ParseNodeType.String:s.ParseNodeType.Number,range:t.range}:(this._rejectToken(t),e=this._parseIdentifierWithNamespace()),!e)return this._addError("Expected type",t.range),e;for(;;){if((t=this._getNextToken()).token!==l.Token.LessThan){this._rejectToken(t);break}var n=this._parseTypeSpecialization(t);e={type:s.ParseNodeType.SpecializedType,range:e.range,baseType:e,specialization:n},this._extendRangeToChild(e,e.baseType),this._extendRangeToChild(e,e.specialization)}return e},e.prototype._parseTypeSpecialization=function(e){var t=this,n=this._parseExpression(o.DisallowRelationalOperators),r=this._getNextToken();if(r.token===l.Token.DotDot){var i=this._parseExpression(o.DisallowRelationalOperators),a={type:s.ParseNodeType.DotRange,range:r.range,start:n,stop:i};return this._extendRangeToChild(a,a.stop),this._extendRangeToChild(a,a.start),(r=this._getNextToken()).token===l.Token.GreaterThan?this._rejectToken(r):r.token===l.Token.Step?(a.step=this._parseExpression(o.DisallowRelationalOperators),this._extendRangeToChild(a,a.step)):this._rejectToken(r),(r=this._getNextToken()).token!==l.Token.GreaterThan&&(this._addError("Expected '>' after type specialization",r.range),this._rejectToken(r)),this._extendRangeToToken(a,r),a}var c={type:s.ParseNodeType.TypeArgumentsList,range:e.range,typeArguments:[]},u={type:s.ParseNodeType.TypeArgument,range:n.range,argumentType:n};return n.type===s.ParseNodeType.Identifier&&r.token===l.Token.Assignment?(u.argumentName=n,u.argumentType=this._parseTypeExpression()):this._rejectToken(r),this._extendRangeToChild(u,u.argumentType),u.argumentName&&this._extendRangeToChild(u,u.argumentName),c.typeArguments.push(u),c.hangingComma=this._parseCommaSeparatedList(l.Token.GreaterThan,(function(){var e,n=t._parseTypeExpression();r=t._getNextToken(),n.type===s.ParseNodeType.Identifier&&r.token===l.Token.Assignment?(e=n,n=t._parseTypeExpression()):t._rejectToken(r);var o={type:s.ParseNodeType.TypeArgument,range:n.range,argumentName:e,argumentType:n};return t._extendRangeToChild(o,n),e&&t._extendRangeToChild(o,e),c.typeArguments.push(o),!0}),!0),c.typeArguments.length>0&&this._extendRangeToChild(c,c.typeArguments[c.typeArguments.length-1]),(r=this._getNextToken()).token!==l.Token.GreaterThan&&(this._addError("Expected '>' after type specialization",r.range),this._rejectToken(r)),this._extendRangeToToken(c,r),c},e.prototype._parseIdentifierWithNamespace=function(){var e=this._parseIdentifier();if(e){var t=this._getNextToken();if(t.token!==l.Token.Dot)return this._rejectToken(t),e;var n=this._parseIdentifier();n||(this._addError("Expected identifier after namespace",t.range),n={type:s.ParseNodeType.Identifier,range:t.range,text:""});var r={type:s.ParseNodeType.MemberAccess,range:t.range,leftExpression:e,identifier:n};return this._extendRangeToChild(r,r.identifier),this._extendRangeToChild(r,r.leftExpression),r}},e.prototype._parseUsingStatement=function(e){var t=this._getAccumulatedComments(),n=this._parseIdentifier();n||this._addError("Expected namespace identifier after 'using'",e.range);var r={type:s.ParseNodeType.Using,comments:t,name:n||this._placeholderName,range:e.range};return this._extendRangeToChild(r,r.name),this._addEndOfLineComment(r.range.end.line,r.comments),r},e.prototype._parseConstDeclaration=function(e){var t,n=this._getAccumulatedComments(),r=this._parseIdentifier();r||this._addError("Expected name after 'const'",e.range);var o,i=this._getNextToken();i.token===l.Token.Colon&&(t=this._parseTypeExpression(),i=this._getNextToken()),i.token!==l.Token.Assignment?(this._addError("Expected '='",i.range),this._rejectToken(i),o=this._makeNumericLiteralNode(void 0)):o=this._parseExpression();var a={type:s.ParseNodeType.Const,range:e.range,name:r||this._placeholderName,comments:n,constantType:t,value:o};return this._extendRangeToChild(a,a.name),a.constantType&&this._extendRangeToChild(a,a.constantType),this._extendRangeToChild(a,o),this._addEndOfLineComment(a.range.end.line,a.comments),a},e.prototype._parseVarDeclaration=function(e){var t,n,r=this._getAccumulatedComments(),o=this._parseIdentifier();o||this._addError("Expected name after 'var'",e.range);var i=this._getNextToken();i.token===l.Token.Colon&&(t=this._parseTypeExpression(),i=this._getNextToken()),i.token!==l.Token.Assignment?this._rejectToken(i):n=this._parseExpression();var a={type:s.ParseNodeType.Var,range:e.range,name:o||this._placeholderName,comments:r,varType:t,value:n};return this._extendRangeToChild(a,a.name),a.varType&&this._extendRangeToChild(a,a.varType),a.varType&&this._extendRangeToChild(a,a.varType),a.value&&this._extendRangeToChild(a,a.value),this._addEndOfLineComment(a.range.end.line,a.comments),a},e.prototype._parseTypeDeclaration=function(e){var t=this._parseIdentifier();t||this._addError("Expected name after 'type'",e.range);var n=this._getAccumulatedComments(),r={type:s.ParseNodeType.Type,range:e.range,name:t||this._placeholderName,comments:n,declaredType:this._parseTypeExpression()};return this._extendRangeToChild(r,r.name),this._extendRangeToChild(r,r.declaredType),this._addEndOfLineComment(r.range.end.line,r.comments),r},e.prototype._parseAtom=function(){var e=this._getNextToken();if(u.Tokenizer.isNumericLikeLiteral(e.token))return this._makeNumericLiteralNode(e);if(e.token===l.Token.StringLiteral)return this._makeStringLiteralNode(e);if(e.token===l.Token.OpenParenthesis){var t={type:s.ParseNodeType.ParenthesizedExpression,range:e.range,expression:this._parseExpression()};return(e=this._getNextToken()).token!==l.Token.CloseParenthesis?this._addError("Expected ')'",e.range):this._extendRangeToToken(t,e),t}return e.token===l.Token.OpenBracket?this._parseArrayLiteral(e):e.token===l.Token.OpenBrace?this._parseStructLiteral(e):(this._rejectToken(e),this._parseIdentifier([l.Token.Not])||void 0)},e.prototype._isValidFunctionExpression=function(e){switch(e.type){case s.ParseNodeType.FunctionCall:case s.ParseNodeType.Identifier:case s.ParseNodeType.MemberAccess:case s.ParseNodeType.ArrayAccess:case s.ParseNodeType.ExpressionError:return!0}return!1},e.prototype._parseAtomExpression=function(){var e=this._parseAtom();if(!e)return e;for(;;){var t=this._getNextToken();if(t.token===l.Token.OpenParenthesis&&this._isValidFunctionExpression(e)){var n=this._parseFunctionCallArguments(),r=n.args,o=n.hangingComma;e={type:s.ParseNodeType.FunctionCall,range:t.range,callExpression:e,arguments:r,hangingComma:o},this._extendRangeToChild(e,e.callExpression),r.length>0&&this._extendRangeToChild(e,r[r.length-1]),(t=this._getNextToken()).token!==l.Token.CloseParenthesis?this._addError("Expected ')' at end of function call argument list",t.range):this._extendRangeToToken(e,t)}else if(t.token===l.Token.OpenBracket){var i=this._parseExpression();(t=this._getNextToken()).token!==l.Token.CloseBracket&&(this._addError("Expected ']'",t.range),this._rejectToken(t)),e={type:s.ParseNodeType.ArrayAccess,range:e.range,array:e,index:i},this._extendRangeToChild(e,e.array),this._extendRangeToChild(e,e.index)}else{if(t.token!==l.Token.Dot){this._rejectToken(t);break}var a=this._parseIdentifier();a||(this._addError("Expected identifier after '.'",t.range),a={type:s.ParseNodeType.Identifier,range:t.range,text:""}),e={type:s.ParseNodeType.MemberAccess,range:e.range,leftExpression:e,identifier:a},this._extendRangeToChild(e,e.identifier),this._extendRangeToChild(e,e.leftExpression)}}return e},e.prototype._parseExpression=function(e,t){void 0===e&&(e=o.Default),void 0===t&&(t=r.Expression);var n,i=this._getNextToken(),a=i;if(u.Tokenizer.isUnaryOperator(i.token)){var c={type:s.ParseNodeType.UnaryOperation,range:i.range,operator:i.token,operand:this._parseExpression(e,r.Unary)};this._extendRangeToChild(c,c.operand),n=c}else if(this._rejectToken(i),!(n=this._parseAtomExpression()))return(i=this._getNextToken()).token===l.Token.EndOfInput?this._addError("Expected expression but hit end of input",i.range):this._addError("Expected expression but found '"+i.text+"'",i.range),this._rejectToken(i),this._makeNumericLiteralNode(void 0);for(;;){if(i=this._getNextToken(),u.Tokenizer.isRelationalOperator(i.token)&&e&o.DisallowRelationalOperators)return this._rejectToken(i),n;if(!u.Tokenizer.isBinaryOperator(i.token))return this._rejectToken(i),n;var p=this._getBinaryOperatorPrecedence(i.token);if(void 0===p)return this._addError("Unexpected token in expression",i.range),n;if(p<=t)return this._rejectToken(i),n;var d=this._parseExpression(o.Default,p),m={type:s.ParseNodeType.BinaryOperation,range:a.range,operator:i.token,leftOperand:n,rightOperand:d};this._extendRangeToChild(m,d),n=m}},e.prototype._parseArrayLiteral=function(e){var t=this,n={type:s.ParseNodeType.ArrayLiteral,range:e.range,values:[]};n.hangingComma=this._parseCommaSeparatedList(l.Token.CloseBracket,(function(){return n.values.push(t._parseExpression()),!0}));var r=this._getNextToken();return r.token!==l.Token.CloseBracket?(this._addError("Expected ']' at the end of array literal",r.range),this._rejectToken(r)):this._extendRangeToToken(n,r),n},e.prototype._parseStructLiteralField=function(){var e=this._peekNextToken(),t=this._parseIdentifier();if(t){var n=this._getAccumulatedComments();if((e=this._getNextToken()).token!==l.Token.Colon)return this._addError("Expected ':'",e.range),this._rejectToken(e),{type:s.ParseNodeType.StructLiteralField,range:t.range,name:t,comments:n,value:{type:s.ParseNodeType.ExpressionError,range:p,category:0}};var r={type:s.ParseNodeType.StructLiteralField,range:t.range,name:t,comments:n,value:this._parseExpression()};return this._extendRangeToChild(r,r.value),this._extendRangeToChild(r,r.name),this._addEndOfLineComment(r.range.end.line,r.comments),r}this._addError("Expected field name",e.range)},e.prototype._parseStructLiteral=function(e){var t=this,n={type:s.ParseNodeType.StructLiteral,comments:this._getAccumulatedComments(),range:e.range,fields:[]};this._addEndOfLineComment(n.range.start.line,n.comments),n.hangingComma=this._parseCommaSeparatedList(l.Token.CloseBrace,(function(){var e=t._parseStructLiteralField();return!!e&&(n.fields.push(e),!0)}));var r=this._getNextToken();return r.token!==l.Token.CloseBrace?(this._extendRangeToToken(n,r),this._addError("Expected '}' at end of struct literal",r.range),this._rejectToken(r),this._swallowTokensUntilEndOfBlock(n,!0)):this._extendRangeToToken(n,r),n.endComment=this._parseEndComment(),n},e.prototype._parseFunctionCallArguments=function(){var e=this,t=[],n=this._parseCommaSeparatedList(l.Token.CloseParenthesis,(function(){return t.push(e._parseExpression()),!0}));return{args:t,hangingComma:n}},e.prototype._getBinaryOperatorPrecedence=function(e){switch(e){case l.Token.Or:return r.LogicalOr;case l.Token.And:return r.LogicalAnd;case l.Token.EqualTo:case l.Token.NotEqualTo:return r.Equality;case l.Token.GreaterThan:case l.Token.GreaterEqual:case l.Token.LessThan:case l.Token.LessEqual:return r.Relational;case l.Token.Plus:case l.Token.Minus:return r.AddSub;case l.Token.Multiply:case l.Token.Divide:case l.Token.Mod:return r.MultDivMod;case l.Token.Exponent:return r.Exponent}},e.prototype._parseWithinParentheses=function(e,t){void 0===t&&(t=!1);var n=this._getNextToken();if(n.token!==l.Token.OpenParenthesis)return this._addError("Expected '('",n.range),this._rejectToken(n),!1;if(t){if((n=this._getNextToken()).token===l.Token.CloseParenthesis)return!0;this._rejectToken(n)}return e(),(n=this._getNextToken()).token===l.Token.CloseParenthesis||(this._addError("Expected ')'",n.range),this._rejectToken(n),!1)},e.prototype._parseWithinBraces=function(e,t){var n=this._getNextToken();if(n.token!==l.Token.OpenBrace)return this._addError("Expected '{'",n.range),void this._rejectToken(n);t(),(n=this._getNextToken()).token!==l.Token.CloseBrace&&(this._addError("Expected '}'",n.range),this._rejectToken(n),this._swallowTokensUntilEndOfBlock(e,!0))},e.prototype._parseCommaSeparatedList=function(e,t,n){void 0===n&&(n=!1);for(var r,o=!1,i=n;;){if(!i){if((r=this._peekNextToken()).token===e)return o;if(o=!1,!t())break}if((r=this._getNextToken()).token===e)return this._rejectToken(r),!1;if(r.token!==l.Token.Comma){this._rejectToken(r),this._addError("Expected ','",r.range);break}o=!0,i=!1}for(;;){var a=this._getNextToken();if(a.token===l.Token.EndOfInput)return!1;if(l.isKeyword(a.token)||a.token===e)return this._rejectToken(a),!1}},e.prototype._parseVersionString=function(e){var t=e.split(".");if(2===t.length){var n=/^(0|([1-9][0-9]{0,2}))$/;if(t[0].match(n)&&t[1].match(n))return{major:Number.parseInt(t[0],10),minor:Number.parseInt(t[1],10)}}},e.prototype._parseIdentifier=function(e){var t=this._getNextToken();return t.token===l.Token.Identifier?this._makeIdentifierNode(t):l.isKeyword(t.token)?e&&e.some((function(e){return t.token===e}))?void this._rejectToken(t):{type:s.ParseNodeType.Identifier,range:t.range,text:t.text}:void this._rejectToken(t)},e.prototype._makeIdentifierNode=function(e){return{type:s.ParseNodeType.Identifier,range:e.range,text:u.Tokenizer.decodeIdentifier(e.text)}},e.prototype._makeStringLiteralNode=function(e){return e?{type:s.ParseNodeType.StringLiteral,range:e.range,text:e.text,value:u.Tokenizer.decodeStringLiteral(e.text)}:{type:s.ParseNodeType.StringLiteral,range:p,text:'""',value:""}},e.prototype._makeNumericLiteralNode=function(e){if(!e)return{type:s.ParseNodeType.NumericLiteral,range:p,text:"0",value:0};var t=0,n=s.ParseNodeType.False;return e.token===l.Token.True?(t=1,n=s.ParseNodeType.True):e.token===l.Token.NumericLiteral&&(t=parseFloat(e.text),n=s.ParseNodeType.NumericLiteral),{type:n,range:e.range,text:e.text,value:t}},e.prototype._parseEndComment=function(){var e=this._getAccumulatedComments();if(e.length>0)return{type:s.ParseNodeType.Comment,range:p,comments:e}},e.prototype._swallowTokensUntilEndOfBlock=function(e,t){for(var n=1,r=!1;;){var o=this._getNextToken();if(o.token===l.Token.OpenBrace)n++;else if(o.token===l.Token.CloseBrace){if(n>0&&n--,0===n){t||this._rejectToken(o),e&&this._extendRangeToToken(e,o),r=!0;break}}else{if(this._isStatementKeyword(o.token)&&n<=1){this._rejectToken(o);break}if(o.token===l.Token.EndOfInput){r=!0;break}}e&&this._extendRangeToToken(e,o)}return r},e.prototype._isStatementKeyword=function(e){switch(e){case l.Token.Action:case l.Token.Algorithm:case l.Token.Constant:case l.Token.Concept:case l.Token.Constraint:case l.Token.Curriculum:case l.Token.Data:case l.Token.Dataset:case l.Token.Else:case l.Token.Experiment:case l.Token.Function:case l.Token.Graph:case l.Token.If:case l.Token.Inkling:case l.Token.Lesson:case l.Token.Package:case l.Token.Return:case l.Token.Reward:case l.Token.Scenario:case l.Token.Simulator:case l.Token.Source:case l.Token.State:case l.Token.Terminal:case l.Token.Training:case l.Token.Type:case l.Token.Var:return!0}return!1},e.prototype._addError=function(e,t,n){void 0===n&&(n=i.DiagnosticType.ParserError),this._diagnostics.push(new i.Diagnostic(t,e,n))},e.prototype._getNextToken=function(){return this._tokenProvider.getToken()},e.prototype._rejectToken=function(e){this._tokenProvider.rejectToken(e)},e.prototype._peekNextToken=function(){var e=this._getNextToken();return this._rejectToken(e),e},e.prototype._getAccumulatedComments=function(){return this._tokenProvider.getAccumulatedFullLineComments()},e.prototype._addEndOfLineComment=function(e,t){var n=this._tokenProvider.getEndOfLineCommentForLine(e);n&&t.push(n)},e.prototype._extendRangeToChild=function(e,t){t.range!==p&&(e.range=e.range.extendRange(t.range))},e.prototype._extendRangeToToken=function(e,t){e.range=e.range.extendRange(t.range)},e}();t.Parser=d},814:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Printer=void 0;var r=n(6155),o=n(785),i=n(2068),a=n(9554),s=n(4393),c=function(){function e(e){void 0===e&&(e={}),this._inklingVersion=o.CurrentInklingVersion.minor,this._omitComments=!1,this._compactOutput=!1,this._lineEnding=e.lineEnding||"\n",void 0!==e.inklingVersion&&(this._inklingVersion=e.inklingVersion),this._omitComments=!!e.omitComments,this._compactOutput=!!e.compactOutput}return e.prototype.printNode=function(e){var t=new i.TextWriter(this._lineEnding);return this._printNode(t,e),t.getText()},e.prototype._printCommaSeparated=function(e,t,n,r,o,i){t.forEach((function(a,s){n(a),(i||s<t.length-1)&&e.write(o?",":", "),o&&(r&&r(a),e.writeLine())}))},e.prototype._printNode=function(e,t){switch(t.type){case r.ParseNodeType.Identifier:this._printIdentifier(e,t);break;case r.ParseNodeType.MemberAccess:this._printMemberAccess(e,t);break;case r.ParseNodeType.Inkling:this._printInklingVersionStatement(e,t);break;case r.ParseNodeType.Using:this._printUsingStatement(e,t);break;case r.ParseNodeType.NumericLiteral:case r.ParseNodeType.True:case r.ParseNodeType.False:this._printNumericLikeLiteral(e,t);break;case r.ParseNodeType.StringLiteral:this._printStringLiteral(e,t);break;case r.ParseNodeType.ArrayLiteral:this._printArrayLiteral(e,t);break;case r.ParseNodeType.StructLiteral:this._printStructLiteral(e,t);break;case r.ParseNodeType.Experiment:this._printExperimentStatement(e,t);break;case r.ParseNodeType.Algorithm:this._printAlgorithmStatement(e,t);break;case r.ParseNodeType.ExpressionError:e.write("<error>");break;case r.ParseNodeType.BinaryOperation:this._printBinaryOperation(e,t);break;case r.ParseNodeType.UnaryOperation:this._printUnaryOperation(e,t);break;case r.ParseNodeType.FunctionCall:this._printFunctionCall(e,t);break;case r.ParseNodeType.ParenthesizedExpression:this._printParenthesizedExpression(e,t);break;case r.ParseNodeType.ArrayAccess:this._printArrayAccess(e,t);break;case r.ParseNodeType.DotRange:this._printDotRange(e,t);break;case r.ParseNodeType.TypeArgumentsList:this._printTypeArgumentsList(e,t);break;case r.ParseNodeType.SpecializedType:this._printSpecializedType(e,t);break;case r.ParseNodeType.Const:this._printConstDeclaration(e,t);break;case r.ParseNodeType.Var:this._printVarDeclaration(e,t);break;case r.ParseNodeType.VarAssignment:this._printVariableAssignment(e,t);break;case r.ParseNodeType.Function:this._printFunctionDeclaration(e,t);break;case r.ParseNodeType.If:this._printIfElseStatement(e,t);break;case r.ParseNodeType.Type:this._printTypeDeclaration(e,t);break;case r.ParseNodeType.StructType:this._printStructType(e,t);break;case r.ParseNodeType.ArrayType:this._printArrayType(e,t);break;case r.ParseNodeType.Simulator:this._printSimulatorStatement(e,t);break;case r.ParseNodeType.Data:this._printDataStatement(e,t);break;case r.ParseNodeType.Goal:this._printGoalDeclaration(e,t);break;case r.ParseNodeType.GoalAtom:this._printGoalAtom(e,t);break;case r.ParseNodeType.Concept:this._printConceptStatement(e,t);break;case r.ParseNodeType.Input:this._printInput(e,t);break;case r.ParseNodeType.Lesson:this._printLesson(e,t);break;case r.ParseNodeType.Return:this._printReturnStatement(e,t);break;case r.ParseNodeType.Program:this._printProgram(e,t);break;case r.ParseNodeType.Graph:this._printGraphDeclaration(e,t);break;case r.ParseNodeType.Number:e.write("number");break;case r.ParseNodeType.String:e.write("string");break;default:e.write("<Unexpected node type: "+r.ParseNodeType[t.type]+">")}},e.prototype._printIdentifier=function(e,t){t.text&&e.write(a.Tokenizer.encodeIdentifier(t.text,this._inklingVersion))},e.prototype._printMemberAccess=function(e,t){this._printNode(e,t.leftExpression),e.write("."),this._printIdentifier(e,t.identifier)},e.prototype._printInklingVersionStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("inkling "),this._printStringLiteral(e,t.versionString),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printUsingStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("using "),this._printIdentifier(e,t.name),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printNumericLikeLiteral=function(e,t){e.write(t.text)},e.prototype._printStringLiteral=function(e,t){e.write(t.text)},e.prototype._printArrayLiteral=function(e,t){var n=this;e.write("["),this._printCommaSeparated(e,t.values,(function(t){n._printNode(e,t)}),void 0,!1,t.hangingComma),e.write("]")},e.prototype._printStructLiteral=function(e,t){var n=this;this._compactOutput?e.write("{ "):(e.write("{"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent()),this._printCommaSeparated(e,t.fields,(function(t){n._printFullLineComments(e,t.comments),n._printIdentifier(e,t.name),e.write(": "),n._printNode(e,t.value)}),(function(t){n._printEndOfLineComment(e,t.comments)}),!this._compactOutput,t.hangingComma),this._compactOutput?e.write(" }"):(this._printEndComment(e,t.endComment),e.decreaseIndent(),e.write("}"))},e.prototype._printExperimentStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("experiment "),this._printNode(e,t.expression),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printAlgorithmStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("algorithm "),this._printNode(e,t.expression),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printUnaryOperation=function(e,t){switch(t.operator){case s.Token.Plus:e.write("+");break;case s.Token.Minus:e.write("-");break;case s.Token.Not:e.write("not ");break;default:e.write("<Unexpected unary operator>")}this._printNode(e,t.operand)},e.prototype._printBinaryOperation=function(e,t){switch(this._printNode(e,t.leftOperand),t.operator){case s.Token.Or:e.write(" or ");break;case s.Token.And:e.write(" and ");break;case s.Token.EqualTo:e.write(" == ");break;case s.Token.NotEqualTo:e.write(" != ");break;case s.Token.LessThan:e.write(" < ");break;case s.Token.LessEqual:e.write(" <= ");break;case s.Token.GreaterThan:e.write(" > ");break;case s.Token.GreaterEqual:e.write(" >= ");break;case s.Token.Plus:e.write(" + ");break;case s.Token.Minus:e.write(" - ");break;case s.Token.Multiply:e.write(" * ");break;case s.Token.Divide:e.write(" / ");break;case s.Token.Mod:e.write(" % ");break;case s.Token.Exponent:e.write(" ** ");break;default:e.write(" >unsupported> ")}this._printNode(e,t.rightOperand)},e.prototype._printFunctionCall=function(e,t){var n=this;this._printNode(e,t.callExpression),e.write("("),this._printCommaSeparated(e,t.arguments,(function(t){n._printNode(e,t)}),void 0,!1,t.hangingComma),e.write(")")},e.prototype._printParenthesizedExpression=function(e,t){e.write("("),this._printNode(e,t.expression),e.write(")")},e.prototype._printArrayAccess=function(e,t){this._printNode(e,t.array),e.write("["),this._printNode(e,t.index),e.write("]")},e.prototype._printDotRange=function(e,t){this._printNode(e,t.start),e.write(" .. "),this._printNode(e,t.stop),t.step&&(e.write(" step "),this._printNode(e,t.step))},e.prototype._printConstDeclaration=function(e,t){this._printFullLineComments(e,t.comments),e.write("const "),this._printIdentifier(e,t.name),t.constantType&&(e.write(": "),this._printNode(e,t.constantType)),e.write(" = "),this._printNode(e,t.value),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printVarDeclaration=function(e,t){this._printFullLineComments(e,t.comments),e.write("var "),this._printIdentifier(e,t.name),t.varType&&(e.write(": "),this._printNode(e,t.varType)),t.value&&(e.write(" = "),this._printNode(e,t.value)),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printVariableAssignment=function(e,t){this._printFullLineComments(e,t.comments),this._printIdentifier(e,t.name),e.write(" = "),this._printNode(e,t.value),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printGoalDeclaration=function(e,t){var n=this;this._printFullLineComments(e,t.comments),e.write("goal "),e.write("("),this._printCommaSeparated(e,t.inputs,(function(t){n._printIdentifier(e,t.name),e.write(": "),n._printNode(e,t.paramType)}),void 0,!1,t.hangingComma),e.write(")"),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.subgoals.forEach((function(t){n._printNode(e,t)})),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.write("}"),this._compactOutput||e.writeLine()},e.prototype._printGoalAtom=function(e,t){var n="<unknown>";switch(t.operation){case s.Token.Reach:n="reach";break;case s.Token.Avoid:n="avoid";break;case s.Token.Drive:n="drive";break;case s.Token.Minimize:n="minimize";break;case s.Token.Maximize:n="maximize"}this._printFullLineComments(e,t.comments),e.write(n+" "),this._printIdentifier(e,t.name),e.writeLine(":"),e.increaseIndent(),this._printNode(e,t.valueExpression),e.writeLine(),t.targetExpression&&(e.write("in "),this._printNode(e,t.targetExpression),e.writeLine()),t.withinExpression&&(e.write("within "),this._printNode(e,t.withinExpression),e.writeLine()),e.decreaseIndent()},e.prototype._printFunctionDeclaration=function(e,t){var n=this;this._printFullLineComments(e,t.comments),e.write("function "),t.name.text&&this._printIdentifier(e,t.name),e.write("("),this._printCommaSeparated(e,t.inputs,(function(t){n._printIdentifier(e,t.name),e.write(": "),n._printNode(e,t.paramType)}),void 0,!1,t.hangingComma),e.write(")"),t.outputType&&(e.write(": "),this._printNode(e,t.outputType)),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.block.statements.forEach((function(t){n._printNode(e,t)})),this._printEndComment(e,t.block.endComment),e.decreaseIndent(),e.write("}"),e.writeLine()},e.prototype._printFunctionReference=function(e,t,n){this._printFullLineComments(e,n.comments),e.write(t+" "),this._printNode(e,n.functionRef),n.functionRef.type!==r.ParseNodeType.Function&&(this._printEndOfLineComment(e,n.comments),e.writeLine())},e.prototype._printIfElseStatement=function(e,t){var n=this;this._printFullLineComments(e,t.comments),e.write("if "),this._printNode(e,t.condition),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.ifBlock.statements.forEach((function(t){n._printNode(e,t)})),this._printEndComment(e,t.ifBlock.endComment),e.decreaseIndent(),e.write("}"),t.elseIfStatement?(e.write(" else "),this._printIfElseStatement(e,t.elseIfStatement)):t.elseBlock?(e.writeLine(" else {"),e.increaseIndent(),t.elseBlock.statements.forEach((function(t){n._printNode(e,t)})),this._printEndComment(e,t.elseBlock.endComment),e.decreaseIndent(),e.writeLine("}")):e.writeLine()},e.prototype._printTypeDeclaration=function(e,t){this._printFullLineComments(e,t.comments),e.write("type "),this._printIdentifier(e,t.name),e.write(" "),this._printNode(e,t.declaredType),this._printEndOfLineComment(e,t.comments),e.writeLine()},e.prototype._printSpecializedType=function(e,t){this._printNode(e,t.baseType),e.write("<"),this._printNode(e,t.specialization),e.write(">")},e.prototype._printTypeArgumentsList=function(e,t){var n=this;this._printCommaSeparated(e,t.typeArguments,(function(t){t.argumentName&&(n._printIdentifier(e,t.argumentName),e.write(" = ")),n._printNode(e,t.argumentType)}),void 0,!1,t.hangingComma)},e.prototype._printStructType=function(e,t){var n=this;this._compactOutput?e.write("{ "):(e.write("{"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent()),this._printCommaSeparated(e,t.fields,(function(t){n._printFullLineComments(e,t.comments),n._printNode(e,t.name),e.write(": "),n._printNode(e,t.fieldType)}),(function(t){n._printEndOfLineComment(e,t.comments)}),!this._compactOutput,t.hangingComma),this._compactOutput?e.write(" }"):(this._printEndComment(e,t.endComment),e.decreaseIndent(),e.write("}"))},e.prototype._printArrayType=function(e,t){this._printNode(e,t.baseType),e.write("["),this._printNode(e,t.length),e.write("]")},e.prototype._printSourceStatement=function(e,t,n,r){this._printFullLineComments(e,t.comments),e.write(n),this._printIdentifier(e,t.name),e.write("("),this._printIdentifier(e,t.actionParam.name),e.write(": "),this._printNode(e,t.actionParam.paramType),t.configParam&&(e.write(", "),this._printIdentifier(e,t.configParam.name),e.write(": "),this._printNode(e,t.configParam.paramType)),t.hangingComma&&e.write(", "),e.write("): "),this._printNode(e,t.stateType),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.objectReference&&(this._printFullLineComments(e,t.objectReference.comments),e.write(r),this._printNode(e,t.objectReference.expression),this._printEndOfLineComment(e,t.objectReference.comments),e.writeLine()),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")},e.prototype._printSimulatorStatement=function(e,t){this._printSourceStatement(e,t,"simulator ","package ")},e.prototype._printDataStatement=function(e,t){this._printSourceStatement(e,t,"data ","dataset ")},e.prototype._printConceptStatement=function(e,t){var n=this;this._printFullLineComments(e,t.comments),t.hasInlineOutput&&e.write("output "),e.write("concept "),this._printIdentifier(e,t.name),e.write("("),this._printCommaSeparated(e,t.inputs,(function(t){n._printNode(e,t.inputSource)}),void 0,!1,t.hangingComma),e.write(")"),t.outputType&&(e.write(": "),this._printNode(e,t.outputType)),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.experiment&&this._printExperimentStatement(e,t.experiment),t.selects.forEach((function(t){n._printSelectStatement(e,t)})),t.curriculum&&this._printCurriculumStatement(e,t.curriculum),t.programmedFunction&&this._printFunctionReference(e,"programmed",t.programmedFunction),t.importedModel&&this._printImportStatement(e,t.importedModel),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")},e.prototype._printSelectStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("select "),this._printIdentifier(e,t.targetConcept),t.maskFunction?(e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),this._printFunctionReference(e,"mask",t.maskFunction),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")):(this._printEndOfLineComment(e,t.comments),e.writeLine())},e.prototype._printImportStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("import "),this._printNode(e,t.expression),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printCurriculumStatement=function(e,t){var n=this;this._printFullLineComments(e,t.comments),e.write("curriculum {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.experiment&&this._printExperimentStatement(e,t.experiment),t.algorithm&&this._printAlgorithmStatement(e,t.algorithm),t.sources.forEach((function(t){n._printDataSource(e,t)})),t.reward&&this._printFunctionReference(e,"reward",t.reward),t.terminal&&this._printFunctionReference(e,"terminal",t.terminal),t.state&&this._printFunctionReference(e,"state",t.state),t.action&&this._printFunctionReference(e,"action",t.action),t.training&&(this._printFullLineComments(e,t.training.comments),e.write("training "),this._printNode(e,t.training.expression),this._printEndOfLineComment(e,t.training.comments),e.writeLine()),t.goal&&this._printGoalDeclaration(e,t.goal),t.lessons.forEach((function(t){n._printLesson(e,t)})),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")},e.prototype._printDataSource=function(e,t){this._printFullLineComments(e,t.comments),e.write("source "),this._printNode(e,t.dataSource),t.dataSource.type!==r.ParseNodeType.Simulator&&t.dataSource.type!==r.ParseNodeType.Data&&(this._printEndOfLineComment(e,t.comments),e.writeLine())},e.prototype._printLesson=function(e,t){this._printFullLineComments(e,t.comments),e.write("lesson "),this._printIdentifier(e,t.name),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.experiment&&this._printExperimentStatement(e,t.experiment),t.scenario&&(this._printFullLineComments(e,t.scenario.comments),e.write("scenario "),this._printNode(e,t.scenario.scenarioType),e.writeLine()),t.training&&(this._printFullLineComments(e,t.training.comments),e.write("training "),this._printNode(e,t.training.expression),this._printEndOfLineComment(e,t.training.comments),e.writeLine()),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")},e.prototype._printInput=function(e,t){e.write("input")},e.prototype._printOutput=function(e,t){this._printFullLineComments(e,t.comments),e.write("output "),t.outputSource.type===r.ParseNodeType.Input?e.write("input"):t.outputSource.type===r.ParseNodeType.Identifier?(this._printIdentifier(e,t.outputSource),this._printEndOfLineComment(e,t.comments)):this._printConceptStatement(e,t.outputSource),e.writeLine()},e.prototype._printReturnStatement=function(e,t){this._printFullLineComments(e,t.comments),e.write("return "),this._printNode(e,t.value),this._printEndOfLineComment(e,t.comments),this._compactOutput||e.writeLine()},e.prototype._printGraphDeclaration=function(e,t){var n=this;this._printFullLineComments(e,t.comments),e.write("graph (input: "),this._printNode(e,t.inputType),e.write(")"),t.outputType&&(e.write(": "),this._printNode(e,t.outputType)),e.write(" {"),this._printEndOfLineComment(e,t.comments),e.writeLine(),e.increaseIndent(),t.concepts.forEach((function(t){n._printConceptStatement(e,t)})),t.output&&!t.output.isConceptInlined&&this._printOutput(e,t.output),this._printEndComment(e,t.endComment),e.decreaseIndent(),e.writeLine("}")},e.prototype._printProgram=function(e,t){var n=this;t.inklingVersion&&this._printInklingVersionStatement(e,t.inklingVersion),t.statements.forEach((function(t){n._printNode(e,t)})),this._printEndComment(e,t.endComment)},e.prototype._printEndComment=function(e,t){t&&this._printFullLineComments(e,t.comments)},e.prototype._printFullLineComments=function(e,t){this._omitComments||this._compactOutput||t.forEach((function(t){t.fullLine&&e.writeLine(t.text)}))},e.prototype._printEndOfLineComment=function(e,t){if(!this._omitComments&&!this._compactOutput){var n=t.find((function(e){return!e.fullLine}));n&&e.write(" "+n.text)}},e}();t.Printer=c},7220:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokenWalker=t.SemanticTokenProvider=t.TokenType=void 0;var i,a=n(3649),s=n(4759),c=n(9948);!function(e){e[e.string=0]="string",e[e.number=1]="number",e[e.namespace=2]="namespace",e[e.parameter=3]="parameter",e[e.variable=4]="variable",e[e.property=5]="property",e[e.type=6]="type",e[e.function=7]="function",e[e.constant=8]="constant",e[e.lesson=9]="lesson",e[e.objective=10]="objective",e[e.concept=11]="concept",e[e.simulator=12]="simulator",e[e.data=13]="data"}(i=t.TokenType||(t.TokenType={}));var u=function(){function e(){}return e.getLegend=function(){var e=[];for(var t in i)isNaN(Number(t))&&e.push(t);return{tokenTypes:e,tokenModifiers:[]}},e.getTokens=function(e){var t=new l;t.walk(e._parseResult.parseTree);var n=t.getTokens();return this._encodeTokenInfo(n)},e._encodeTokenInfo=function(e){var t=[];e=e.sort((function(e,t){return e.line<t.line?-1:e.line>t.line?1:e.column<t.column?-1:e.column>t.column?1:0}));var n=0,r=0;return e.forEach((function(e){var o=e.line-n;o>0&&(r=0,n=e.line),t.push(o);var i=e.column-r;r=e.column,t.push(i),t.push(e.length),t.push(e.type),t.push(0)})),t},e}();t.SemanticTokenProvider=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tokenInfoArray=[],t}return o(t,e),t.prototype.getTokens=function(){return this._tokenInfoArray},t.prototype.visitIdentifier=function(e){var t,n=a.getIdentifierDataForNode(e);switch((null==n?void 0:n.symbolCategory)||c.SymbolCategory.Var){case c.SymbolCategory.Namespace:t=i.namespace;break;case c.SymbolCategory.Const:t=i.constant;break;case c.SymbolCategory.Var:t=i.variable;break;case c.SymbolCategory.Param:t=i.parameter;break;case c.SymbolCategory.Field:t=i.property;break;case c.SymbolCategory.Lesson:t=i.lesson;break;case c.SymbolCategory.Type:t=i.type;break;case c.SymbolCategory.Function:t=i.function;break;case c.SymbolCategory.Subgoal:t=i.objective;break;case c.SymbolCategory.Concept:t=i.concept;break;case c.SymbolCategory.Simulator:t=i.simulator;break;case c.SymbolCategory.Data:t=i.data;break;default:return!0}return this._addTokenInfo(e,t),!0},t.prototype.visitString=function(e){return this._addTokenInfo(e,i.string),!0},t.prototype.visitNumber=function(e){return this._addTokenInfo(e,i.number),!0},t.prototype._addTokenInfo=function(e,t){e.range.isEmpty()||this._tokenInfoArray.push({line:e.range.start.line,column:e.range.start.character,length:e.range.end.character-e.range.start.character,type:t})},t}(s.ParseTreeWalker);t.SemanticTokenWalker=l},5454:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0;var i=n(2357),a=function(){function e(e){var t;this._stack=[],e&&(t=this._stack).push.apply(t,o([],r(e)))}return e.prototype.isEmpty=function(){return 0===this._stack.length},e.prototype.getDepth=function(){return this._stack.length},e.prototype.push=function(e){this._stack.push(e)},e.prototype.pop=function(){return i(!this.isEmpty()),this._stack.pop()},e.prototype.getTop=function(){return i(!this.isEmpty()),this._stack[this._stack.length-1]},e.prototype.forEach=function(e){for(var t=0;t<this._stack.length&&!e(this._stack[t],t);t++);},e.prototype.forEachReversed=function(e){for(var t=this._stack.length-1;t>=0&&!e(this._stack[t],t);t--);},e}();t.Stack=a},6172:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.printValueSinglePrecision=void 0,t.printValueSinglePrecision=function(e){return parseFloat(e.toPrecision(7)).toString()}},4408:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolResolver=void 0;var r=n(3799),o=n(4471),i=n(7585),a=n(6234),s=n(7499),c=n(3649),u=n(6155),l=n(9371),p=n(9948),d=n(4393),m=n(8240),y=n(2374),g=n(7379),h=n(1570),f=1024,T=function(){function e(){}return e.prototype.resolveSymbol=function(e,t){if(!e.resolvedObject)switch(e.category){case p.SymbolCategory.Namespace:var n=e;e.resolvedObject=this._validateNamespace(n.node,t);break;case p.SymbolCategory.Const:var r=e;e.resolvedObject=this._validateConst(r.node,t);break;case p.SymbolCategory.Type:var o=e;e.resolvedObject=this._validateTypeDeclaration(o.node,t);break;case p.SymbolCategory.Concept:var i=e;e.resolvedObject=this._validateConcept(i.node,t);break;case p.SymbolCategory.Function:var a=e;e.resolvedObject=this._validateFunction(a.node,t);break;case p.SymbolCategory.Simulator:var s=e;e.resolvedObject=this._validateSimulator(s.node,t);break;case p.SymbolCategory.Data:var c=e;e.resolvedObject=this._validateData(c.node,t);break;case p.SymbolCategory.Experiment:var u=e;e.resolvedObject=this._validateExperiment(u.node,t);break;case p.SymbolCategory.GraphInput:var l=e;e.resolvedObject=this._validateGraphInput(l.node,t);break;case p.SymbolCategory.GraphOutput:l=e,e.resolvedObject=this._validateGraphOutput(l.node,t);break;default:t.onError("Unexpected symbol type",e.node)}return e.resolvedObject},e.prototype.conditionallyReportUnreferencedSymbol=function(e,t){if(!e.referenced){var n=this._getNameNodeForSymbol(e.node);n&&t.onUnreferencedCode("Symbol '"+e.name+"' not referenced",n)}},e.prototype._validateNamespace=function(e,t){var n,r=!1;s.builtInNamespaces[e.name.text]?n=s.builtInNamespaces[e.name.text]:(t.onError("Unknown namespace '"+e.name.text+"'",e.name),r=!0,n=new l.SymbolTable);var o={errorReported:r,comments:e.comments,symbolTable:n,declarationRange:e.range,nameRange:e.name.range,node:e};return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Namespace}),o},e.prototype._validateConst=function(e,t){var n,r=i.ExpressionEvaluator.evaluateConstantExpression(e.value,t);e.constantType?(n=y.TypeChecker.getTypeOfTypeNode(e.constantType,t))&&!n.errorReported&&(y.TypeChecker.isValueAssignableToType(r,n)||t.onError("Value is not assignable to const with specified type",e.name)):n=y.TypeChecker.synthesizeTypeFromValue(r);var o={errorReported:r.errorReported||n.errorReported,name:e.name.text,comments:e.comments,value:r,type:n,declarationRange:e.range,nameRange:e.name.range,node:e};return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Const,resolvedObject:o}),o},e.prototype._validateTypeDeclaration=function(e,t){var n=y.TypeChecker.getTypeOfTypeNode(e.declaredType,t);n.symbolicName=e.name.text;var r={errorReported:n.errorReported,comments:e.comments,name:e.name.text,node:e,declarationRange:e.range,nameRange:e.name.range,type:n};return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Type,resolvedObject:r}),r},e.prototype._validateConcept=function(e,t){var n=this,r=y.TypeChecker.getTypeOfTypeNode(e.outputType,t),i=r.errorReported,a=void 0!==e.curriculum,s=!1,l=new Map,d=e.inputs.map((function(e){var r=n._validateConceptInput(e,t,a);return r.errorReported?i=!0:r.inputConcept?(l.has(r.inputConcept.name)&&t.onError("Concept inputs must be unique",e),l.set(r.inputConcept.name,r.inputConcept)):(s&&t.onError("Concept inputs must be unique",e),s=!0),r}));!r.errorReported&&a&&y.TypeChecker.doesTypeContainString(r)&&(t.onError("Output type of a learned concept cannot contain strings",e.outputType),i=!0),r.errorReported||!a||y.TypeChecker.isUsageAllowedForType(r,g.ComplexTypeUsage.ConceptOutput)||(t.onError("Output type of a learned concept cannot contain complex types",e.outputType),i=!0),!r.errorReported&&y.TypeChecker.getDimensionalityOfType(r)>f&&(t.onError("Concept output type cannot contain more than 1024 dimensions",e.outputType),i=!0);var m,h,T,v,_=y.TypeChecker.isTypeContinuous(r),C=y.TypeChecker.isTypeDiscrete(r);if(!i&&a&&0===e.selects.length&&C&&!_&&y.TypeChecker.getCombinatoricDimensionalityOfType(r)>f&&(t.onError("Concept output type cannot contain more than 1024 combinatoric dimensions when it is a nominal type; reduce dimensionality or switch from nominal to ordinal type",e.outputType),i=!0),i||(_||C||!a||(t.onError("Output type of learned concept must be nominal or not nominal, not a mixture of both; an example nominal type is 'number<Up = 0, Down = 1>",e.outputType),i=!0),_&&!i&&a&&(y.TypeChecker.isTypeConstrained(r)||t.onWarning("Output type of learned concept should not include unconstrained continuous values",e.outputType))),0===d.length&&(t.onError("Concept must have at least one input",e.name.range.isEmpty()?e:e.name),i=!0),e.experiment&&(m=this._validateExperiment(e.experiment,t)).errorReported&&(i=!0),e.curriculum&&(h=this._validateCurriculum(e.curriculum,r,e.selects.length>0,t)).errorReported&&(i=!0),e.programmedFunction)if(!(T=this._validateFunctionReference(e.programmedFunction,t))||T.errorReported)i=!0;else{t.compilerOptions.enableProgrammedConcepts||t.onError("Programmed concepts are not supported",e.programmedFunction.range);var b=!1;if(T.signatures[0].parameters.forEach((function(n,r){if(r>=d.length){if(!b){var a=e.programmedFunction.functionRef.type===u.ParseNodeType.Function?e.programmedFunction.functionRef.inputs[r]:void 0;t.onError("Programmed function accepts too many parameters; was expecting "+d.length+" at most",(null==a?void 0:a.name)||e.programmedFunction.functionRef),b=!0,i=!0}}else{var s=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(d[r].inputType,n.type,s)||(a=e.programmedFunction.functionRef.type===u.ParseNodeType.Function?e.programmedFunction.functionRef.inputs[r]:void 0,t.onError("Type of concept input "+(r+1)+' is not assignable to programmed function parameter "'+n.name+'"'+s.getString(),(null==a?void 0:a.paramType)||a||e.programmedFunction.functionRef),i=!0)}})),!r.errorReported&&!y.TypeChecker.isTypeSame(T.signatures[0].returnType,r)){var k=e.programmedFunction.functionRef.type===u.ParseNodeType.Function?e.programmedFunction.functionRef.name.range.isEmpty()?e.programmedFunction.functionRef.functionToken.range:e.programmedFunction.functionRef.name.range:e.programmedFunction.functionRef.range;t.onError("Return type of programmed function must match concept return type",k),i=!0}}e.importedModel&&(t.compilerOptions.enableImportedConcepts||(t.onError("Imported concepts are not supported",e.importedModel.range),i=!0),(v=this._validateImport(e.importedModel,t)).errorReported&&(i=!0),e.inputs.length>1&&(t.onError("Imported concepts support only one input",e.inputs[1]),i=!0));var S=new Map,x=[];e.selects.forEach((function(a){var s,c,l=t.lookUpSymbol(a.targetConcept.text);if(t.compilerOptions.enableSelectorConcepts||(t.onError("Select statements are not supported",a.targetConcept),i=!0),l.isCircular)t.onError("Selected concept cannot create circular dependency",a.targetConcept),i=!0;else{var m=l.symbol;m&&m.category===p.SymbolCategory.Concept?(s=t.resolveSymbol(m),S.has(s.name)?(t.onError("Selected concepts must be unique",a.targetConcept),s=void 0):S.set(s.name,s)):(t.onError("Selected concept must be another concept",a.targetConcept),i=!0)}if(s&&(y.TypeChecker.isTypeSame(s.outputType,r)||(t.onError('Output type of selected concept "'+s.name+'" must match that of its containing concept "'+e.name.text+'"',a.targetConcept),s=void 0)),s&&a.maskFunction)if(!(c=n._validateFunctionReference(a.maskFunction,t))||c.errorReported)i=!0;else{var h=!1;c.signatures[0].parameters.forEach((function(e,n){if(n>=d.length){if(!h){var r=a.maskFunction.functionRef.type===u.ParseNodeType.Function?a.maskFunction.functionRef.inputs[n]:void 0;t.onError("Mask function accepts too many parameters; was expecting "+d.length+" at most",(null==r?void 0:r.name)||a.maskFunction.functionRef),i=!0,h=!0}}else{var s=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(d[n].inputType,e.type,s)||(r=a.maskFunction.functionRef.type===u.ParseNodeType.Function?a.maskFunction.functionRef.inputs[n]:void 0,t.onError("Type of concept input "+(n+1)+' is not assignable to mask function parameter "'+e.name+'"'+s.getString(),(null==r?void 0:r.paramType)||r||a.maskFunction.functionRef),i=!0)}})),c.signatures[0].returnType.category!==g.TypeCategory.Number&&(t.onError("Output of mask function must be a number",a.maskFunction.functionRef),i=!0)}s&&x.push({concept:s,errorReported:i,comments:a.comments,maskFunction:c,node:a})})),e.programmedFunction||e.curriculum||e.importedModel||(t.onError("Concept must contain a curriculum (for learned concepts), a programmed function (for programmed concepts), or an import statement (for imported models)",e.name||e.conceptToken.range),i=!0);var N={comments:e.comments,name:e.name.text,errorReported:i,outputType:r,experiment:m,curriculum:h,programmedFunction:T,importedModel:v,inputs:d,declarationRange:e.range,nameRange:e.name.range,selects:x.length>0?x:void 0,node:e};return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Concept,resolvedObject:N}),N},e.prototype._validateConceptInput=function(e,t,n){var r,o,i=!1;if(e.inputSource.type===u.ParseNodeType.Input)(r=this._getGraphInputType(t)).errorReported&&(i=!0);else{var a=t.lookUpSymbol(e.inputSource.text);if(a.isCircular)t.onError("Concept input cannot create circular dependency",e.inputSource),r=y.TypeChecker.getDummyType(),i=!0;else{var s=a.symbol;s&&s.category===p.SymbolCategory.Concept?(r=(o=t.resolveSymbol(s)).outputType,c.setIdentifierDataForNode(e.inputSource,{symbolCategory:p.SymbolCategory.Concept,resolvedObject:o})):(t.onError('Concept input must be "input" or another concept',e.inputSource),r=y.TypeChecker.getDummyType(),i=!0)}}return!r.errorReported&&y.TypeChecker.doesTypeContainString(r)&&(t.onError("Concept input type cannot contain strings",e.inputSource),i=!0),r.errorReported||(n?y.TypeChecker.isUsageAllowedForType(r,g.ComplexTypeUsage.LearnedConceptInput)||(t.onError("Concept input type for a learned concept cannot include images",e.inputSource),i=!0):y.TypeChecker.isUsageAllowedForType(r,g.ComplexTypeUsage.NonLearnedConceptInput)||(t.onError("Concept input type cannot include images",e.inputSource),i=!0)),!r.errorReported&&y.TypeChecker.getDimensionalityOfType(r)>f&&(t.onError("Concept input type cannot contain more than 1024 dimensions",e.inputSource),i=!0),{errorReported:i,node:e,comments:[],inputConcept:o,inputType:r,declarationRange:e.range}},e.prototype._validateCurriculum=function(e,t,n,r){var i,a,s,l,d,m,h,f,T=this,v=!1,_=!1,C=[];if(e.algorithm&&(a=this._validateAlgorithm(e.algorithm,t,n,r)).errorReported&&(v=!0),e.training&&((s=this._validateTraining(e.training,!!e.goal,!1,!1,r)).errorReported?v=!0:s.value.value.has("LessonRewardThreshold")&&(_=!0)),e.experiment&&(i=this._validateExperiment(e.experiment,r)).errorReported&&(v=!0),e.sources.forEach((function(n){var i;if(n.dataSource.type===u.ParseNodeType.Identifier){var a=r.lookUpSymbol(n.dataSource.text);if(T._saveIdentifierSymbolCategory(n.dataSource,a),a.isCircular)r.onError("Circular dependency not allowed",n.dataSource),v=!0;else{var s=a.symbol;(null==s?void 0:s.category)===p.SymbolCategory.Simulator?(i=r.resolveSymbol(s),c.setIdentifierDataForNode(n.dataSource,{symbolCategory:p.SymbolCategory.Simulator,resolvedObject:i})):(null==s?void 0:s.category)===p.SymbolCategory.Data?(i=r.resolveSymbol(s),c.setIdentifierDataForNode(n.dataSource,{symbolCategory:p.SymbolCategory.Data,resolvedObject:i})):(r.onError("'"+n.dataSource.text+"' does not refer to a simulator or data source",n.dataSource),v=!0)}}else n.dataSource.type===u.ParseNodeType.Simulator?i=T._validateSimulator(n.dataSource,r):n.dataSource.type===u.ParseNodeType.Data&&(i=T._validateData(n.dataSource,r));if(i){if(i.errorReported)v=!0;else{var l=T._getGraphInputType(r);if(e.state&&((h=T._validateFunctionReference(e.state,r))||(v=!0),h&&!v)){var d=T._getGraphInputType(r);if(!d.errorReported){var m=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(h.signatures[0].returnType,d,m)||(r.onError("Return type of state transform function must match graph input type"+m.getString(),e.state.functionRef),v=!0)}if(1!==h.signatures[0].parameters.length)r.onError("State transform function expected to take a single parameter",e.state.functionRef),v=!0;else if(h.signatures[0].parameters.length>=1){var g=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(i.stateType,h.signatures[0].parameters[0].type,g)||(r.onError("First parameter of state transform function must match source output type"+g.getString(),e.state.functionRef),v=!0)}}if(e.action&&((f=T._validateFunctionReference(e.action,r))||(v=!0),f&&!v))if(1!==f.signatures[0].parameters.length&&(r.onError("Action transform function expected to take a single parameter",e.action.functionRef),v=!0),1!==f.signatures[0].parameters.length)r.onError("Action transform function expected to take a single parameter",e.action.functionRef),v=!0;else if(f.signatures[0].parameters.length>=1){var _=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(t,f.signatures[0].parameters[0].type,_)||(r.onError("First parameter of action transform function must match concept output type"+_.getString(),e.action.functionRef),v=!0)}var b=f?f.signatures[0].returnType:t,k=new o.DiagnosticAddendum;b.errorReported||t.errorReported?v=!0:y.TypeChecker.isTypeCastable(b,i.actionType,k)||(r.onError("Concept output type is not castable to source action type"+k.getString(),e.action?e.action.functionRef:n.dataSource),v=!0);var S=h?h.signatures[0].returnType:i.stateType;if(S.errorReported||l.errorReported)v=!0;else{var x=new o.DiagnosticAddendum;y.TypeChecker.isTypeCastable(S,l,x)||(r.onError("Source output state type is not castable to graph input type"+x.getString(),e.state?e.state.functionRef:n.dataSource),v=!0)}}C.push(i)}})),0===C.length)r.onError("Curriculum requires source statement to specify simulator or data source",e.curriculumToken.range),v=!0;else if(C.length>1)if(r.compilerOptions.enableMultipleSources){var b=C.filter((function(e){return e.node.type===u.ParseNodeType.Data}));if(b.length>1){var k=C.lastIndexOf(b[1]);r.onError("Only one data source is supported within a curriculum",e.sources[k]),v=!0}var S=C.filter((function(e){return e.node.type===u.ParseNodeType.Simulator}));S.length>1&&(k=C.lastIndexOf(S[1]),r.onError("Only one simulator is supported within a curriculum",e.sources[k]),v=!0)}else r.onError("Only one source is supported within a curriculum",C[1].node.range),v=!0;if(e.reward&&((l=this._validateFunctionReference(e.reward,r))||(v=!0),l))if(l.errorReported)v=!0;else if(l.signatures[0].returnType.category!==g.TypeCategory.Number&&(r.onError("Output of reward function must be a number",e.reward.functionRef),v=!0),l.signatures[0].parameters.length<1)r.onError("Reward function should accept at least one parameter",e.reward.functionRef),v=!0;else{if(C.forEach((function(t){var n=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(t.stateType,l.signatures[0].parameters[0].type,n)||(r.onError("First parameter to reward function should match source state type"+n.getString(),e.reward.functionRef),v=!0)})),l.signatures[0].parameters.length>1){var x=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(t,l.signatures[0].parameters[1].type,x)||(r.onError("Second parameter to reward function should match action type of concept"+x.getString(),e.reward.functionRef),v=!0)}l.signatures[0].parameters.length>2&&(r.onError("Reward function should accept only one or two input parameters",e.reward.functionRef),v=!0)}e.terminal&&((d=this._validateFunctionReference(e.terminal,r))||(v=!0),d)&&(d.errorReported?v=!0:(d.signatures[0].returnType.category!==g.TypeCategory.Number&&(r.onError("Output of terminal function must be a number",e.terminal.functionRef),v=!0),d.signatures[0].parameters.length<1?(r.onError("Terminal function should accept one or two input parameters",e.terminal.functionRef),v=!0):(C.forEach((function(t){var n=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(t.stateType,d.signatures[0].parameters[0].type,n)||(r.onError("First parameter to terminal function should match source state type"+n.getString(),e.terminal.functionRef),v=!0)})),d.signatures[0].parameters.length>1&&(x=new o.DiagnosticAddendum,y.TypeChecker.isTypeAssignable(t,d.signatures[0].parameters[1].type,x)||(r.onError("Second parameter to terminal function should match action type of concept"+x.getString(),e.terminal.functionRef),v=!0)),d.signatures[0].parameters.length>2&&(r.onError("Terminal function should accept one or two input parameters",e.terminal.functionRef),v=!0)))),e.goal&&((m=this._validateGoal(e.goal,C,r))&&!m.errorReported||(v=!0));var N,R=new Map,E=e.lessons.map((function(t){var n=T._validateLesson(t,C,N,!!e.goal,_,r);return n.errorReported&&(v=!0),R.has(n.name)&&(r.onError("Lesson must have unique name",t.name),v=!0),R.set(n.name,n),N=n.scenario,n}));return e.goal||e.reward||r.onError("Curriculum must include either a reward or goal statement",e.curriculumToken.range),{comments:e.comments,errorReported:v,algorithm:a,training:s,experiment:i,sources:C,reward:l,state:h,action:f,goal:m,terminal:d,lessons:E,declarationRange:e.range,node:e}},e.prototype._validateLesson=function(e,t,n,r,i,a){var s,u,l,d=!1;e.scenario?(s=y.TypeChecker.getTypeOfTypeNode(e.scenario.scenarioType,a),t.forEach((function(t){if(t.configType){var r=y.TypeChecker.resolveScenarioType(e.scenario.scenarioType,s,t.configType,a);if(r.errorReported?d=!0:y.TypeChecker.doesTypeContainString(r,!0)&&(a.onError("Scenario type cannot include unconstrained string; allowed string values must be enumerated",e.scenario.scenarioType),d=!0),d||(s=r),n&&!n.errorReported){var i=new o.DiagnosticAddendum;y.TypeChecker.resolveScenarioType(void 0,n,s,a,i).errorReported&&a.onWarning("The scenario for this lesson is narrower than previous lesson's scenario. This could result in unlearning."+i.getString(),e.scenario)}}else a.onError("Scenario is not allowed because specified source has no config type defined",e.scenario),d=!0}))):n&&a.onWarning("A scenario was specified for the previous lesson but was not specified in this lesson. This could result in unlearning.",e),e.experiment&&(u=this._validateExperiment(e.experiment,a)).errorReported&&(d=!0),e.training&&(l=this._validateTraining(e.training,r,!0,i,a)).errorReported&&(d=!0);var m={comments:e.comments,node:e,errorReported:d,name:e.name.text,scenario:s,training:l,experiment:u,declarationRange:e.range,nameRange:e.name.range};return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Lesson,resolvedObject:m}),m},e.prototype._validateImport=function(e,t){var n=i.ExpressionEvaluator.evaluateConstantExpression(e.expression,t),r=n.errorReported;return n.category!==g.TypeCategory.Struct?(t.onError("Import expression must evaluate to a struct type",e.expression),r=!0):a.ImportValidator.validateImportValue(e.expression,n,t)||(r=!0),{comments:e.comments,errorReported:r,value:n,declarationRange:e.range,node:e}},e.prototype._validateAlgorithm=function(e,t,n,o){var a=i.ExpressionEvaluator.evaluateConstantExpression(e.expression,o),s=a.errorReported;if(a.category!==g.TypeCategory.Struct)o.onError("Algorithm expression must evaluate to a struct type",e.expression),s=!0;else{if(e.expression.type===u.ParseNodeType.StructLiteral){var l=r.AlgorithmValidator.getExpectedType(r.AlgorithmValidator.getAlgorithmFieldValue(a));l&&c.setStructLiteralDataForNode(e.expression,{expectedType:l})}r.AlgorithmValidator.validateAlgorithmValue(e.expression,a,t,n,o)||(s=!0)}return{comments:e.comments,errorReported:s,value:a,declarationRange:e.range,node:e}},e.prototype._validateTraining=function(e,t,n,r,o){var a,s=i.ExpressionEvaluator.evaluateConstantExpression(e.expression,o),l=s.errorReported;return s.category!==g.TypeCategory.Struct?(o.onError("Training expression must evaluate to a struct type",e.expression),l=!0,a={category:g.TypeCategory.Struct,value:new Map,errorReported:!0}):(a=s,e.expression.type===u.ParseNodeType.StructLiteral&&c.setStructLiteralDataForNode(e.expression,{expectedType:m.TrainingValidator.getExpectedType(t,n)}),m.TrainingValidator.validateTrainingValue(e.expression,s,t,n,r,o)||(l=!0)),{comments:e.comments,errorReported:l,value:a,declarationRange:e.range,node:e}},e.prototype._validateGoal=function(e,t,n){var r=this,i=!1,a=n.pushScope(c.getScopeForNode(e));c.setScopeDataForNode(e,{symbolTable:a});var s=e.inputs.map((function(t){var r=y.TypeChecker.getTypeOfTypeNode(t.paramType,n);if(r.errorReported&&(i=!0),!i){var o={category:h.FunctionStatementCategory.VarDeclaration,name:t.name.text,comments:[],errorReported:r.errorReported,type:r,codeLine:e.range.start.line,codeColumn:e.range.start.character,declarationRange:t.range,nameRange:t.name.range,node:t},s={category:p.SymbolCategory.Param,name:t.name.text,node:t,resolvedObject:o,referenced:!1};a.addSymbol(s),a.markSymbolAssigned(t.name.text,o),c.setIdentifierDataForNode(t.name,{symbolCategory:p.SymbolCategory.Param,resolvedObject:o})}return{name:t.name.text,type:r}}));s.length<1?(n.onError("Goal should accept one parameter",e.goalToken.range),i=!0):(s.length>1&&(n.onError("Goal should accept only one parameter",e.inputs[1]),i=!0),t.forEach((function(t){var r=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(t.stateType,s[0].type,r)||(n.onError("First parameter to goal should match source state type"+r.getString(),e.inputs[0]),i=!0)})));var u={errorReported:i,comments:e.comments,parameters:s,subgoals:[],declarationRange:e.range,node:e},l=new Map;return e.subgoals.forEach((function(e,t){l.has(e.name.text)?n.onError("Subgoal names must be unique within a goal declaration",e.name):l.set(e.name.text,e);var o=r._validateGoalExpression(e,n);if(o){if(o.errorReported)u.errorReported=!0;else{var i=!1,a=o.valueExpression.type,s=1;if(a.category===g.TypeCategory.Number?s=1:a.category===g.TypeCategory.Array&&a.baseType.category===g.TypeCategory.Number?s=a.length:(n.onError("Value must be a number or array of numbers",e.valueExpression),i=!0),!i&&o.targetExpression){var m=o.targetExpression.type;if(m.category!==g.TypeCategory.Complex||"GoalTargetRegion"!==m.internalClass)n.onError("Expected goal target; call Goal.Range, Goal.RangeAbove, Goal.RangeBelow or Goal.Sphere to create a goal target",e.targetExpression),i=!0;else{var y=m.typeArguments,h=y[0].enumeratedConstraint.items[0].value,f=!!y[1].enumeratedConstraint.items[0].value,T=!!y[2].enumeratedConstraint.items[0].value;h!==s?(n.onError("Dimensions of value and target region do not match\nValue dimension is "+s+" and target dimension is "+h,e.valueExpression),i=!0):o.operation!==d.Token.Maximize&&o.operation!==d.Token.Minimize||(1!==h&&(n.onError("Target region for minimize and maximize must be one-dimensional",e.targetExpression),i=!0),o.operation===d.Token.Maximize&&f&&(n.onError("Target range for maximize must have bounded minimum; use Goal.RangeAbove instead of Goal.RangeBelow",e.targetExpression),i=!0),o.operation===d.Token.Minimize&&T&&(n.onError("Target range for minimize must have bounded maximum; use Goal.RangeBelow instead of Goal.RangeAbove",e.targetExpression),i=!0))}}i&&(u.errorReported=!0)}u.subgoals.push(o)}else u.errorReported=!0;c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Subgoal,resolvedObject:u})})),a.getDefinedSymbols().forEach((function(e){r.conditionallyReportUnreferencedSymbol(e,n)})),n.popScope(),u},e.prototype._validateGoalExpression=function(e,t){var n,r,o=!1,a=this._validateExpression(e.valueExpression,t,!1);if(a.errorReported&&(o=!0),e.targetExpression&&(n=this._validateExpression(e.targetExpression,t,!1)).errorReported&&(o=!0),e.withinExpression){var s=i.ExpressionEvaluator.evaluateConstantExpression(e.withinExpression,t);s.errorReported?o=!0:s.category!==g.TypeCategory.Number||!Number.isInteger(s.value)||s.value<=0?(t.onError("Expected positive integer value representing iteration count",e.withinExpression),o=!0):r=s.value}return{errorReported:o,name:e.name.text,comments:[],operation:e.operation,valueExpression:a,targetExpression:n,withinValue:r,declarationRange:e.range,nameRange:e.name.range,node:e}},e.prototype._validateFunction=function(e,t){var n,r=this,o=!1;e.outputType&&(n=y.TypeChecker.getTypeOfTypeNode(e.outputType,t),o=n.errorReported,y.TypeChecker.doesTypeContainString(n)&&(t.onError("Function return type cannot include strings",e.outputType),o=!0));var i=e.inputs.map((function(e){var n=y.TypeChecker.getTypeOfTypeNode(e.paramType,t);return n.errorReported?o=!0:y.TypeChecker.doesTypeContainString(n)&&(t.onError("Function parameter type cannot include strings",e.paramType),o=!0),{name:e.name.text,type:n}})),a=t.pushScope(c.getScopeForNode(e));c.setScopeDataForNode(e,{symbolTable:a}),e.inputs.forEach((function(n,r){var s=a.lookUpSymbol(n.name.text,!1,!0);if(s)s.scope!==a?t.onError("'"+n.name.text+"' is already defined in an outer scope; reusing the same name is not allowed",n.name):t.onError("'"+n.name.text+"' is a duplicate symbol",n.name),o=!0;else{var u={category:h.FunctionStatementCategory.VarDeclaration,name:n.name.text,comments:[],errorReported:i[r].type.errorReported,type:i[r].type,codeLine:e.range.start.line,codeColumn:e.range.start.character,declarationRange:e.range,nameRange:e.name.range,node:n},l={category:p.SymbolCategory.Param,name:n.name.text,node:n,resolvedObject:u,referenced:!1};a.addSymbol(l),a.markSymbolAssigned(n.name.text,u),c.setIdentifierDataForNode(n.name,{symbolCategory:p.SymbolCategory.Param,resolvedObject:u})}}));var s,u=this._validateFunctionBlock(e.block,t,n);t.popScope(),u.errorReported&&(o=!0),void 0!==u.returnType&&u.alwaysReturns||o||(t.onError("Function must always return a value",e.name.range.isEmpty()?e.functionToken.range:e.name),o=!0),s=n||(u.returnType?u.returnType:y.TypeChecker.getDummyType());var l={errorReported:o,comments:e.comments,signatures:[{parameters:i,returnType:s}],functionBlock:u,declarationRange:e.range,nameRange:e.name.range,node:e};return e.name.text&&(l.name=e.name.text),c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Function,resolvedObject:l}),a.getDefinedSymbols().forEach((function(e){r.conditionallyReportUnreferencedSymbol(e,t)})),l},e.prototype._validateFunctionBlock=function(e,t,n,r){var o=this,i=[],a=!1,s=!1,c=!1,l=n||r;return e.statements.forEach((function(e){var r;switch(e.type){case u.ParseNodeType.Return:r=o._validateReturnStatement(e,t,n,l);break;case u.ParseNodeType.Var:r=o._validateVarDeclaration(e,t);break;case u.ParseNodeType.If:r=o._validateIfElseStatement(e,t,n,l);break;case u.ParseNodeType.VarAssignment:r=o._validateVarAssignment(e,t);break;default:throw Error("Unexpected statement type in _validateFunctionBlock")}if(r){if(a&&!c&&(t.onWarning("Execution will never reach this statement",e),c=!0),r.errorReported&&(s=!0),r.alwaysReturns&&(a=!0),r.returnType)if(l){if(!n){var p=y.TypeChecker.getCommonType(l,r.returnType);p&&(l=p)}}else l=r.returnType;i.push(r)}})),{errorReported:s,comments:[],alwaysReturns:a,returnType:l,localSymbols:t.symbolTable,statements:i,node:e}},e.prototype._validateReturnStatement=function(e,t,n,r){var i=this._validateExpression(e.value,t,!1,n,!0),a=i.errorReported,s=!1;if(n){var c=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(i.type,n,c)||(y.TypeChecker.isTypeCastable(i.type,n,new o.DiagnosticAddendum)?(a||t.onWarning("Return value will be cast to return type. Rounding may occur.",e.value),s=!0):a||(t.onError("Return type does not match declared return type for function"+c.getString(),e.value),a=!0))}else r&&(a||y.TypeChecker.getCommonType(i.type,r)||(t.onError("Return type does not match type of previous return statement within function ("+y.TypeChecker.printType(r)+")",e.value),a=!0));var u={category:h.FunctionStatementCategory.Return,errorReported:i.errorReported,comments:[],value:i,alwaysReturns:!0,returnType:i.type,codeLine:e.range.start.line,codeColumn:e.range.start.character,node:e};return s&&(u.castToType=n),u},e.prototype._validateVarDeclaration=function(e,t){var n,r,i=!1,a=!1;if(e.varType&&(n=y.TypeChecker.getTypeOfTypeNode(e.varType,t)).errorReported&&(i=!0),e.value)if((r=this._validateExpression(e.value,t,!1,n,!0)).errorReported&&(i=!0),n){if(!n.errorReported){var s=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(r.type,n,s)||(y.TypeChecker.isTypeCastable(r.type,n,new o.DiagnosticAddendum)?(t.onWarning("Value will be cast to variable type. Rounding may occur.",e.value),a=!0):(t.onError("Value is not assignable to variable '"+e.name.text+"'"+s.getString(),e.value),i=!0))}}else(n=r.type).category===g.TypeCategory.Number?n=g.getDefaultNumberType():n.category===g.TypeCategory.String&&(n=g.getDefaultStringType());n||(n=y.TypeChecker.getDummyType(),e.name.range.isEmpty()||t.onError("Var must have an explicit type or an initializer",e.name),i=!0);var u={category:h.FunctionStatementCategory.VarDeclaration,errorReported:i,comments:e.comments,name:e.name.text,type:n,initialValue:r,codeLine:e.range.start.line,codeColumn:e.range.start.character,declarationRange:e.range,nameRange:e.name.range,node:e};a&&r&&(u.castFromType=r.type);var l=t.lookUpSymbol(e.name.text);if(l.symbol)e.name.range.isEmpty()||(l.scope!==t.symbolTable?t.onError("'"+e.name.text+"' is already defined in an outer scope; reusing the same name is not allowed",e.name):t.onError("'"+e.name.text+"' is already defined in this scope",e.name)),i=!0;else{var d={name:e.name.text,category:p.SymbolCategory.Var,node:e,resolvedObject:u,referenced:!1};t.symbolTable.addSymbol(d),r&&t.symbolTable.markSymbolAssigned(e.name.text,u)}return c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Var,resolvedObject:u}),u},e.prototype._validateIfElseStatement=function(e,t,n,r){var o=n,i=!1,a=this._validateExpression(e.condition,t,!1,g.getDefaultNumberType());a.errorReported&&(i=!0);var s=t.pushScope(c.getScopeForNode(e));c.setScopeDataForNode(e.ifBlock,{symbolTable:s});var u,p,d=this._validateFunctionBlock(e.ifBlock,t,n);if(t.popScope(),d.errorReported&&(i=!0),o||(o=d.returnType),e.elseBlock){var m=t.pushScope(c.getScopeForNode(e));c.setScopeDataForNode(e.elseBlock,{symbolTable:m}),u=this._validateFunctionBlock(e.elseBlock,t,n,r||o),t.popScope(),u.errorReported&&(i=!0),o||(o=u.returnType)}e.elseIfStatement&&((p=this._validateIfElseStatement(e.elseIfStatement,t,n,r||o)).errorReported&&(i=!0),o||(o=p.returnType),u={comments:[],errorReported:p.errorReported,alwaysReturns:p.alwaysReturns,returnType:p.returnType,localSymbols:new l.SymbolTable,statements:[p]});var y=!1;d.alwaysReturns&&(u&&u.alwaysReturns||p&&p.alwaysReturns)&&(y=!0);var f=this._getAssignedVarsForIfElse(d,u);return f.forEach((function(e,n){t.symbolTable.markSymbolAssigned(n,f.get(n))})),{category:h.FunctionStatementCategory.IfElse,errorReported:i,comments:[],condition:a,ifBlock:d,elseBlock:u,alwaysReturns:y,returnType:o,codeLine:e.range.start.line,codeColumn:e.range.start.character,node:e}},e.prototype._getAssignedVarsForIfElse=function(e,t){var n,r=new Map,o=!1;if(t&&(n=t.localSymbols.getAssignedSymbols(),o=!!t.alwaysReturns),o)r=e.localSymbols.getAssignedSymbols();else if(n)if(e.alwaysReturns)r=n;else{var i=e.localSymbols.getAssignedSymbols();n.forEach((function(e,t){var o=n.get(t);i.get(t)===o&&void 0!==o&&r.set(t,o)}))}return r},e.prototype._validateVarAssignment=function(e,t){var n,r=!1,i=!1,a=t.lookUpSymbol(e.name.text).symbol;!a||a.category!==p.SymbolCategory.Var&&a.category!==p.SymbolCategory.Param?(t.onError("'"+e.name.text+"' is not a known variable",e.name),r=!0):(n=a.resolvedObject)&&n.errorReported&&(r=!0);var s=this._validateExpression(e.value,t,!1,n?n.type:void 0);if(s.errorReported&&(r=!0),n&&!n.errorReported){var u=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(s.type,n.type,u)||(y.TypeChecker.isTypeCastable(s.type,n.type,new o.DiagnosticAddendum)?(t.onWarning("Value will be cast to var type. Rounding may occur.",e.value),i=!0):(t.onError("Expression is incorrect type for variable '"+e.name.text+"'"+u.getString(),e.value),r=!0))}n&&t.symbolTable.markSymbolAssigned(e.name.text,n);var l={category:h.FunctionStatementCategory.VarAssignment,errorReported:r,comments:[],name:e.name.text,value:s,codeLine:e.range.start.line,type:s.type,codeColumn:e.range.start.character,node:e};return i&&(l.castToType=n.type),c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Var,resolvedObject:n}),l},e.prototype._validateExpression=function(e,t,n,r,o){void 0===o&&(o=!1);var i=y.TypeChecker.getTypeOfExpression(e,t,n,r,o);return{errorReported:i.errorReported,comments:[],type:i,node:e,codeLine:e.range.start.line,codeColumn:e.range.start.character}},e.prototype._validateSource=function(e,t){var n=!1,r=[];[e.actionParam,e.configParam].forEach((function(n){if(n){var o=y.TypeChecker.getTypeOfTypeNode(n.paramType,t);r.push(o);var i={category:h.FunctionStatementCategory.VarDeclaration,name:n.name.text,errorReported:o.errorReported,comments:[],type:o,codeLine:e.range.start.line,codeColumn:e.range.start.character,node:n};c.setIdentifierDataForNode(n.name,{symbolCategory:p.SymbolCategory.Param,resolvedObject:i})}}));var o=r[0];o.errorReported&&(n=!0),n||y.TypeChecker.isUsageAllowedForType(o,g.ComplexTypeUsage.SourceAction)||t.onError("Source action type cannot contain complex types",e.actionParam.paramType),!n&&y.TypeChecker.doesTypeContainString(o)&&t.onError("Source action type cannot contain strings",e.actionParam.paramType);var i,a=y.TypeChecker.getTypeOfTypeNode(e.stateType,t);return a.errorReported&&(n=!0),n||y.TypeChecker.isUsageAllowedForType(a,g.ComplexTypeUsage.SourceState)||t.onError("Source state type cannot contain complex types",e.stateType),!n&&y.TypeChecker.doesTypeContainString(a)&&t.onError("Source state type cannot contain strings",e.stateType),e.configParam&&((i=r[1]).errorReported&&(n=!0),n||y.TypeChecker.isUsageAllowedForType(i,g.ComplexTypeUsage.SourceConfig)||t.onError("Source config type cannot contain complex types",e.configParam.paramType)),{stateType:a,actionType:o,configType:i,comments:e.comments,errorReported:n}},e.prototype._validateSimulator=function(e,t){var n,r=this._validateSource(e,t),o=r.errorReported;if(e.objectReference){var a=i.ExpressionEvaluator.evaluateConstantExpression(e.objectReference.expression,t);a.errorReported?o=!0:a.category!==g.TypeCategory.String?(t.onError("Package name must be a string value",e.objectReference.expression),o=!0):n=a.value}var s={errorReported:o,comments:e.comments,actionType:r.actionType,stateType:r.stateType,configType:r.configType,package:n,declarationRange:e.range,nameRange:e.name.text?e.name.range:void 0,node:e};return e.name&&(s.name=e.name.text),c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Simulator,resolvedObject:s}),s},e.prototype._validateData=function(e,t){var n,r=this._validateSource(e,t),o=r.errorReported;if(t.compilerOptions.enableDataSources||t.onError("Data declarations are not supported",e.name),e.objectReference){var a=i.ExpressionEvaluator.evaluateConstantExpression(e.objectReference.expression,t);a.errorReported?o=!0:a.category!==g.TypeCategory.String?(t.onError("Dataset name must be a string value",e.objectReference.expression),o=!0):n=a.value}var s={errorReported:o,comments:e.comments,actionType:r.actionType,stateType:r.stateType,configType:r.configType,dataset:n,declarationRange:e.range,nameRange:e.name.text?e.name.range:void 0,node:e};return e.name&&(s.name=e.name.text),c.setIdentifierDataForNode(e.name,{symbolCategory:p.SymbolCategory.Data,resolvedObject:s}),s},e.prototype._validateExperiment=function(e,t){var n=i.ExpressionEvaluator.evaluateConstantExpression(e.expression,t),r=n.errorReported;if(n.category!==g.TypeCategory.Struct)r||(t.onError("Experiment value must be a constant struct",e.expression),r=!0);else{var o,a=n;a.value.has("algorithm")&&t.onWarning("Specifying algorithm with the experiment statement is deprecated; use an algorithm statement instead",e),a.value.forEach((function(e,t){e.category!==g.TypeCategory.String&&void 0===o&&(o=t)})),o&&(t.onError("'"+o+"' is not a string constant",e.expression),r=!0)}return{errorReported:r,comments:e.comments,value:n,declarationRange:e.range,node:e}},e.prototype._validateGraphInput=function(e,t){var n=y.TypeChecker.getTypeOfTypeNode(e.inputType,t),r=n.errorReported;return n.errorReported||!y.TypeChecker.doesTypeContainString(n)||r||(t.onError("Graph input type cannot contain strings",e.inputType),r=!0),n.errorReported||y.TypeChecker.isUsageAllowedForType(n,g.ComplexTypeUsage.GraphInput)||(t.onError("Type not allowed for type graph input",e.inputType),r=!0),!n.errorReported&&y.TypeChecker.getDimensionalityOfType(n)>f&&(t.onError("Graph input type cannot contain more than 1024 dimensions",e.inputType),r=!0),{errorReported:r,comments:[],inputType:n,node:e}},e.prototype._validateGraphOutput=function(e,t){var n,r,i,a,s=!1;if(e.output)if(e.output.outputSource.type===u.ParseNodeType.Identifier){var l=t.lookUpSymbol(e.output.outputSource.text);if(this._saveIdentifierSymbolCategory(e.output.outputSource,l),l.isCircular)t.onError("Circular dependency not allowed",e.output.outputSource),s=!0;else{var d=l.symbol;d&&d.category===p.SymbolCategory.Concept?(a=(i=t.resolveSymbol(d)).outputType,c.setIdentifierDataForNode(e.output.outputSource,{symbolCategory:p.SymbolCategory.Concept,resolvedObject:i})):(t.onError("Output must refer to a defined concept",e.output.outputSource),s=!0)}}else a=e.output.outputSource.type===u.ParseNodeType.Concept?(i=this._validateConcept(e.output.outputSource,t)).outputType:this._getGraphInputType(t);else 1===e.concepts.length?(l=t.lookUpSymbol(e.concepts[0].name.text),a=(i=t.resolveSymbol(l.symbol)).outputType):e.concepts.length>0?(t.onError("Output concept for graph cannot be inferred; use 'output' keyword to designate output concept",e.graphToken.range),s=!0):(t.onError("At least one concept must be defined within the graph",e.graphToken.range),s=!0);if(e.outputType){var m=y.TypeChecker.getTypeOfTypeNode(e.outputType,t);if(m.errorReported)s=!0;else if(a&&!a.errorReported){var g=new o.DiagnosticAddendum;y.TypeChecker.isTypeAssignable(m,a,g)||(t.onError("Output type is incompatible with output source"+g.getString(),e.outputType),s=!0)}}return a?(!a.errorReported&&y.TypeChecker.doesTypeContainString(a)&&(t.onError("Graph output type cannot contain strings",(null===(n=e.output)||void 0===n?void 0:n.outputSource)||e.graphToken.range),s=!0),!a.errorReported&&y.TypeChecker.getDimensionalityOfType(a)>f&&(t.onError("Graph output type cannot contain more than 1024 dimensions",(null===(r=e.output)||void 0===r?void 0:r.outputSource)||e.graphToken.range),s=!0)):(a=y.TypeChecker.getDummyType(),s=!0),{errorReported:s,comments:[],outputType:a,outputConcept:i}},e.prototype._getGraphInputType=function(e){var t=e.lookUpSymbol("graph_input",!0);return t.symbol?e.resolveSymbol(t.symbol).inputType:y.TypeChecker.getDummyType()},e.prototype._validateFunctionReference=function(e,t){if(e.functionRef.type!==u.ParseNodeType.Identifier)return this._validateFunction(e.functionRef,t);var n=t.lookUpSymbol(e.functionRef.text);if(this._saveIdentifierSymbolCategory(e.functionRef,n),n.isCircular)t.onError("Circular dependency not allowed",e.functionRef);else{var r=n.symbol;if(r){if(r.category!==p.SymbolCategory.Function)return void t.onError("Expected function",e.functionRef);var o=t.resolveSymbol(r);return c.setIdentifierDataForNode(e.functionRef,{symbolCategory:p.SymbolCategory.Function,resolvedObject:o}),o}e.functionRef.text&&t.onError("Unknown identifier '"+e.functionRef.text+"'",e.functionRef)}},e.prototype._saveIdentifierSymbolCategory=function(e,t){t.symbol&&c.setIdentifierDataForNode(e,{symbolCategory:t.symbol.category,resolvedObject:t.symbol.resolvedObject})},e.prototype._getNameNodeForSymbol=function(e){switch(e.type){case u.ParseNodeType.Const:case u.ParseNodeType.Var:case u.ParseNodeType.Type:case u.ParseNodeType.Concept:case u.ParseNodeType.Function:case u.ParseNodeType.FunctionInput:case u.ParseNodeType.Simulator:case u.ParseNodeType.Data:case u.ParseNodeType.Using:return e.name}},e}();t.SymbolResolver=T},9371:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolTable=void 0;var n=function(){function e(e){this._userSymbols=new Map,this._reservedSymbols=new Map,this._assignedSymbols=new Map,this._parent=e}return e.prototype.getParent=function(){return this._parent},e.prototype.addSymbol=function(e,t){void 0===t&&(t=!1),(t?this._reservedSymbols:this._userSymbols).set(e.name,e)},e.prototype.lookUpSymbol=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var r=t?this._reservedSymbols:this._userSymbols;return r.has(e)?{symbol:r.get(e),scope:this}:n&&this._parent?this._parent.lookUpSymbol(e):void 0},e.prototype.getSymbolsByCategory=function(e,t){void 0===t&&(t=!1);var n=t?this._reservedSymbols:this._userSymbols,r=[];return n.forEach((function(t,n){t.category===e&&r.push(t)})),r},e.prototype.markSymbolAssigned=function(e,t){this._assignedSymbols.set(e,t)},e.prototype.isSymbolAssigned=function(e,t,n){return void 0===n&&(n=!0),this._assignedSymbols.get(e)===t||!(!this._parent||!n)&&this._parent.isSymbolAssigned(e,t)},e.prototype.getAssignedSymbols=function(){return this._assignedSymbols},e.prototype.getDefinedSymbols=function(){return this._userSymbols},e}();t.SymbolTable=n},9948:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResolveSymbolContext=t.SymbolCategory=void 0;var r,o=n(9371);(r=t.SymbolCategory||(t.SymbolCategory={})).Namespace="namespace",r.Const="const",r.Param="parameter",r.Var="var",r.Field="field",r.Lesson="lesson",r.Type="type",r.Function="function",r.Subgoal="subgoal",r.Concept="concept",r.Simulator="simulator",r.Data="data",r.Experiment="experiment",r.GraphInput="graph-input",r.GraphOutput="graph-output";var i=function(){function e(e,t,n,r,o){this.onError=e,this.onWarning=t,this.onUnreferencedCode=n,this.compilerOptions=r,this.symbolTable=o,this._dependencyList=[],this._scopeStack=[]}return e.prototype.setResolver=function(e){this._onResolveSymbol=e},e.prototype.createNewContext=function(t){return new e(this.onError,this.onWarning,this.onUnreferencedCode,this.compilerOptions,t)},e.prototype.silenceDiagnostics=function(){return new e((function(e,t){}),(function(e,t){}),(function(e,t){}),this.compilerOptions,this.symbolTable)},e.prototype.pushScope=function(e){return this._scopeStack.push(this.symbolTable),this.symbolTable=new o.SymbolTable(e),this.symbolTable},e.prototype.popScope=function(){var e=this._scopeStack.pop();if(void 0===e)throw Error("Last symbol table in context was popped");this.symbolTable=e},e.prototype.lookUpSymbol=function(e,t){void 0===t&&(t=!1);var n=this.symbolTable.lookUpSymbol(e,t);return{isCircular:this._isSymbolDependent(e),symbol:null==n?void 0:n.symbol,scope:null==n?void 0:n.scope}},e.prototype.resolveSymbol=function(e,t){if(void 0===t&&(t=!0),!e.resolvedObject){if(!this._onResolveSymbol)throw Error("Missing symbol resolver for symbol context");this._pushDependentSymbol(e),e.resolvedObject=this._onResolveSymbol(e),this._popDependentSymbol()}return e.resolvedObject&&t&&(e.referenced=!0),e.resolvedObject},e.prototype._isSymbolDependent=function(e){return void 0!==this._dependencyList.find((function(t){return t.name===e}))},e.prototype._pushDependentSymbol=function(e){this._dependencyList.push(e)},e.prototype._popDependentSymbol=function(){this._dependencyList.pop()},e}();t.ResolveSymbolContext=i},5561:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMonarchSyntax=void 0;var r=n(9554).Tokenizer.getKeywords(0);t.getMonarchSyntax=function(){return{defaultToken:"",tokenPostfix:".python",keywords:r,brackets:[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.bracket"},{open:"(",close:")",token:"delimiter.parenthesis"}],tokenizer:{root:[{include:"@whitespace"},{include:"@operators"},{include:"@numbers"},{include:"@strings"},[/[{}[\]()]/,"@brackets"],[/[a-zA-Z0-9_]\w*/,{cases:{"@keywords":"keyword","@default":"identifier"}}],[/`.+`/,"identifier"]],whitespace:[[/\s+/,"white"],[/(^#.*$)/,"comment"]],endDblDocString:[[/\\"/,"string"],[/.*"""/,"string","@popall"],[/.*$/,"string"]],operators:[[/\.\./,"operator"]],numbers:[[/-?0x([abcdef]|[ABCDEF]|\d)+[lL]?/,"number.hex"],[/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/,"number"]],strings:[[/"$/,"string.escape","@popall"],[/"/,"string.escape","@dblStringBody"]],dblStringBody:[[/[^\\"]+$/,"string","@popall"],[/[^\\"]+/,"string"],[/\\./,"string"],[/"/,"string.escape","@popall"],[/\\$/,"string"]]}}}},2068:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextWriter=void 0;var n=["","    "],r=function(){function e(e){this._output="",this._indent=0,this._lineStart=!0,this._lineCount=0,this._linePos=0,this._newLine="\n",e&&(this._newLine=e)}return e.prototype.write=function(e){e&&e.length&&(this._lineStart&&(this._output+=this._getIndentString(this._indent),this._lineStart=!1),this._output+=e)},e.prototype.writeFormatted=function(e){if(e&&e.length){for(var t=e.replace(/\t/g,this._getIndentString(1)).split("\n"),n=0;n<t.length-1;n++)this.writeLine(t[n]);this.write(t[t.length-1])}},e.prototype.writeLine=function(e){e&&this.write(e),this._lineStart?(this._output+=this._newLine,this._lineCount++):(this._output+=this._newLine,this._lineCount++,this._linePos=this._output.length,this._lineStart=!0)},e.prototype.increaseIndent=function(){this._indent++},e.prototype.decreaseIndent=function(){this._indent--},e.prototype.getIndent=function(){return this._indent},e.prototype.getTextPos=function(){return this._output.length},e.prototype.getLineCount=function(){return this._lineCount+1},e.prototype.getColumn=function(){return this._lineStart?this._indent*this._getIndentSize()+1:this._output.length-this._linePos+1},e.prototype.getText=function(){return this._output},e.prototype.isAtStartOfLine=function(){return this._lineStart},e.prototype._getIndentSize=function(){return n[1].length},e.prototype._getIndentString=function(e){return void 0===n[e]&&(n[e]=this._getIndentString(e-1)+n[1]),n[e]},e}();t.TextWriter=r},9554:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=t.TokenProvider=void 0;var r=n(8167),o=n(4471),i=n(4393),a={action:{token:i.Token.Action,inklingVersion:0},algorithm:{token:i.Token.Algorithm,inklingVersion:0},and:{token:i.Token.And,inklingVersion:0},avoid:{token:i.Token.Avoid,inklingVersion:0},concept:{token:i.Token.Concept,inklingVersion:0},const:{token:i.Token.Const,inklingVersion:0},constraint:{token:i.Token.Constraint,inklingVersion:0},curriculum:{token:i.Token.Curriculum,inklingVersion:0},else:{token:i.Token.Else,inklingVersion:0},experiment:{token:i.Token.Experiment,inklingVersion:0},data:{token:i.Token.Data,inklingVersion:0},dataset:{token:i.Token.Dataset,inklingVersion:0},drive:{token:i.Token.Drive,inklingVersion:0},function:{token:i.Token.Function,inklingVersion:0},goal:{token:i.Token.Goal,inklingVersion:0},graph:{token:i.Token.Graph,inklingVersion:0},if:{token:i.Token.If,inklingVersion:0},import:{token:i.Token.Import,inklingVersion:0},in:{token:i.Token.In,inklingVersion:0},inkling:{token:i.Token.Inkling,inklingVersion:0},input:{token:i.Token.Input,inklingVersion:0},lesson:{token:i.Token.Lesson,inklingVersion:0},mask:{token:i.Token.Mask,inklingVersion:0},maximize:{token:i.Token.Maximize,inklingVersion:0},minimize:{token:i.Token.Minimize,inklingVersion:0},not:{token:i.Token.Not,inklingVersion:0},or:{token:i.Token.Or,inklingVersion:0},output:{token:i.Token.Output,inklingVersion:0},package:{token:i.Token.Package,inklingVersion:0},programmed:{token:i.Token.Programmed,inklingVersion:0},reach:{token:i.Token.Reach,inklingVersion:0},return:{token:i.Token.Return,inklingVersion:0},reward:{token:i.Token.Reward,inklingVersion:0},scenario:{token:i.Token.Scenario,inklingVersion:0},select:{token:i.Token.Select,inklingVersion:0},simulator:{token:i.Token.Simulator,inklingVersion:0},source:{token:i.Token.Source,inklingVersion:0},state:{token:i.Token.State,inklingVersion:0},step:{token:i.Token.Step,inklingVersion:0},terminal:{token:i.Token.Terminal,inklingVersion:0},training:{token:i.Token.Training,inklingVersion:0},type:{token:i.Token.Type,inklingVersion:0},using:{token:i.Token.Using,inklingVersion:0},var:{token:i.Token.Var,inklingVersion:0},within:{token:i.Token.Within,inklingVersion:0},number:{token:i.Token.Number,inklingVersion:0},string:{token:i.Token.String,inklingVersion:0},false:{token:i.Token.False,inklingVersion:0},true:{token:i.Token.True,inklingVersion:0}},s=function(){function e(e){this._nextTokenIndex=0,this._accumulatedComments=[],this._rejectedTokens=[],this._tokens=e}return e.prototype.getToken=function(){if(this._rejectedTokens.length>0)return this._rejectedTokens.pop();for(;;){var e=this._nextTokenIndex;e<this._tokens.length-1&&this._nextTokenIndex++;var t=this._tokens[e];if(t.token!==i.Token.Comment)return t;var n=t;n.commentInfo.fullLine&&this._accumulatedComments.push(n.commentInfo)}},e.prototype.rejectToken=function(e){this._rejectedTokens.push(e)},e.prototype.getAccumulatedFullLineComments=function(){var e=this._accumulatedComments;return this._accumulatedComments=[],e},e.prototype.getEndOfLineCommentForLine=function(e){for(var t=this._nextTokenIndex;t>0&&!((n=this._tokens[t]).range.start.line<e);)t--;for(;t<this._tokens.length;){var n;if((n=this._tokens[t]).range.start.line>e)break;if(n.range.start.line===e&&n.token===i.Token.Comment){var r=n;if(!r.commentInfo.fullLine)return r.commentInfo;break}t++}},e.prototype.getTokenAtOrBeforePosition=function(e){for(var t=0,n=this._tokens.length-1;t<n;){var r=Math.floor(t+(n-t)/2),o=this._tokens[r];if(o.range.isPositionWithin(e))return o;if(o.range.end.isBefore(e)){if(t===r)return o;t=r}else n=r}if(this._tokens[t].range.start.isBeforeOrSame(e))return this._tokens[t]},e}();t.TokenProvider=s;var c=function(){function e(){this._position=0,this._line=0,this._linePos=0,this._tokens=[],this._lineStartPositions=[0],this._lineContainsNonWhiteSpace=!1}return e.prototype.tokenize=function(e,t,n){void 0===t&&(t=o.DefaultTextStreamMarker),void 0===n&&(n=0),this._text=e,this._streamMarker=t;for(var r=!1;!r;){var a=this._position,s=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker),c=this._getChar();switch(c){case 13:10===this._peekChar()&&this._getChar(),this._lineStartPositions.push(this._position),this._lineContainsNonWhiteSpace||this._recordComment(""),this._line++,this._lineContainsNonWhiteSpace=!1,this._linePos=this._position,a=this._position,s=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker);break;case 10:this._lineContainsNonWhiteSpace||this._recordComment(""),this._line++,this._lineStartPositions.push(this._position),this._lineContainsNonWhiteSpace=!1,this._linePos=this._position,a=this._position,s=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker);break;case 32:case 9:case 11:a=this._position,s=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker);break;case 26:this._recordToken(i.Token.EndOfInput,a,s).text="<end of input>",r=!0;break;case 123:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.OpenBrace,a,s);break;case 125:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.CloseBrace,a,s);break;case 91:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.OpenBracket,a,s);break;case 93:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.CloseBracket,a,s);break;case 40:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.OpenParenthesis,a,s);break;case 41:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.CloseParenthesis,a,s);break;case 44:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Comma,a,s);break;case 58:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Colon,a,s);break;case 43:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Plus,a,s);break;case 45:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Minus,a,s);break;case 47:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Divide,a,s);break;case 37:this._lineContainsNonWhiteSpace=!0,this._recordToken(i.Token.Mod,a,s);break;case 42:this._lineContainsNonWhiteSpace=!0,42===this._peekChar()?(this._getChar(),this._recordToken(i.Token.Exponent,a,s)):this._recordToken(i.Token.Multiply,a,s);break;case 60:this._lineContainsNonWhiteSpace=!0,61===this._peekChar()?(this._getChar(),this._recordToken(i.Token.LessEqual,a,s)):this._recordToken(i.Token.LessThan,a,s);break;case 62:this._lineContainsNonWhiteSpace=!0,61===this._peekChar()?(this._getChar(),this._recordToken(i.Token.GreaterEqual,a,s)):this._recordToken(i.Token.GreaterThan,a,s);break;case 61:this._lineContainsNonWhiteSpace=!0,61===this._peekChar()?(this._getChar(),this._recordToken(i.Token.EqualTo,a,s)):this._recordToken(i.Token.Assignment,a,s);break;case 33:this._lineContainsNonWhiteSpace=!0,61===this._peekChar()?(this._getChar(),this._recordToken(i.Token.NotEqualTo,a,s)):this._recordToken(i.Token.Invalid,a,s);break;case 35:this._swallowComment(a),a=this._position,s=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker),this._lineContainsNonWhiteSpace=!0;break;case 46:this._lineContainsNonWhiteSpace=!0;var u=this._peekChar();46===u?(this._getChar(),this._recordToken(i.Token.DotDot,a,s)):u>=48&&u<=57?this._recordNumericLiteral(this._position-1):this._recordToken(i.Token.Dot,a,s);break;case 34:this._lineContainsNonWhiteSpace=!0,this._recordStringLiteral(this._position-1);break;case 96:this._lineContainsNonWhiteSpace=!0,this._recordEscapedIdentifier(this._position-1);break;default:this._lineContainsNonWhiteSpace=!0,c>=48&&c<=57?this._recordNumericLiteral(this._position-1):this._recordIdentifierOrKeyword(this._position-1,n)}}return{tokens:this._tokens,lineStartPositions:this._lineStartPositions}},e.prototype._getChar=function(){var e=this._peekChar();return 26!==e&&this._position++,e},e.prototype._peekChar=function(){return this._position>=this._text.length?26:this._text.charCodeAt(this._position)},e.prototype._swallowComment=function(e){for(;;){var t=this._peekChar();if(10===t||13===t||26===t)break;this._getChar()}this._recordComment(this._text.substr(e,this._position-e))},e.prototype._recordComment=function(e){var t={token:i.Token.Comment,range:new o.TextRange(new o.TextPosition(this._line,this._position-this._linePos-e.length,this._streamMarker),new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker),this._streamMarker),text:e,commentInfo:{text:e,fullLine:!this._lineContainsNonWhiteSpace}};this._tokens.push(t)},e.prototype._recordNumericLiteral=function(e){var t=this._text.substr(e,128),n=/^(([0-9]*\.[0-9]+(([FfEe][+-]?)?[0-9]+)?)|([0-9]+[FfEe][+-]?[0-9]+))/.exec(t),r=/^[0-9]+/.exec(t),a=n||r,s=new o.TextPosition(this._line,e-this._linePos,this._streamMarker);if(a){var c=a[0].length;c>0&&"."===a[0][c-1]&&t.length>=c+1&&"."===t[c]&&c--,this._position=e+c,this._recordToken(i.Token.NumericLiteral,e,s)}else this._recordToken(i.Token.Invalid,e,s)},e.prototype._recordStringLiteral=function(e){for(var t=e+1,n=new o.TextPosition(this._line,e-this._linePos,this._streamMarker),r=!1;t<this._text.length;){var a=this._text.charCodeAt(t);if(r||92!==a){if(!r&&34===a)break;r=!1}else r=!0;t++}this._position+=t-e,this._recordToken(i.Token.StringLiteral,e,n)},e.prototype._recordIdentifierOrKeyword=function(t,n){var s=t,c=this._text.charCodeAt(s);if(r.isIdentifierStartChar(c))for(s++;r.isIdentifierChar(this._text.charCodeAt(s));)s++;var u=new o.TextPosition(this._line,t-this._linePos,this._streamMarker);if(s>t){this._position=s;var l=i.Token.Identifier,p=this._text.substring(t,s);e.isKeyword(p,n)&&(l=a[p].token),this._recordToken(l,t,u)}else this._recordToken(i.Token.Invalid,t,u)},e.isKeyword=function(e,t){return!!(a[e]&&t>=a[e].inklingVersion)},e.getKeywords=function(e){return Object.keys(a).filter((function(t){return e>=a[t].inklingVersion}))},e.doesIdentifierRequireEscape=function(e){if(!r.isIdentifierStartChar(e.charCodeAt(0)))return!0;for(var t=1;t<e.length;t++)if(!r.isIdentifierChar(e.charCodeAt(t)))return!0;return!1},e.prototype._recordEscapedIdentifier=function(e){for(var t=!1,n=!1,r=0,a=new o.TextPosition(this._line,e-this._linePos,this._streamMarker);;){var s=this._getChar();if(t||92!==s){if(!t){if(26===s||10===s||13===s){n=!0;break}if(96===s)break}t=!1,r++}else t=!0}n||0===r?this._recordToken(i.Token.Invalid,e,a):this._recordToken(i.Token.Identifier,e,a)},e.prototype._recordToken=function(e,t,n){var r=new o.TextPosition(this._line,this._position-this._linePos,this._streamMarker),i={token:e,range:new o.TextRange(n,r,this._streamMarker),text:this._text.substr(t,this._position-t)};return this._tokens.push(i),i},e.decodeIdentifier=function(e){if(e.length<2)return e;if(96!==e.charCodeAt(0))return e;for(var t="",n=!1,r=1;r<e.length-1;r++){var o=e.substr(r,1);n?(this._escapedCharMap[o]?t+=this._escapedCharMap[o]:t+=o,n=!1):"\\"===o?n=!0:t+=o}return t},e._escapeIdentifier=function(e){for(var t="`",n=0;n<e.length;n++){var r=e[n];"`"===r?t+="\\`":this._escapedCharReverseMap[r]?t+=this._escapedCharReverseMap[r]:t+=r}return t+"`"},e.encodeIdentifier=function(t,n){return void 0!==n&&e.isKeyword(t,n)&&["input","not"].some((function(e){return t===e}))||e.doesIdentifierRequireEscape(t)?e._escapeIdentifier(t):t},e.decodeStringLiteral=function(e){var t=e.length-2;'"'!==e.substr(e.length-1)&&t++;for(var n=e.substr(1,t),r="",o=!1,i=0;i<n.length;i++){var a=n.substr(i,1);o?(this._escapedCharMap[a]?r+=this._escapedCharMap[a]:r+=a,o=!1):"\\"===a?o=!0:r+=a}return r},e.encodeStringLiteral=function(e){for(var t='"',n=0;n<e.length;n++){var r=e[n];'"'===r?t+='\\"':this._escapedCharReverseMap[r]?t+=this._escapedCharReverseMap[r]:t+=r}return t+'"'},e.isIntegerType=function(e){return e===i.Token.Int8||e===i.Token.Int16||e===i.Token.Int32||e===i.Token.Int64||e===i.Token.UInt8||e===i.Token.UInt16||e===i.Token.UInt32||e===i.Token.UInt64||e===i.Token.Bool},e.isFloatingPointType=function(e){return e===i.Token.Float32||e===i.Token.Float64},e.isNumericType=function(t){return t===i.Token.Number||e.isIntegerType(t)||e.isFloatingPointType(t)},e.isPrimitiveType=function(t){return t===i.Token.String||e.isNumericType(t)},e.isNumericLikeLiteral=function(e){return e===i.Token.NumericLiteral||e===i.Token.True||e===i.Token.False},e.isUnaryOperator=function(e){return e===i.Token.Plus||e===i.Token.Minus||e===i.Token.Not},e.isBinaryOperator=function(e){return e===i.Token.Plus||e===i.Token.Minus||e===i.Token.LessEqual||e===i.Token.LessThan||e===i.Token.EqualTo||e===i.Token.NotEqualTo||e===i.Token.GreaterEqual||e===i.Token.GreaterThan||e===i.Token.Multiply||e===i.Token.Divide||e===i.Token.Mod||e===i.Token.Exponent||e===i.Token.Or||e===i.Token.And},e.isGoalOperator=function(e){return e===i.Token.Reach||e===i.Token.Avoid||e===i.Token.Drive||e===i.Token.Maximize||e===i.Token.Minimize},e.isRelationalOperator=function(e){return e===i.Token.EqualTo||e===i.Token.NotEqualTo||e===i.Token.LessThan||e===i.Token.LessEqual||e===i.Token.GreaterThan||e===i.Token.GreaterEqual},e.isBooleanOperator=function(e){return this.isRelationalOperator(e)||e===i.Token.Or||e===i.Token.And||e===i.Token.Not},e._escapedCharMap={n:"\n",r:"\r","\\":"\\"},e._escapedCharReverseMap={"\n":"\\n","\r":"\\r","\\":"\\\\"},e}();t.Tokenizer=c},4393:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isKeyword=t.Token=void 0,function(e){e[e.EndOfInput=0]="EndOfInput",e[e.Invalid=1]="Invalid",e[e.Comment=2]="Comment",e[e.NumericLiteral=3]="NumericLiteral",e[e.StringLiteral=4]="StringLiteral",e[e.Identifier=5]="Identifier",e[e.OpenBracket=6]="OpenBracket",e[e.CloseBracket=7]="CloseBracket",e[e.OpenParenthesis=8]="OpenParenthesis",e[e.CloseParenthesis=9]="CloseParenthesis",e[e.OpenBrace=10]="OpenBrace",e[e.CloseBrace=11]="CloseBrace",e[e.LessEqual=12]="LessEqual",e[e.LessThan=13]="LessThan",e[e.Assignment=14]="Assignment",e[e.EqualTo=15]="EqualTo",e[e.NotEqualTo=16]="NotEqualTo",e[e.GreaterThan=17]="GreaterThan",e[e.GreaterEqual=18]="GreaterEqual",e[e.Colon=19]="Colon",e[e.Comma=20]="Comma",e[e.Dot=21]="Dot",e[e.DotDot=22]="DotDot",e[e.Plus=23]="Plus",e[e.Minus=24]="Minus",e[e.Multiply=25]="Multiply",e[e.Divide=26]="Divide",e[e.Mod=27]="Mod",e[e.Exponent=28]="Exponent",e[e.FirstKeyword=29]="FirstKeyword",e[e.Action=30]="Action",e[e.Algorithm=31]="Algorithm",e[e.And=32]="And",e[e.Avoid=33]="Avoid",e[e.Constant=34]="Constant",e[e.Const=35]="Const",e[e.Constraint=36]="Constraint",e[e.Drive=37]="Drive",e[e.Else=38]="Else",e[e.Experiment=39]="Experiment",e[e.Goal=40]="Goal",e[e.Graph=41]="Graph",e[e.If=42]="If",e[e.Import=43]="Import",e[e.In=44]="In",e[e.Inkling=45]="Inkling",e[e.Lesson=46]="Lesson",e[e.Mask=47]="Mask",e[e.Maximize=48]="Maximize",e[e.Minimize=49]="Minimize",e[e.Not=50]="Not",e[e.Or=51]="Or",e[e.Package=52]="Package",e[e.Dataset=53]="Dataset",e[e.Programmed=54]="Programmed",e[e.Reach=55]="Reach",e[e.Return=56]="Return",e[e.Reward=57]="Reward",e[e.Scenario=58]="Scenario",e[e.Select=59]="Select",e[e.Source=60]="Source",e[e.State=61]="State",e[e.Step=62]="Step",e[e.Terminal=63]="Terminal",e[e.Training=64]="Training",e[e.Type=65]="Type",e[e.Using=66]="Using",e[e.Var=67]="Var",e[e.Within=68]="Within",e[e.Concept=69]="Concept",e[e.Curriculum=70]="Curriculum",e[e.Function=71]="Function",e[e.Simulator=72]="Simulator",e[e.Data=73]="Data",e[e.Number=74]="Number",e[e.Bool=75]="Bool",e[e.Float32=76]="Float32",e[e.Float64=77]="Float64",e[e.Int8=78]="Int8",e[e.Int16=79]="Int16",e[e.Int32=80]="Int32",e[e.Int64=81]="Int64",e[e.String=82]="String",e[e.UInt8=83]="UInt8",e[e.UInt16=84]="UInt16",e[e.UInt32=85]="UInt32",e[e.UInt64=86]="UInt64",e[e.False=87]="False",e[e.True=88]="True",e[e.Input=89]="Input",e[e.Output=90]="Output",e[e.LastKeyword=91]="LastKeyword"}(n=t.Token||(t.Token={})),t.isKeyword=function(e){return e>n.FirstKeyword&&e<n.LastKeyword}},8240:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrainingValidator=t.DefaultNoProgressIterationLimit=t.DefaultAssessmentWindow=t.DefaultSuccessThreshold=t.DefaultEpisodeIterationLimit=t.DefaultTotalIterationLimit=void 0;var r=n(4471),o=n(4847),i=n(2374),a=n(7379);t.DefaultTotalIterationLimit=5e7,t.DefaultEpisodeIterationLimit=1e3,t.DefaultSuccessThreshold=.9,t.DefaultAssessmentWindow=60,t.DefaultNoProgressIterationLimit=25e4;var s={category:a.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:1,stop:4294967295,step:1}},c=a.getDefaultNumberType(),u={category:a.TypeCategory.Number,errorReported:!1,rangeConstraint:{start:0,stop:1}},l={EpisodeIterationLimit:{type:s,allowedForGoal:!0,allowedForNonGoal:!0,allowedForLesson:!1,defaultValue:t.DefaultEpisodeIterationLimit,documentation:"Maximum number of iterations per episode"},TotalIterationLimit:{type:s,allowedForGoal:!0,allowedForNonGoal:!0,allowedForLesson:!1,defaultValue:t.DefaultTotalIterationLimit,documentation:"Maximum number of iterations for training concept"},LessonRewardThreshold:{type:c,allowedForGoal:!1,allowedForNonGoal:!0,allowedForLesson:!0,documentation:"Average reward value that must be achieved (over a limited window of episodes) for lesson to be terminated"},LessonSuccessThreshold:{type:u,allowedForGoal:!0,allowedForNonGoal:!0,allowedForLesson:!0,defaultValue:t.DefaultSuccessThreshold,documentation:"Average goal success rate that must be achieved (over a limited window of episodes) for lesson to be terminated"},LessonAssessmentWindow:{type:s,allowedForGoal:!0,allowedForNonGoal:!0,allowedForLesson:!0,defaultValue:t.DefaultAssessmentWindow,documentation:"Size of assessment window (number of episodes)"},NoProgressIterationLimit:{type:s,allowedForGoal:!0,allowedForNonGoal:!0,allowedForLesson:!1,defaultValue:t.DefaultNoProgressIterationLimit,documentation:"Maximum number of iterations with no progress before training will be terminated"}},p=function(){function e(){}return e.validateTrainingValue=function(e,t,n,a,s,c){var u=!0,p=!1,d=!1;return t.value.forEach((function(t,s){var m=l[s];if(m){if(a&&!m.allowedForLesson)c.onError("Field '"+s+"' is not allowed for lessons",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),u=!1;else if(i.TypeChecker.isValueAssignableToType(t,m.type))n&&!m.allowedForGoal?(c.onError("Field '"+s+"' cannot be used with a goal",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),u=!1):n||m.allowedForNonGoal||(c.onError("Field '"+s+"' requires a goal",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),u=!1);else{var y=new r.DiagnosticAddendum;y.addMessage("Expected value of type '"+i.TypeChecker.printType(m.type)+"'"),c.onError("Value for field '"+s+"' is incorrect type"+y.getString(),o.ParseNodeUtils.getBestErrorNodeForField(e,s)),u=!1}"LessonRewardThreshold"===s?p=!0:"LessonSuccessThreshold"===s&&(d=!0)}else c.onError("'"+s+"' is not a supported training field",o.ParseNodeUtils.getBestErrorNodeForField(e,s)),u=!1})),n||!d||p||s||(c.onError("When using rewards, a LessonSuccessThreshold parameter must be used together with LessonRewardThreshold",o.ParseNodeUtils.getBestErrorNodeForField(e,"LessonSuccessThreshold")),u=!1),u},e.getExpectedType=function(e,t){var n=[];return Object.keys(l).forEach((function(r){var o=l[r];t&&!o.allowedForLesson||e&&!o.allowedForGoal||!e&&!o.allowedForNonGoal||n.push({name:r,type:o.type,optional:!0,documentation:o.documentation})})),{category:a.TypeCategory.Struct,errorReported:!1,fields:n}},e.getDefaultTrainingValues=function(e,t){var n=new Map;return Object.keys(l).forEach((function(r){var o=l[r];t&&!o.allowedForLesson||(e&&o.allowedForGoal||!e&&o.allowedForNonGoal)&&n.set(r,o.defaultValue)})),n},e}();t.TrainingValidator=p},2374:function(e,t,n){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeChecker=void 0;var i,a=n(9194),s=n(4471),c=n(7585),u=n(8312),l=n(3649),p=n(6155),d=n(6172),m=n(9948),y=n(9554),g=n(7379);!function(e){e[e.Value=0]="Value",e[e.Type=1]="Type",e[e.Namespace=2]="Namespace",e[e.Function=3]="Function"}(i||(i={}));var h=function(){function e(){}return e.getTypeOfTypeNode=function(e,t,n){var o,i,a;if(void 0===n&&(n=!1),e.type===p.ParseNodeType.SpecializedType)a=this._createTypeWithNode(this._resolveSpecializedType(e,t),e);else if(e.type===p.ParseNodeType.MemberAccess){var s=this._resolveMemberAccess(e,t);!n&&s.category===g.TypeCategory.Complex&&s.typeParameters.length>0?(t.onError("Missing type parameters for generic type",e),a=this._createTypeWithNode(this.getDummyType(),e)):a=this._createTypeWithNode(s,e)}else a=e.type===p.ParseNodeType.Identifier?this._createTypeWithNode(this._resolveTypeIdentifier(e,t),e):e.type===p.ParseNodeType.ArrayType?this._createTypeWithNode(this._resolveArrayType(e,t),e):e.type===p.ParseNodeType.StructType?this._createTypeWithNode(this._resolveStructType(e,t),e):e.type===p.ParseNodeType.String||e.type===p.ParseNodeType.Number?this._createTypeWithNode(this._resolvePrimitiveType(e),e):this._createTypeWithNode(this._resolveShorthandConstrainedType(e,t),e);if(!a.errorReported&&a.category===g.TypeCategory.Number&&(null===(o=e.parent)||void 0===o?void 0:o.type)!==p.ParseNodeType.SpecializedType&&(null===(i=e.parent)||void 0===i?void 0:i.type)!==p.ParseNodeType.MemberAccess&&a.rangeConstraint){var c=a.rangeConstraint.start<g.minNumberValue,u=a.rangeConstraint.stop>g.maxNumberValue;c||u?(a=r({},a),c&&u&&void 0===a.rangeConstraint.step?delete a.rangeConstraint:(a.rangeConstraint=r({},a.rangeConstraint),c&&(a.rangeConstraint.start=g.minNumberValue),u&&(a.rangeConstraint.stop=g.maxNumberValue)),t.onWarning("Numeric type will be clipped to fit within the range <-3.4e38 .. 3.4e38>",e)):1===a.rangeConstraint.step&&(a.rangeConstraint.start<-(1<<24)||a.rangeConstraint.stop>1<<24)&&t.onWarning("Numeric type has range beyond <-16777216 .. 16777216>; integer values outside this range may not be represented exactly",e)}return a},e.synthesizeTypeFromValue=function(e,t){var n=this;if(void 0===t&&(t=!1),e.category===g.TypeCategory.Number)return{category:g.TypeCategory.Number,errorReported:e.errorReported,enumeratedConstraint:t?void 0:{items:[{value:e.value}]}};if(e.category===g.TypeCategory.String)return{category:g.TypeCategory.String,errorReported:e.errorReported,enumeratedConstraint:t?void 0:{items:[{value:e.value}]}};if(e.category===g.TypeCategory.Array){var r,o=e,i=o.errorReported;return r=o.value.length>0?this.synthesizeTypeFromValue(o.value[0],!0):this.getDummyType(),{category:g.TypeCategory.Array,errorReported:i,length:o.value.length,baseType:r}}if(e.category===g.TypeCategory.Struct){var a=e,s=a.errorReported,c=[];return a.value.forEach((function(e,t){var r={name:t,type:n.synthesizeTypeFromValue(a.value.get(t))};r.type.errorReported&&(s=!0),c.push(r)})),{category:g.TypeCategory.Struct,errorReported:s,fields:c}}return e.category===g.TypeCategory.Complex?e.type:this.getDummyType()},e.getDummyType=function(){return{errorReported:!0,category:g.TypeCategory.Number}},e.printType=function(t,n){if(void 0===n&&(n=!0),t.symbolicName&&n){var r="";return t.symbolicNamespace&&(r=t.symbolicNamespace+"."),r+this.printIdentifier(t.symbolicName)}switch(t.category){case g.TypeCategory.Number:var o=t,i="";if(o.rangeConstraint){var a=o.rangeConstraint.start,s=void 0===o.rangeConstraint.stop?a:o.rangeConstraint.stop,c=o.rangeConstraint.step,u=void 0===c?"":" step "+c;i="<"+d.printValueSinglePrecision(a)+" .. "+d.printValueSinglePrecision(s)+u+">"}else o.enumeratedConstraint&&(i="<"+o.enumeratedConstraint.items.map((function(e){return(void 0===e.name?"":e.name+" = ")+d.printValueSinglePrecision(e.value)})).join(", ")+">");return"number"+i;case g.TypeCategory.String:var l=t;return i="",l.enumeratedConstraint&&(i="<"+l.enumeratedConstraint.items.map((function(e){return(void 0===e.name?"":e.name+"=")+y.Tokenizer.encodeStringLiteral(e.value)})).join(", ")+">"),"string"+i;case g.TypeCategory.Struct:return"{ "+t.fields.map((function(t){var n=t.optional?"?":"",r=e.printType(t.type);return""+y.Tokenizer.encodeIdentifier(t.name)+n+": "+r})).join(", ")+" }";case g.TypeCategory.Array:var p=t;return e.printType(p.baseType)+"["+p.length+"]";case g.TypeCategory.Complex:var m=t,h=m.typeArguments.map((function(t){return e.printType(t)})).join(", "),f=h?"<"+h+">":"";return""+this.printComplexTypeNamespaceAndClass(m.internalClass)+f}},e.printIdentifier=function(e){return y.Tokenizer.encodeIdentifier(e)},e.printComplexTypeNamespaceAndClass=function(e){switch(e){case g.ComplexTypeClass.ImageGray:return"Image.Gray";case g.ComplexTypeClass.ImageRGB:return"Image.RGB";case g.ComplexTypeClass.GoalTargetRegion:return"Goal.TargetRegion"}return"Unknown"},e.isExpressionConst=function(e,t){var n=this,r=!1;switch(e.type){case p.ParseNodeType.BinaryOperation:r=this.isExpressionConst(e.leftOperand,t)&&this.isExpressionConst(e.rightOperand,t);break;case p.ParseNodeType.ParenthesizedExpression:r=this.isExpressionConst(e.expression,t);break;case p.ParseNodeType.ArrayAccess:r=this.isExpressionConst(e.array,t);break;case p.ParseNodeType.FunctionCall:r=!1;break;case p.ParseNodeType.UnaryOperation:r=this.isExpressionConst(e.operand,t);break;case p.ParseNodeType.MemberAccess:r=this._isMemberAccessExpressionConst(e,t);break;case p.ParseNodeType.Identifier:var o=this.resolveIdentifier(e,t,!1);o&&(l.setIdentifierDataForNode(e,{symbolCategory:o.category,resolvedObject:o.resolvedObject}),o.category===m.SymbolCategory.Const&&(r=!0));break;case p.ParseNodeType.True:case p.ParseNodeType.False:case p.ParseNodeType.NumericLiteral:case p.ParseNodeType.StringLiteral:c.ExpressionEvaluator.evaluateConstantExpression(e,t.silenceDiagnostics()),r=!0;break;case p.ParseNodeType.ArrayLiteral:r=void 0===e.values.find((function(e){return!n.isExpressionConst(e,t)}));break;case p.ParseNodeType.StructLiteral:r=void 0===e.fields.find((function(e){return!n.isExpressionConst(e.value,t)}))}return r&&c.ExpressionEvaluator.evaluateConstantExpression(e,t.silenceDiagnostics()),r},e.getTypeOfExpression=function(e,t,n,r,o){if(void 0===o&&(o=!1),(r||!o)&&this.isExpressionConst(e,t)){var a=c.ExpressionEvaluator.evaluateConstantExpression(e,t),s=this.synthesizeTypeFromValue(a);return!n&&this.doesTypeContainString(s)&&(t.onError("Value that contains a string is not allowed in this context",e),s.errorReported=!0),s}var u=this._validateSubexpressionType(e,t,n,r);return u?u.category!==i.Value?(t.onError("Expression must refer to value",e),this.getDummyType()):u.type:this.getDummyType()},e.getCommonType=function(e,t){var n=this;if(e.category===t.category)switch(e.category){case g.TypeCategory.Number:var r=e,o=t;if(this.isTypeAssignable(r,o,new s.DiagnosticAddendum))return o;if(this.isTypeAssignable(o,r,new s.DiagnosticAddendum))return r;var i=void 0;if(r.enumeratedConstraint&&o.enumeratedConstraint){var a=new Map;r.enumeratedConstraint&&r.enumeratedConstraint.items.forEach((function(e){a.set(e.value,e.value)})),o.enumeratedConstraint&&o.enumeratedConstraint.items.forEach((function(e){a.set(e.value,e.value)}));var c=[];a.forEach((function(e){c.push(e)})),c.length>0&&(i={items:(c=c.sort()).map((function(e){return{value:e}}))})}return{category:g.TypeCategory.Number,errorReported:r.errorReported||o.errorReported,enumeratedConstraint:i};case g.TypeCategory.String:var u=e,l=t,p=new Map;u.enumeratedConstraint&&u.enumeratedConstraint.items.forEach((function(e){p.set(e.value,e.value)})),l.enumeratedConstraint&&l.enumeratedConstraint.items.forEach((function(e){p.set(e.value,e.value)})),i=void 0;var d=[];return p.forEach((function(e){d.push(e)})),d.length>0&&(i={items:(d=d.sort()).map((function(e){return{value:e}}))}),{category:g.TypeCategory.String,errorReported:u.errorReported||l.errorReported,enumeratedConstraint:i};case g.TypeCategory.Array:var m=e,y=t;if(m.length!==y.length)return;var h=this.getCommonType(m.baseType,y.baseType);if(!h)return;return{category:g.TypeCategory.Array,errorReported:m.errorReported||m.errorReported,baseType:h,length:m.length};case g.TypeCategory.Struct:var f=e,T=t;if(f.fields.length!==T.fields.length)return;var v={category:g.TypeCategory.Struct,errorReported:f.errorReported||T.errorReported,fields:[]},_=!0;return f.fields.forEach((function(e,t){if(e.name!==T.fields[t].name)_=!1;else{var r=n.getCommonType(e.type,T.fields[t].type);r?v.fields.push({name:e.name,type:r}):_=!1}})),_?v:void 0;case g.TypeCategory.Complex:var C=e,b=t;if(C.errorReported||b.errorReported)return;if(C.internalClass!==b.internalClass)return;if(C.typeArguments.length!==b.typeArguments.length)return;return void 0===C.typeArguments.find((function(e,t){return!n.isTypeSame(e,b.typeArguments[t])}))?e:void 0}},e.isTypeContinuous=function(e){var t=this;switch(e.category){case g.TypeCategory.Number:var n=this.synthesizeConstraintForNumberType(e);return!n.enumeratedConstraint||!n.enumeratedConstraint.items.some((function(e){return!!e.name}));case g.TypeCategory.Complex:case g.TypeCategory.String:return!1;case g.TypeCategory.Array:var r=e;return this.isTypeContinuous(r.baseType);case g.TypeCategory.Struct:return void 0===e.fields.find((function(e){return!t.isTypeContinuous(e.type)}))}},e.isTypeConstrained=function(e){var t=this;switch(e.category){case g.TypeCategory.Number:return!(!e.enumeratedConstraint&&!e.rangeConstraint);case g.TypeCategory.Complex:case g.TypeCategory.String:return!0;case g.TypeCategory.Array:var n=e;return this.isTypeConstrained(n.baseType);case g.TypeCategory.Struct:return void 0===e.fields.find((function(e){return!t.isTypeConstrained(e.type)}))}},e.isTypeDiscrete=function(e){var t=this;switch(e.category){case g.TypeCategory.Number:var n=this.synthesizeConstraintForNumberType(e);return!(!n.enumeratedConstraint||!n.enumeratedConstraint.items.some((function(e){return!!e.name})));case g.TypeCategory.Complex:case g.TypeCategory.String:return!1;case g.TypeCategory.Array:var r=e;return this.isTypeDiscrete(r.baseType);case g.TypeCategory.Struct:return void 0===e.fields.find((function(e){return!t.isTypeDiscrete(e.type)}))}},e.isTypeSame=function(e,t){var n=new s.DiagnosticAddendum;return this.isTypeAssignable(e,t,n)&&this.isTypeAssignable(t,e,n)},e.isTypeAssignable=function(e,t,n){var r=this;if(e.category!==t.category)return n.addMessage("Type "+this.printType(e)+" is not assignable to type "+this.printType(t)),!1;switch(e.category){case g.TypeCategory.Number:var o=this.synthesizeConstraintForNumberType(e),i=this.synthesizeConstraintForNumberType(t);if(o.enumeratedConstraint){var a=!0;return i.rangeConstraint?o.enumeratedConstraint.items.forEach((function(e){r._isValueInRange(e.value,i.rangeConstraint)||(n.addMessage("Value "+d.printValueSinglePrecision(e.value)+" is not within range for "+r.printType(t)),a=!1)})):i.enumeratedConstraint&&o.enumeratedConstraint.items.forEach((function(e){i.enumeratedConstraint.items.find((function(t){return t.value===e.value}))||(n.addMessage("Value "+d.printValueSinglePrecision(e.value)+" is not permitted for type "+r.printType(t)),a=!1)})),a}return i.enumeratedConstraint?(n.addMessage("A non-enumerated type is not assignable to an enumerated type"),!1):!!(!i.rangeConstraint||o.rangeConstraint&&this._validateRangeConsistentWithNumberConstraint(o.rangeConstraint,i.rangeConstraint))||(n.addMessage("Type "+this.printType(e)+" is not assignable to type "+this.printType(t)+" because of incompatible range constraints"),!1);case g.TypeCategory.String:var s=e,c=t;if(s.enumeratedConstraint){if(!c.enumeratedConstraint)return!0;var u=!0;return s.enumeratedConstraint.items.forEach((function(e){c.enumeratedConstraint.items.find((function(t){return t.value===e.value}))||(n.addMessage("Value '"+y.Tokenizer.encodeStringLiteral(e.value)+"' is not permitted for type "+r.printType(t)),u=!1)})),u}return!0;case g.TypeCategory.Array:var l=e,p=t;return l.length!==p.length?(n.addMessage("Mismatch in length of array: expected "+p.length+" but received "+l.length),!1):this.isTypeAssignable(l.baseType,p.baseType,n.createAddendum());case g.TypeCategory.Struct:var m=e,h=t;if(m.fields.length!==h.fields.length)return n.addMessage("Mismatch in number of struct fields: expected "+h.fields.length+" but received "+m.fields.length),!1;var f=!0;return m.fields.forEach((function(e,t){var o=h.fields[t],i=n.createAddendum();e.name!==o.name?(i.addMessage("Struct field name mismatch: expected '"+o.name+"' but received "+e.name),f=!1):r.isTypeAssignable(e.type,o.type,i)||(i.addMessage("Type mismatch for struct field '"+o.name+"': expected "+r.printType(o.type)+" but received "+r.printType(e.type)),f=!1)})),f;case g.TypeCategory.Complex:var T=e,v=t;if(T.internalClass!==v.internalClass)return n.addMessage("Type mismatch: expected '"+this.printType(v)+"' but received "+this.printType(T)),!1;if(T.typeArguments.length!==v.typeArguments.length)return n.addMessage("Type argument length mismatch: expected '"+v.typeArguments.length+"' but received "+T.typeArguments.length),!1;var _=!0;return T.typeArguments.forEach((function(e,t){var o=v.typeArguments[t];r.isTypeSame(e,o)||(o.symbolicName?n.addMessage("Type argument for '"+r.printType(o)+"' does not match"):n.addMessage("Type argument does not match"),_=!1)})),_;default:return n.addMessage("Unexpected type encountered"),!1}},e.isTypeCastable=function(e,t,n){var r=this;if(e.category!==t.category)return n.addMessage("Type "+this.printType(e)+" cannot be cast to type "+this.printType(t)),!1;switch(e.category){case g.TypeCategory.Number:var o=e,i=t;if(i.enumeratedConstraint){if(o.enumeratedConstraint){var a=!0;return o.enumeratedConstraint.items.forEach((function(e){i.enumeratedConstraint.items.find((function(t){return t.value===e.value}))||(n.addMessage("Value '"+d.printValueSinglePrecision(e.value)+"' is not permitted for type "+r.printType(t)),a=!1)})),a}return n.addMessage("A non-enumerated type cannot be cast to an enumerated type"),!1}return!0;case g.TypeCategory.String:case g.TypeCategory.Complex:return this.isTypeAssignable(e,t,n);case g.TypeCategory.Array:var s=e,c=t;return s.length!==c.length?(n.addMessage("Mismatch in length of array: expected "+c.length+" but received "+s.length),!1):this.isTypeCastable(s.baseType,c.baseType,n);case g.TypeCategory.Struct:var u=e,l=!0;return t.fields.forEach((function(e){var t=u.fields.find((function(t){return t.name===e.name})),o=n.createAddendum();t?r.isTypeCastable(t.type,e.type,o)||(o.addMessage("Struct field '"+t.name+"' is not castable"),l=!1):(o.addMessage("Struct field '"+e.name+"' is missing"),l=!1)})),l;default:return n.addMessage("Unexpected type encountered"),!1}},e.resolveScenarioType=function(e,t,n,r,o){var i=this;if(t.category!==n.category){var a="Type "+this.printType(t)+" is not assignable to type "+this.printType(n);return e&&r.onError(a,e),o&&o.addMessage(a),this.getDummyType()}switch(n.category){case g.TypeCategory.Number:case g.TypeCategory.String:var c=new s.DiagnosticAddendum;return this.isTypeAssignable(t,n,c)?t.category===g.TypeCategory.String&&t.enumeratedConstraint&&t.enumeratedConstraint.items.length>1?(a="A string type with enumerated constraint is limited to a single string value when used within a scenario",e&&r.onError(a,e),o&&o.addMessage(a),this.getDummyType()):t:(a="Type "+this.printType(t)+" is not assignable to type "+this.printType(n),e&&r.onError(a+c.getString(),e),o&&(o.addMessage(a),o.addAddendum(c)),this.getDummyType());case g.TypeCategory.Struct:var u=t,d=n,m={category:g.TypeCategory.Struct,errorReported:d.errorReported||u.errorReported,fields:[],node:t.node};return(null==e?void 0:e.type)===p.ParseNodeType.StructType&&l.setStructLiteralDataForNode(e,{expectedType:d}),u.fields.forEach((function(t){var n;if(e&&e.type===p.ParseNodeType.StructType){var a=e.fields.find((function(e){return e.name.text===t.name}));a&&(n=a)}var s=d.fields.find((function(e){return e.name===t.name}));if(s){var c=i.resolveScenarioType(n?n.fieldType:void 0,t.type,s.type,r,null==o?void 0:o.createAddendum());m.fields.push({name:t.name,type:c}),c.errorReported&&(o&&o.addMessage("Type of field "+i.printIdentifier(t.name)+" is "+i.printType(t.type)+", which is not assignable to type "+i.printType(s.type)),m.errorReported=!0)}else{var u="Field "+i.printIdentifier(t.name)+" is not present";n&&r.onError(u,n),o&&o.addMessage(u),m.errorReported=!0}})),m;case g.TypeCategory.Array:var y=t,h=n;if(h.length!==y.length)return a="Array length is incompatible",e&&r.onError(a,e),o&&o.addMessage(a),this.getDummyType();var f=e;e&&e.type===p.ParseNodeType.ArrayType&&(f=e.baseType);var T=this.resolveScenarioType(f,y.baseType,h.baseType,r,null==o?void 0:o.createAddendum());return T.errorReported&&o&&o.addMessage("Type of array is "+this.printType(y.baseType)+", which is not assignable to type "+this.printType(h.baseType)),{category:g.TypeCategory.Array,errorReported:T.errorReported||y.errorReported,baseType:T,length:y.length,node:t.node};case g.TypeCategory.Complex:return this.isTypeSame(t,n)?t:(a="Type is not compatible",e&&r.onError(a,e),o&&o.addMessage(a),this.getDummyType())}},e.doesTypeContainString=function(e,t){var n=this;switch(void 0===t&&(t=!1),e.category){case g.TypeCategory.Number:case g.TypeCategory.Complex:return!1;case g.TypeCategory.String:return!t||void 0===e.enumeratedConstraint;case g.TypeCategory.Array:return this.doesTypeContainString(e.baseType,t);case g.TypeCategory.Struct:return e.fields.some((function(e){return n.doesTypeContainString(e.type,t)}))}},e.isUsageAllowedForType=function(t,n){var r=this;switch(t.category){case g.TypeCategory.Number:case g.TypeCategory.String:return!0;case g.TypeCategory.Complex:return 0!=(t.usage&n);case g.TypeCategory.Struct:return!t.fields.some((function(e){return!r.isUsageAllowedForType(e.type,n)}));case g.TypeCategory.Array:return e.isUsageAllowedForType(t.baseType,n)}},e.getDimensionalityOfType=function(e){var t=this;switch(e.category){case g.TypeCategory.Number:case g.TypeCategory.String:return e.enumeratedConstraint&&e.enumeratedConstraint.items.some((function(e){return e.name}))?e.enumeratedConstraint.items.length:1;case g.TypeCategory.Complex:return 1;case g.TypeCategory.Struct:var n=0;return e.fields.forEach((function(e){n+=t.getDimensionalityOfType(e.type)})),n;case g.TypeCategory.Array:return this.getDimensionalityOfType(e.baseType)*e.length}},e.getCombinatoricDimensionalityOfType=function(e){var t=this;switch(e.category){case g.TypeCategory.Number:case g.TypeCategory.String:return e.enumeratedConstraint&&e.enumeratedConstraint.items.some((function(e){return e.name}))?e.enumeratedConstraint.items.length:1;case g.TypeCategory.Complex:return 1;case g.TypeCategory.Struct:var n=1;return e.fields.forEach((function(e){n*=t.getCombinatoricDimensionalityOfType(e.type)})),n;case g.TypeCategory.Array:return Math.pow(this.getCombinatoricDimensionalityOfType(e.baseType),e.length)}},e.isValueAssignableToType=function(e,t){if(e.errorReported||t.errorReported)return!0;if(e.category!==t.category)return!1;switch(e.category){case g.TypeCategory.Number:return this._isNumberValueAssignableToType(e,t);case g.TypeCategory.String:return this._isStringValueAssignableToType(e,t);case g.TypeCategory.Array:return this._isArrayValueAssignableToType(e,t);case g.TypeCategory.Struct:return this._isStructValueAssignableToType(e,t)}return!1},e.flattenType=function(e){var t={category:g.TypeCategory.Struct,errorReported:!1,fields:[]};return this._addFlattenedFieldToStruct(t,e),t},e.unflattenType=function(e){var t=new Map;e.fields.forEach((function(e){t.set(e.name,e.type)}));var n=u.partition(t,!0),r=u.getFromPartitions(n);return this._convertUnflattenedToType(r)},e.getDisplayNameFromFlattenedField=function(e,t){return e.startsWith(".")&&(e=(t||"value")+e.substr(1)),e.split(".").map((function(e){var t=e.indexOf("["),n=t<0?e:e.substr(0,t),r=t<0?"":e.substr(t),o=decodeURIComponent(n);return y.Tokenizer.encodeIdentifier(o)+r})).join(".")},e._convertUnflattenedToType=function(e){var t=this;if(e instanceof Map){var n=[];return e.forEach((function(e,r){n.push({name:r,type:t._convertUnflattenedToType(e)})})),{category:g.TypeCategory.Struct,fields:n,errorReported:!1}}if(e instanceof Array){if(0===e.length)throw new Error("Unflattened array contains zero elements");return{category:g.TypeCategory.Array,baseType:this._convertUnflattenedToType(e[0]),length:e.length,errorReported:!1}}return e},e._addFlattenedFieldToStruct=function(e,t,n){var r=this;switch(t.category){case g.TypeCategory.Number:case g.TypeCategory.String:case g.TypeCategory.Complex:e.fields.push({name:n||".",type:t});break;case g.TypeCategory.Array:for(var o=t,i=0;i<o.length;i++)this._addFlattenedFieldToStruct(e,o.baseType,(n||".")+"["+i+"]");break;case g.TypeCategory.Struct:var a=n?n+".":"";t.fields.forEach((function(t){r._addFlattenedFieldToStruct(e,t.type,a+u.encodeFlattenedFieldName(t.name))}))}return e},e.synthesizeConstraintForNumberType=function(e){return e.rangeConstraint||e.enumeratedConstraint?e:{category:g.TypeCategory.Number,errorReported:e.errorReported,symbolicNamespace:e.symbolicNamespace,symbolicName:e.symbolicName,rangeConstraint:{start:g.minNumberValue,stop:g.maxNumberValue}}},e.resolveIdentifier=function(e,t,n){void 0===n&&(n=!0);var r=t.lookUpSymbol(e.text);if(r.isCircular)n&&this._handleCircularTypeReference(r.symbol,e,t);else{var o=r.symbol;if(o)return t.resolveSymbol(o),o;n&&e.text&&t.onError("Unknown identifier '"+e.text+"'",e)}},e._createTypeWithNode=function(e,t){var n=r({},e);return n.node=t,n},e._isMemberAccessExpressionConst=function(e,t){if(e.leftExpression.type===p.ParseNodeType.Identifier){var n=this.resolveIdentifier(e.leftExpression,t,!1);if(n&&n.category===m.SymbolCategory.Namespace){var r=n.resolvedObject,o=t.createNewContext(r.symbolTable),i=this.resolveIdentifier(e.identifier,o,!1);return!!i&&i.category===m.SymbolCategory.Const}}return this.isExpressionConst(e.leftExpression,t)},e._reportOperatorNotNumberError=function(e,t,n){if(!e.errorReported){var r=e.category===g.TypeCategory.String?"strings":"this type";n.onError("Operation is not supported for "+r+"; number was expected",t)}},e._validateSubexpressionType=function(e,t,n,r){var o=this;switch(e.type){case p.ParseNodeType.BinaryOperation:var a=this.getTypeOfExpression(e.leftOperand,t,n),s=this.getTypeOfExpression(e.rightOperand,t,n);if(a.errorReported||s.errorReported)return;if(a.category!==g.TypeCategory.Number)return void this._reportOperatorNotNumberError(a,e.leftOperand,t);if(s.category!==g.TypeCategory.Number)return void this._reportOperatorNotNumberError(s,e.rightOperand,t);y.Tokenizer.isRelationalOperator(e.operator)&&e.leftOperand.type===p.ParseNodeType.BinaryOperation&&y.Tokenizer.isRelationalOperator(e.leftOperand.operator)&&t.onWarning("Comparison operators do not chain in inkling. Did you mean to add 'and' between comparisons?",e.rightOperand);var u=y.Tokenizer.isBooleanOperator(e.operator)?g.getBoolNumberType():g.getDefaultNumberType(),d={category:i.Value,type:u};return l.setBinaryOperationDataForNode(e,{castLeftFromType:void 0,castRightFromType:void 0}),d;case p.ParseNodeType.ParenthesizedExpression:return this._validateSubexpressionType(e.expression,t,n,r);case p.ParseNodeType.ArrayAccess:var h=c.ExpressionEvaluator.evaluateConstantExpression(e.index,t),f=this.getTypeOfExpression(e.array,t,n);if(h.errorReported||f.errorReported)return;return f.category!==g.TypeCategory.Array?void t.onError("Value is not an array",e.array):h.category===g.TypeCategory.Number&&Number.isInteger(h.value)?h.value<0?void t.onError("Index cannot be negative",e.index):h.value>=f.length?void t.onError("Index "+h.value+" is out of range for array; maximum allowed index is "+(f.length-1),e.index):d={category:i.Value,type:f.baseType}:void t.onError("Index must be an integer value",e.index);case p.ParseNodeType.FunctionCall:return this._getTypeOfFunctionCall(e,t);case p.ParseNodeType.UnaryOperation:var T=this.getTypeOfExpression(e.operand,t,n);return T.category!==g.TypeCategory.Number?void this._reportOperatorNotNumberError(T,e.operand,t):(d={category:i.Value,type:g.getDefaultNumberType()},l.setUnaryOperationDataForNode(e,{castFromType:void 0}),d);case p.ParseNodeType.MemberAccess:return this._validateMemberAccessExpressionType(e,t,n);case p.ParseNodeType.Identifier:var v=this.resolveIdentifier(e,t);if(v){if(l.setIdentifierDataForNode(e,{symbolCategory:v.category,resolvedObject:v.resolvedObject}),v.category===m.SymbolCategory.Const){var _=v.resolvedObject;return d={category:i.Value,type:_.type},n||_.type.errorReported||!this.doesTypeContainString(_.type)||t.onError("Value that contains a string is not allowed in this context",e),l.setConstExpressionDataForNode(e,_.value),d}if(v.category===m.SymbolCategory.Var||v.category===m.SymbolCategory.Param){var C=v.resolvedObject;return t.symbolTable.isSymbolAssigned(v.name,v.resolvedObject)||t.onError("Variable is used before being assigned",e),{category:i.Value,type:C.type}}if(v.category===m.SymbolCategory.Namespace){var b=v.resolvedObject;return{category:i.Namespace,namespace:b,namespaceContext:t.createNewContext(b.symbolTable)}}if(v.category===m.SymbolCategory.Type){var k=v.resolvedObject;return{category:i.Type,type:k.type}}if(v.category===m.SymbolCategory.Function){var S=v.resolvedObject;return{category:i.Function,signatures:S.signatures}}t.onError("'"+e.text+"' refers to unexpected type",e)}return;case p.ParseNodeType.True:case p.ParseNodeType.False:case p.ParseNodeType.NumericLiteral:if(r&&r.category===g.TypeCategory.Number){var x=r,N=c.ExpressionEvaluator.evaluateConstantExpression(e,t);if(this._isNumberValueAssignableToType(N,x))return{category:i.Value,type:r}}return u=e.type===p.ParseNodeType.NumericLiteral?g.getDefaultNumberType():g.getBoolNumberType(),{category:i.Value,type:u};case p.ParseNodeType.StringLiteral:if(n||t.onError("String value is not allowed in this context",e),r&&r.category===g.TypeCategory.String){var R=r;if(N=c.ExpressionEvaluator.evaluateConstantExpression(e,t),this._isStringValueAssignableToType(N,R))return{category:i.Value,type:r}}return{category:i.Value,type:g.getDefaultStringType()};case p.ParseNodeType.ArrayLiteral:var E,P=!1;r&&r.category===g.TypeCategory.Array&&(E=r.baseType);var w,D=e.values.map((function(e){var r=o.getTypeOfExpression(e,t,n,E);return r.errorReported&&(P=!0),r}));if(0===e.values.length&&(t.onError("Array literal must include at least one element",e),P=!0),P)return;if(D.forEach((function(n,r){if(0===r&&(w=n),!P&&r>0){var i=o.getCommonType(w,n);i?w=i:(t.onError("All elements in array must be the same type",e.values[r]),P=!0)}})),!w||P)return;return f={category:g.TypeCategory.Array,errorReported:P,baseType:w,length:D.length},{category:i.Value,type:f};case p.ParseNodeType.StructLiteral:var F=!1,O=r&&r.category===g.TypeCategory.Struct?r:void 0,I=new Map;O&&O.fields.forEach((function(e){I.set(e.name,e.type)})),O&&l.setStructLiteralDataForNode(e,{expectedType:O});var A=[];e.fields.forEach((function(e){var r=o.getTypeOfExpression(e.value,t,n,I.get(e.name.text));A.push({name:e.name.text,type:r})})),0===e.fields.length&&(t.onError("Struct literal must define at least one field",e),F=!0);var L={category:g.TypeCategory.Struct,errorReported:F,fields:A};return{category:i.Value,type:L};case p.ParseNodeType.ExpressionError:return}},e._validateMemberAccessExpressionType=function(e,t,n){var r=this._validateSubexpressionType(e.leftExpression,t,n);if(r){if(r.category===i.Namespace){var o=r;l.setMemberAccessDataForNode(e,{baseNamespace:o.namespace});var a=this._validateSubexpressionType(e.identifier,o.namespaceContext,n);return a&&a.category===i.Value&&c.ExpressionEvaluator.evaluateConstantExpression(e,t),a}if(r.category!==i.Type){if(r.category===i.Value){if(p=(y=r).type,l.setMemberAccessDataForNode(e,{baseType:p}),p.category!==g.TypeCategory.Struct)return void t.onError("Field '"+e.identifier.text+"' is unknown",e.identifier);var s=p.fields.find((function(t){return t.name===e.identifier.text}));if(!s)return void t.onError("Field '"+e.identifier.text+"' is unknown",e.identifier);var u={category:i.Value,type:s.type};return l.setIdentifierDataForNode(e.identifier,{symbolCategory:m.SymbolCategory.Field,documentation:s.documentation,fieldType:s.type}),u}t.onError("Unexpected expression type",e.leftExpression)}else{var p=r.type;if(l.setMemberAccessDataForNode(e,{baseType:p}),p.category===g.TypeCategory.Number){if(p.enumeratedConstraint&&(h=p.enumeratedConstraint.items.find((function(t){return t.name===e.identifier.text})))){var d={category:g.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[h]}},y={category:i.Value,type:d};return l.setConstExpressionDataForNode(e,{category:g.TypeCategory.Number,value:h.value,errorReported:!1}),y}}else if(p.category===g.TypeCategory.String){var h;if(p.enumeratedConstraint&&(h=p.enumeratedConstraint.items.find((function(t){return t.name===e.identifier.text})))){d={category:g.TypeCategory.String,errorReported:!1,enumeratedConstraint:{items:[h]}};y={category:i.Value,type:d};return l.setConstExpressionDataForNode(e,{category:g.TypeCategory.String,value:h.value,errorReported:!1}),y}}t.onError("Identifier cannot be used in expression",e.identifier)}}},e._isNumberValueAssignableToType=function(e,t){var n=!0,r=this.synthesizeConstraintForNumberType(t);return r.enumeratedConstraint?r.enumeratedConstraint.items.find((function(t){return t.value===e.value}))||(n=!1):r.rangeConstraint&&(this._isValueInRange(e.value,r.rangeConstraint)||(n=!1)),n},e._isStringValueAssignableToType=function(e,t){var n=!0;return t.enumeratedConstraint&&(t.enumeratedConstraint.items.find((function(t){return t.value===e.value}))||(n=!1)),n},e._isArrayValueAssignableToType=function(e,t){var n=this,r=!0;return e.value.forEach((function(e){e.errorReported||n.isValueAssignableToType(e,t.baseType)||(r=!1)})),0===t.length?0===e.value.length&&(r=!1):t.length!==e.value.length&&(r=!1),r},e._isStructValueAssignableToType=function(e,t){var n=this,r=!0,o=new Map,i=new Map;t.fields.forEach((function(e){o.set(e.name,e),i.set(e.name,!0)})),e.value.forEach((function(t,a){var s=e.value.get(a);s.errorReported||(o.has(a)&&n.isValueAssignableToType(s,o.get(a).type)||(r=!1),i.delete(a))}));var a=[];return i.forEach((function(e,t){a.push(t)})),void 0===a.find((function(e){return!o.get(e).optional}))&&r},e._resolveSpecializedType=function(e,t){var n=this.getTypeOfTypeNode(e.baseType,t,!0);if(n.errorReported)return n;switch(n.category){case g.TypeCategory.Number:var r=n;return e.specialization.type===p.ParseNodeType.TypeArgumentsList&&(2!==e.specialization.typeArguments.length||e.specialization.typeArguments[0].argumentName||e.specialization.hangingComma||t.onWarning("Did you mean to specify a range? If so, use a '..' operator. If you intended to specify a two-element enumerated value constraint, add a hanging comma after the second element to suppress this warning.",e.specialization)),this._resolveNumberConstraint(r,e.specialization,t);case g.TypeCategory.String:return e.specialization.type===p.ParseNodeType.DotRange?(t.onError("Dot range constraint not allowed for string type",e.specialization),n):this._resolveStringConstraint(n,e.specialization,t);case g.TypeCategory.Struct:return t.onError("Type arguments not allowed for struct types",e.specialization),n;case g.TypeCategory.Array:return t.onError("Type arguments not allowed for array types",e.specialization),n;case g.TypeCategory.Complex:var o=n;return e.specialization.type===p.ParseNodeType.DotRange?(t.onError("Dot range not allowed for specialization of complex types",e.specialization),n):o.typeArguments.length>0?(t.onError("Type arguments not allowed for specialized complex type",e.specialization),n):this._resolveComplexSpecializedType(o,e.specialization,t)}},e._resolveNumberConstraint=function(e,t,n){var r,o,i=!1,a=this.synthesizeConstraintForNumberType(e);return t.type===p.ParseNodeType.DotRange?a.enumeratedConstraint?(n.onError("A range constraint cannot further constrain an enumerated constraint type",t),o=a.enumeratedConstraint):a.rangeConstraint&&(r=this._evaluateRangeConstraint(t,n))&&(i=this._validateRangeConsistentWithNumberConstraint(r,a.rangeConstraint,t,n))&&!r.step&&(r.step=a.rangeConstraint.step):(o=this._evaluateEnumeratedConstraint(t,g.TypeCategory.Number,n))&&(a.enumeratedConstraint?i=this._validateEnumerationConsistentWithEnumeration(t,o,a.enumeratedConstraint,n):a.rangeConstraint&&(i=this._validateEnumerationConsistentWithRange(t,o,a.rangeConstraint,n))),i||(r=e.rangeConstraint,o=e.enumeratedConstraint),{category:g.TypeCategory.Number,errorReported:!i,rangeConstraint:r,enumeratedConstraint:o}},e._validateRangeConsistentWithNumberConstraint=function(e,t,n,r){return this._isValueInRange(e.start,t)?e.stop<t.start||e.stop>t.stop?(r&&n&&r.onError("Constraint must further restrict type; stop value incorrect",n.stop),!1):!e.step||!t.step||e.step%t.step==0||(r&&n&&r.onError("Constraint must further restrict type; step value must be integer multiple",n.step),!1):(r&&n&&r.onError("Constraint must further restrict type; start value incorrect",n.start),!1)},e._evaluateRangeConstraint=function(e,t){var n=c.ExpressionEvaluator.evaluateConstantExpression(e.start,t),r=c.ExpressionEvaluator.evaluateConstantExpression(e.stop,t);if(!n.errorReported&&!r.errorReported)if(n.category===g.TypeCategory.Number){if(r.category===g.TypeCategory.Number){var o;if(e.step&&(o=c.ExpressionEvaluator.evaluateConstantExpression(e.step,t)),o){if(o.errorReported)return;if(o.category!==g.TypeCategory.Number||o.value<=0)return void t.onError("Step value must be a positive value",e.step)}return{start:n.value,stop:r.value,step:o?o.value:void 0}}t.onError("Stop value must be a number",e.stop)}else t.onError("Start value must be a number",e.start)},e._evaluateEnumeratedConstraint=function(e,t,n){var r=this;if(0!==e.typeArguments.length){var o,i=!!e.typeArguments[0].argumentName,a=e.typeArguments.map((function(e){var t=r.getTypeOfTypeNode(e.argumentType,n);if(t.category===g.TypeCategory.Number){var o=t;if(o.enumeratedConstraint&&1===o.enumeratedConstraint.items.length)return{category:g.TypeCategory.Number,value:o.enumeratedConstraint.items[0].value,errorReported:!1}}else if(t.category===g.TypeCategory.String){var i=t;if(i.enumeratedConstraint&&1===i.enumeratedConstraint.items.length)return{category:g.TypeCategory.String,value:i.enumeratedConstraint.items[0].value,errorReported:!1}}return t.errorReported||n.onError("An enumerated constraint must be a constant expression",e.argumentType),{category:g.TypeCategory.Number,value:0,errorReported:!0}})),s=new Map,c=!0;if(a.forEach((function(r,a){if(!r.errorReported)if(r.category!==t)n.onError("Expressions in enumerated constraint must evaluate to a numeric value",e.typeArguments[a].argumentType),c=!1;else{var u=r.value;if(void 0!==o&&!i){var l=e.typeArguments[a].argumentName;l&&(n.onError("Items in ordinal enumerated constraint cannot have names",l),c=!1),o>u&&(n.onError("Items in ordinal enumerated constraint must be in increasing order",e.typeArguments[a].argumentType),c=!1)}o=u,u==u&&(s.has(u)&&(n.onError("Values of items in enumerated constraint must be unique",e.typeArguments[a].argumentType),c=!1),s.set(u,r))}})),i){var u=new Map;e.typeArguments.forEach((function(e){e.argumentName?(u.has(e.argumentName.text)&&n.onError("Items in a nominal enumerated constraint must have unique names",e.argumentName),u.set(e.argumentName.text,e)):(n.onError("Items in a nominal enumerated constraint must all have names",e),c=!1)}))}if(c)return{items:a.map((function(t,n){return{name:e.typeArguments[n].argumentName?e.typeArguments[n].argumentName.text:void 0,value:t.value}}))}}else n.onError("An enumerated constraint requires at least one value",e)},e._validateEnumerationConsistentWithEnumeration=function(e,t,n,r){var o=!0;return t.items.forEach((function(t,i){var a=n.items.find((function(e){return e.value===t.value}));if(a)t.name&&a.name&&t.name!==a.name&&(r.onError("Item name does not match name in base type's constraint",e.typeArguments[i]),o=!1);else{var s="";"string"==typeof t.value?s=y.Tokenizer.encodeStringLiteral(t.value):"number"==typeof t.value&&(s=d.printValueSinglePrecision(t.value)),r.onError("Value "+s+" is not within base type's constraint",e.typeArguments[i]),o=!1}})),o},e._validateEnumerationConsistentWithRange=function(e,t,n,r){var o=this,i=!0;return t.items.forEach((function(t,a){o._isValueInRange(t.value,n)||(r.onError("Value "+d.printValueSinglePrecision(t.value)+" is not within base type's constraint",e.typeArguments[a].argumentType),i=!1)})),i},e._resolveStringConstraint=function(e,t,n){var r,o=!1;return(r=this._evaluateEnumeratedConstraint(t,g.TypeCategory.String,n))&&e.enumeratedConstraint&&(this._validateEnumerationConsistentWithEnumeration(t,r,e.enumeratedConstraint,n)||(o=!0)),o&&(r=e.enumeratedConstraint),{category:g.TypeCategory.String,errorReported:o,enumeratedConstraint:r}},e._resolveMemberAccess=function(e,t){var n=this._validateSubexpressionType(e.leftExpression,t,!0);if(!n)return this.getDummyType();if(n.category===i.Namespace){var r=n;return l.setMemberAccessDataForNode(e,{baseNamespace:r.namespace}),this.getTypeOfTypeNode(e.identifier,r.namespaceContext)}if(n.category===i.Type){var o=n.type,a=e.identifier.text;if(l.setMemberAccessDataForNode(e,{baseType:o}),o.category===g.TypeCategory.Number){if(o.enumeratedConstraint&&(s=o.enumeratedConstraint.items.find((function(e){return e.name===a}))))return{category:g.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[s]}}}else if(o.category===g.TypeCategory.String){var s;if(o.enumeratedConstraint&&(s=o.enumeratedConstraint.items.find((function(e){return e.name===a}))))return{category:g.TypeCategory.String,errorReported:!1,enumeratedConstraint:{items:[s]}}}}return t.onError("'"+e.identifier.text+"' is unknown",e.identifier),this.getDummyType()},e._getSignatureForArguments=function(e,t){var n,r,i=this,a=function(e){if(e.parameters.length===t.length&&!t.some((function(t,n){return!i.isTypeAssignable(t,e.parameters[n].type,new s.DiagnosticAddendum)})))return{value:e}};try{for(var c=o(e),u=c.next();!u.done;u=c.next()){var l=a(u.value);if("object"==typeof l)return l.value}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}},e._getTypeOfFunctionCall=function(t,n){var r=this,o=this._validateSubexpressionType(t.callExpression,n,!0);if(o){var a=t.arguments.map((function(e){return r.getTypeOfExpression(e,n,!0)}));if(o.category===i.Function){var c=o,u=c.signatures.length>1?this._getSignatureForArguments(c.signatures,a):c.signatures[0];if(u){var p=u.parameters.length;if(p!==a.length)return void n.onError("Expected "+p+" argument"+(1===p?"":"s")+" but received "+a.length,t.callExpression);var d=a.map((function(e,o){var i=new s.DiagnosticAddendum,a=!1;if(!r.isTypeAssignable(e,u.parameters[o].type,i))if(r.isTypeCastable(e,u.parameters[o].type,new s.DiagnosticAddendum)){var c="Value will be cast to parameter type.";u.parameters[o].type.category===g.TypeCategory.Number&&(c+=" Rounding may occur."),n.onWarning(c+i.getString(),t.arguments[o]),a=!0}else n.onError("Argument "+(o+1)+" is not assignable to parameter '"+u.parameters[o].name+"'"+i.getString(),t.arguments[o]);return{castToType:u.parameters[o].type,castFromType:a?e:void 0}}));l.setFunctionCallDataForNode(t,{isTypeConversion:!1,arguments:d})}else n.onError("Argument types do not match any declared function signatures",t.callExpression);return{category:i.Value,type:u?u.returnType:this.getDummyType()}}if(o.category===i.Type){var m=o;if(0===a.length)return void n.onError("Type cast operator takes one argument",t);if(a.length>1)return void n.onError("Type cast operator takes only one argument",t.arguments[1]);var y=new s.DiagnosticAddendum;return a[0].errorReported||e.isTypeCastable(a[0],m.type,y)?(l.setFunctionCallDataForNode(t,{isTypeConversion:!0,arguments:[]}),{category:i.Value,type:m.type}):void n.onError("Type of argument cannot be be cast to specified type"+y.getString(),t.arguments[0])}n.onError("Expected function identifier",t)}},e._resolveTypeIdentifier=function(e,t){var n=this.resolveIdentifier(e,t);return n?(l.setIdentifierDataForNode(e,{symbolCategory:n.category,resolvedObject:n.resolvedObject}),n.category===m.SymbolCategory.Type?this._getTypeForTypeSymbol(n,t):n.category===m.SymbolCategory.Const?this._resolveShorthandConstrainedType(e,t):(t.onError("Expected type or const identifier",e),this.getDummyType())):this.getDummyType()},e._validateGenericTypeArg=function(e,t,n,r){var o=this;if(t.validateExactMatch&&!t.validationTypes.find((function(t){return o.isTypeSame(e,t)})))return r.onError("Specified type is not supported for this type parameter",n),!1;if(t.validateMustConstrain&&!t.validationTypes.find((function(t){return o.isTypeAssignable(e,t,new s.DiagnosticAddendum)})))return r.onError("Specified type is not supported for this type parameter",n),!1;if(t.validateSingleValue){var i=!1;if(e.category===g.TypeCategory.Number){var a=e;a.enumeratedConstraint&&1===a.enumeratedConstraint.items.length&&(i=!0)}if(!i)return r.onError("Expected number value for this type parameter",n),!1}return!0},e._resolveComplexSpecializedType=function(e,t,n){var r=this,o=!1,i=-1,a=!1,s=new Map;t.typeArguments.forEach((function(t,r){if(t.argumentName){var c=t.argumentName.text;a=!0,s.has(c)&&!o?(n.onError("Type argument names must be unique",t.argumentName),o=!0):e.typeParameters.find((function(e){return e.name===c}))||(n.onError("Unknown type parameter '"+c+"'",t.argumentName),o=!0),s.set(t.argumentName.text,t)}else i=r,a&&!o&&(n.onError("Unnamed type argument cannot appear after named argument",t),o=!0),r<e.typeParameters.length&&s.set(e.typeParameters[r].name,t)}));var c=e.typeParameters.length;i+1>c&&(n.onError("Expected "+c+" type parameter"+(1===c?"":"s")+" but received "+(i+1),t.typeArguments[i]),o=!0);var u=[];return e.typeParameters.forEach((function(e,a){var c,l=t;a<=i?(c=r.getTypeOfTypeNode(t.typeArguments[a].argumentType,n),l=t.typeArguments[a].argumentType):s.has(e.name)?(c=r.getTypeOfTypeNode(s.get(e.name).argumentType,n),l=s.get(e.name).argumentType):e.defaultType?c=e.defaultType:(o||(n.onError("Missing argument for parameter '"+e.name+"'",t),o=!0),c=r.getDummyType()),!o&&r._validateGenericTypeArg(c,e,l,n)||(o=!0),u.push(c)})),{category:g.TypeCategory.Complex,errorReported:o,usage:e.usage,internalClass:e.internalClass,typeParameters:e.typeParameters,typeArguments:u}},e._resolveArrayType=function(e,t){var n=c.ExpressionEvaluator.evaluateConstantExpression(e.length,t);n.errorReported||(n.category!==g.TypeCategory.Number?t.onError("Array length must be a numeric value",e.length):(Math.round(n.value)!==n.value||n.value<1)&&t.onError("Array length must be a positive integer value",e.length));var r=this.getTypeOfTypeNode(e.baseType,t);return{category:g.TypeCategory.Array,errorReported:n.errorReported||r.errorReported,baseType:r,length:n.errorReported||n.category!==g.TypeCategory.Number?1:n.value}},e._resolveStructType=function(e,t){var n=this,r={category:g.TypeCategory.Struct,errorReported:!1,fields:[]},o=new Map;return e.fields.forEach((function(e){var i;o.has(e.name.text)?(t.onError("Field names in struct must be unique",e),r.errorReported=!0):(o.set(e.name.text,e),(i=n.getTypeOfTypeNode(e.fieldType,t))?r.fields.push({name:e.name.text,type:i,documentation:a.getDocumentationFromComments(e.comments)}):r.errorReported=!0),l.setIdentifierDataForNode(e.name,{symbolCategory:m.SymbolCategory.Field,documentation:e.comments.length>0?a.getDocumentationFromComments(e.comments):void 0,fieldType:i})})),r.errorReported||0!==e.fields.length||(t.onError("Struct type must define at least one field",e),r.errorReported=!0),r},e._resolvePrimitiveType=function(e){return e.type===p.ParseNodeType.Number?g.getDefaultNumberType():g.getDefaultStringType()},e._resolveShorthandConstrainedType=function(e,t){var n=c.ExpressionEvaluator.evaluateConstantExpression(e,t);return n.errorReported?this.getDummyType():n.category===g.TypeCategory.Number?{category:g.TypeCategory.Number,errorReported:!1,enumeratedConstraint:{items:[{value:n.value}]}}:n.category===g.TypeCategory.String?{category:g.TypeCategory.String,errorReported:!1,enumeratedConstraint:{items:[{value:n.value}]}}:(t.onError("Invalid expression for type definition",e),this.getDummyType())},e._handleCircularTypeReference=function(e,t,n){var r=e?e.category:"";return r===m.SymbolCategory.Function?n.onError("Recursive function call not allowed",t):r===m.SymbolCategory.Type?n.onError("Circular type definition not allowed",t):r===m.SymbolCategory.Const&&n.onError("Circular reference not allowed",t),this.getDummyType()},e._isValueInRange=function(e,t){if(e<t.start||e>t.stop)return!1;if(void 0!==t.step){var n=(e-t.start)/t.step;if(Math.floor(n)!==n)return!1}return!0},e._getTypeForTypeSymbol=function(e,t){return t.resolveSymbol(e).type},e}();t.TypeChecker=h},7379:(e,t)=>{var n,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.getBoolNumberType=t.getDefaultStringType=t.getDefaultNumberType=t.maxNumberValue=t.minNumberValue=t.ComplexTypeClass=t.ComplexTypeUsage=t.TypeCategory=void 0,function(e){e[e.Number=0]="Number",e[e.String=1]="String",e[e.Array=2]="Array",e[e.Struct=3]="Struct",e[e.Complex=4]="Complex"}(n=t.TypeCategory||(t.TypeCategory={})),(o=t.ComplexTypeUsage||(t.ComplexTypeUsage={}))[o.None=0]="None",o[o.GraphInput=1]="GraphInput",o[o.LearnedConceptInput=2]="LearnedConceptInput",o[o.NonLearnedConceptInput=4]="NonLearnedConceptInput",o[o.ConceptOutput=8]="ConceptOutput",o[o.SourceState=16]="SourceState",o[o.SourceConfig=32]="SourceConfig",o[o.SourceAction=64]="SourceAction",o[o.GoalAtom=128]="GoalAtom",(r=t.ComplexTypeClass||(t.ComplexTypeClass={})).ImageGray="ImageGray",r.ImageRGB="ImageRGB",r.GoalTargetRegion="GoalTargetRegion",t.minNumberValue=-340282347e30,t.maxNumberValue=340282347e30,t.getDefaultNumberType=function(){return{category:n.Number,errorReported:!1}},t.getDefaultStringType=function(){return{category:n.String,errorReported:!1}},t.getBoolNumberType=function(){return{category:n.Number,errorReported:!1,enumeratedConstraint:{items:[{name:"False",value:0},{name:"True",value:1}]}}}},6704:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unicodePc=t.unicodeNd=t.unicodeMc=t.unicodeMn=t.unicodeNl=t.unicodeLm=t.unicodeLo=t.unicodeLt=t.unicodeLl=t.unicodeLu=void 0,t.unicodeLu=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11310],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,[65313,65338],[66560,66599],[66736,66771],[68736,68786],[71840,71871],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],t.unicodeLl=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11358],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,2581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,43002,[43824,43866],[43872,43877],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[68800,68850],[71872,71903],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[125218,125251]],t.unicodeLt=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],t.unicodeLo=[170,186,443,[448,451],660,[1488,1514],[1520,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2208,2228],[2230,2237],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,3294,[3296,3297],[3313,3314],[3333,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3719,3720],3722,3725,[3732,3735],[3737,3743],[3745,3747],3749,3751,[3754,3755],[3757,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4304,4346],[4349,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5900],[5902,5905],[5920,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6263],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6987],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7409],[7413,7414],[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12590],[12593,12686],[12704,12730],[12784,12799],[13312,19893],[19968,40938],[40960,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,43261,[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68147],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[69635,69687],[69763,69807],[69840,69864],[69891,69926],[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],[71424,71449],71935,72192,[72203,72242],72250,72272,[72284,72323],[72326,72329],[72384,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73728,74649],[74880,75075],[77824,78894],[82944,83526],[92160,92728],[92736,92766],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94020],94032,[94208,100332],[100352,101106],[110592,110878],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173782],[173824,177972],[177984,178205],[178208,183969],[183984,191456],[194560,195101]],t.unicodeLm=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],65392,[65438,65439],[92992,92995],[94099,94111],[94176,94177]],t.unicodeNl=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],t.unicodeMn=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,2902,[2914,2915],2946,3008,3021,3072,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3769],[3771,3772],[3784,3789],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7673],[7675,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],43452,43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],69633,[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70090,70092],[70191,70193],70196,[70198,70199],70206,70367,[70371,70378],[70400,70401],70460,70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[92912,92916],[92976,92982],[94095,94098],[113821,113822],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],[917760,917999]],t.unicodeMc=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,[7410,7411],7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43453,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,70018,[70067,70069],[70079,70080],[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[72199,72200],72249,[72279,72280],72343,72751,72766,72873,72881,72884,[94033,94078],[119141,119142],[119149,119154]],t.unicodeNd=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72784,72793],[73040,73049],[92768,92777],[93008,93017],[120782,120831],[125264,125273]],t.unicodePc=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343]},1570:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionStatementCategory=void 0,(n=t.FunctionStatementCategory||(t.FunctionStatementCategory={}))[n.Return=0]="Return",n[n.VarDeclaration=1]="VarDeclaration",n[n.IfElse=2]="IfElse",n[n.VarAssignment=3]="VarAssignment"},3870:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.ProgressType=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.RAL=void 0,t.CancellationStrategy=void 0;const r=n(839);Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return r.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return r.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return r.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return r.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return r.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return r.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return r.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return r.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return r.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return r.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return r.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return r.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return r.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return r.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return r.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return r.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return r.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return r.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return r.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return r.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return r.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return r.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return r.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return r.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return r.ParameterStructures}});const o=n(3911);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const i=n(7135);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return i.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return i.Emitter}});const a=n(3881);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const s=n(6525);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return s.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return s.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return s.ReadableStreamMessageReader}});const c=n(6654);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=n(1343);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return u.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return u.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return u.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return u.createMessageConnection}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return u.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return u.Trace}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return u.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return u.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return u.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return u.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return u.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return u.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return u.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return u.CancellationStrategy}});const l=n(147);t.RAL=l.default},3881:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const r=n(147),o=n(7574),i=n(7135);var a;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:i.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:i.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||o.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(a=t.CancellationToken||(t.CancellationToken={}));const s=Object.freeze((function(e,t){const n=r.default().timer.setTimeout(e.bind(t),0);return{dispose(){r.default().timer.clearTimeout(n)}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?s:(this._emitter||(this._emitter=new i.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=a.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=a.None}}},1343:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.Trace=t.NullLogger=t.ProgressType=void 0;const r=n(147),o=n(7574),i=n(839),a=n(6184),s=n(7135),c=n(3881);var u,l,p,d,m,y,g,h,f,T,v,_,C;!function(e){e.type=new i.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.type=new i.NotificationType("$/progress")}(l||(l={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return o.func(e)}}(p||(p={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(d=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!o.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(d=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(m=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTrace")}(y=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTrace")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(h=t.ConnectionErrors||(t.ConnectionErrors={}));class b extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,b.prototype)}}t.ConnectionError=b,function(e){e.is=function(e){const t=e;return t&&o.func(t.cancelUndispatched)}}(f=t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){const t=e;return t&&o.func(t.createCancellationTokenSource)}}(T=t.CancellationReceiverStrategy||(t.CancellationReceiverStrategy={})),function(e){e.Message=Object.freeze({sendCancellation(e,t){e.sendNotification(u.type,{id:t})},cleanup(e){}}),e.is=function(e){const t=e;return t&&o.func(t.sendCancellation)&&o.func(t.cleanup)}}(v=t.CancellationSenderStrategy||(t.CancellationSenderStrategy={})),function(e){e.Message=Object.freeze({receiver:T.Message,sender:v.Message}),e.is=function(e){const t=e;return t&&T.is(t.receiver)&&v.is(t.sender)}}(_=t.CancellationStrategy||(t.CancellationStrategy={})),(t.ConnectionOptions||(t.ConnectionOptions={})).is=function(e){const t=e;return t&&(_.is(t.cancellationStrategy)||f.is(t.connectionStrategy))},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(C||(C={})),t.createMessageConnection=function(e,n,f,T){const v=void 0!==f?f:t.NullLogger;let k=0,S=0,x=0;const N="2.0";let R;const E=Object.create(null);let P;const w=Object.create(null),D=new Map;let F,O,I=new a.LinkedMap,A=Object.create(null),L=Object.create(null),M=d.Off,j=m.Text,q=C.New;const V=new s.Emitter,W=new s.Emitter,U=new s.Emitter,z=new s.Emitter,B=new s.Emitter,G=T&&T.cancellationStrategy?T.cancellationStrategy:_.Message;function H(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function K(e){}function $(){return q===C.Listening}function J(){return q===C.Closed}function X(){return q===C.Disposed}function Y(){q!==C.New&&q!==C.Listening||(q=C.Closed,W.fire(void 0))}function Q(){F||0===I.size||(F=r.default().timer.setImmediate((()=>{F=void 0,function(){if(0===I.size)return;const e=I.shift();try{i.isRequestMessage(e)?function(e){if(X())return;function t(t,r,o){const a={jsonrpc:N,id:e.id};t instanceof i.ResponseError?a.error=t.toJson():a.result=void 0===t?null:t,ee(a,r,o),n.write(a)}function r(t,r,o){const i={jsonrpc:N,id:e.id,error:t.toJson()};ee(i,r,o),n.write(i)}!function(e){if(M!==d.Off&&O)if(j===m.Text){let t;M===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),O.log(`Received request '${e.method} - (${e.id})'.`,t)}else te("receive-request",e)}(e);const a=E[e.method];let s,c;a&&(s=a.type,c=a.handler);const u=Date.now();if(c||R){const a=String(e.id),l=G.receiver.createCancellationTokenSource(a);L[a]=l;try{let p;if(c)if(void 0===e.params){if(void 0!==s&&0!==s.numberOfParams)return void r(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines ${s.numberOfParams} params but recevied none.`),e.method,u);p=c(l.token)}else if(Array.isArray(e.params)){if(void 0!==s&&s.parameterStructures===i.ParameterStructures.byName)return void r(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,u);p=c(...e.params,l.token)}else{if(void 0!==s&&s.parameterStructures===i.ParameterStructures.byPosition)return void r(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,u);p=c(e.params,l.token)}else R&&(p=R(e.method,e.params,l.token));const d=p;p?d.then?d.then((n=>{delete L[a],t(n,e.method,u)}),(t=>{delete L[a],t instanceof i.ResponseError?r(t,e.method,u):t&&o.string(t.message)?r(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):r(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(delete L[a],t(p,e.method,u)):(delete L[a],function(t,r,o){void 0===t&&(t=null);const i={jsonrpc:N,id:e.id,result:t};ee(i,r,o),n.write(i)}(p,e.method,u))}catch(n){delete L[a],n instanceof i.ResponseError?t(n,e.method,u):n&&o.string(n.message)?r(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,u):r(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else r(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):i.isNotificationMessage(e)?function(e){if(X())return;let t,n;if(e.method===u.type.method)n=e=>{const t=e.id,n=L[String(t)];n&&n.cancel()};else{const r=w[e.method];r&&(n=r.handler,t=r.type)}if(n||P)try{!function(e){if(M!==d.Off&&O&&e.method!==g.type.method)if(j===m.Text){let t;M===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),O.log(`Received notification '${e.method}'.`,t)}else te("receive-notification",e)}(e),n?void 0===e.params?(void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==i.ParameterStructures.byName&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but recevied none.`),n()):Array.isArray(e.params)?(void 0!==t&&(t.parameterStructures===i.ParameterStructures.byName&&v.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&v.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${e.params.length} argumennts`)),n(...e.params)):(void 0!==t&&t.parameterStructures===i.ParameterStructures.byPosition&&v.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params)):P&&P(e.method,e.params)}catch(t){t.message?v.error(`Notification handler '${e.method}' failed with message: ${t.message}`):v.error(`Notification handler '${e.method}' failed unexpectedly.`)}else U.fire(e)}(e):i.isResponseMessage(e)?function(e){if(!X())if(null===e.id)e.error?v.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):v.error("Received response message without id. No further error information provided.");else{const t=String(e.id),n=A[t];if(function(e,t){if(M!==d.Off&&O)if(j===m.Text){let n;if(M===d.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const r=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";O.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${r}`,n)}else O.log(`Received response ${e.id} without active response promise.`,n)}else te("receive-response",e)}(e,n),n){delete A[t];try{if(e.error){const t=e.error;n.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?v.error(`Response handler '${n.method}' failed with message: ${e.message}`):v.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void v.error("Received empty message.");v.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(o.string(t.id)||o.number(t.id)){const e=String(t.id),n=A[e];n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{Q()}}()})))}e.onClose(Y),e.onError((function(e){V.fire([e,void 0,void 0])})),n.onClose(Y),n.onError((function(e){V.fire(e)}));const Z=e=>{try{if(i.isNotificationMessage(e)&&e.method===u.type.method){const t=H(e.params.id),r=I.get(t);if(i.isRequestMessage(r)){const o=null==T?void 0:T.connectionStrategy,i=o&&o.cancelUndispatched?o.cancelUndispatched(r,K):void 0;if(i&&(void 0!==i.error||void 0!==i.result))return I.delete(t),i.id=r.id,ee(i,e.method,Date.now()),void n.write(i)}}!function(e,t){var n;i.isRequestMessage(t)?e.set(H(t.id),t):i.isResponseMessage(t)?e.set(null===(n=t.id)?"res-unknown-"+(++x).toString():"res-"+n.toString(),t):e.set("not-"+(++S).toString(),t)}(I,e)}finally{Q()}};function ee(e,t,n){if(M!==d.Off&&O)if(j===m.Text){let r;M===d.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),O.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,r)}else te("send-response",e)}function te(e,t){if(!O||M===d.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};O.log(n)}function ne(){if(J())throw new b(h.Closed,"Connection is closed.");if(X())throw new b(h.Disposed,"Connection is disposed.")}function re(e){return void 0===e?null:e}function oe(e){return null===e?void 0:e}function ie(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function ae(e,t){switch(e){case i.ParameterStructures.auto:return ie(t)?oe(t):[re(t)];case i.ParameterStructures.byName:if(!ie(t))throw new Error("Recevied parameters by name but param is not an object literal.");return oe(t);case i.ParameterStructures.byPosition:return[re(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function se(e,t){let n;const r=e.numberOfParams;switch(r){case 0:n=void 0;break;case 1:n=ae(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<r;e++)n.push(re(t[e]));if(t.length<r)for(let e=t.length;e<r;e++)n.push(null)}return n}const ce={sendNotification:(e,...t)=>{let r,a;if(ne(),o.string(e)){r=e;const n=t[0];let o=0,s=i.ParameterStructures.auto;i.ParameterStructures.is(n)&&(o=1,s=n);let c=t.length;const u=c-o;switch(u){case 0:a=void 0;break;case 1:a=ae(s,t[o]);break;default:if(s===i.ParameterStructures.byName)throw new Error(`Recevied ${u} parameters for 'by Name' notification parameter structure.`);a=t.slice(o,c).map((e=>re(e)))}}else{const n=t;r=e.method,a=se(e,n)}const s={jsonrpc:N,method:r,params:a};!function(e){if(M!==d.Off&&O)if(j===m.Text){let t;M===d.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),O.log(`Sending notification '${e.method}'.`,t)}else te("send-notification",e)}(s),n.write(s)},onNotification:(e,t)=>{let n;return ne(),o.func(e)?P=e:t&&(o.string(e)?(n=e,w[e]={type:void 0,handler:t}):(n=e.method,w[e.method]={type:e,handler:t})),{dispose:()=>{void 0!==n?delete w[n]:P=void 0}}},onProgress:(e,t,n)=>{if(D.has(t))throw new Error(`Progress handler for token ${t} already registered`);return D.set(t,n),{dispose:()=>{D.delete(t)}}},sendProgress:(e,t,n)=>{ce.sendNotification(l.type,{token:t,value:n})},onUnhandledProgress:z.event,sendRequest:(e,...t)=>{let r,a,s;if(ne(),function(){if(!$())throw new Error("Call listen() first.")}(),o.string(e)){r=e;const n=t[0],o=t[t.length-1];let u=0,l=i.ParameterStructures.auto;i.ParameterStructures.is(n)&&(u=1,l=n);let p=t.length;c.CancellationToken.is(o)&&(p-=1,s=o);const d=p-u;switch(d){case 0:a=void 0;break;case 1:a=ae(l,t[u]);break;default:if(l===i.ParameterStructures.byName)throw new Error(`Recevied ${d} parameters for 'by Name' request parameter structure.`);a=t.slice(u,p).map((e=>re(e)))}}else{const n=t;r=e.method,a=se(e,n);const o=e.numberOfParams;s=c.CancellationToken.is(n[o])?n[o]:void 0}const u=k++;let l;return s&&(l=s.onCancellationRequested((()=>{G.sender.sendCancellation(ce,u)}))),new Promise(((e,t)=>{const o={jsonrpc:N,id:u,method:r,params:a};let s={method:r,timerStart:Date.now(),resolve:t=>{e(t),G.sender.cleanup(u),null==l||l.dispose()},reject:e=>{t(e),G.sender.cleanup(u),null==l||l.dispose()}};!function(e){if(M!==d.Off&&O)if(j===m.Text){let t;M===d.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),O.log(`Sending request '${e.method} - (${e.id})'.`,t)}else te("send-request",e)}(o);try{n.write(o)}catch(e){s.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),s=null}s&&(A[String(u)]=s)}))},onRequest:(e,t)=>{ne();let n=null;return p.is(e)?(n=void 0,R=e):o.string(e)?(n=null,void 0!==t&&(n=e,E[e]={handler:t,type:void 0})):void 0!==t&&(n=e.method,E[e.method]={type:e,handler:t}),{dispose:()=>{null!==n&&(void 0!==n?delete E[n]:R=void 0)}}},trace:(e,t,n)=>{let r=!1,i=m.Text;void 0!==n&&(o.boolean(n)?r=n:(r=n.sendNotification||!1,i=n.traceFormat||m.Text)),M=e,j=i,O=M===d.Off?void 0:t,!r||J()||X()||ce.sendNotification(y.type,{value:d.toString(e)})},onError:V.event,onClose:W.event,onUnhandledNotification:U.event,onDispose:B.event,end:()=>{n.end()},dispose:()=>{if(X())return;q=C.Disposed,B.fire(void 0);const t=new Error("Connection got disposed.");Object.keys(A).forEach((e=>{A[e].reject(t)})),A=Object.create(null),L=Object.create(null),I=new a.LinkedMap,o.func(n.dispose)&&n.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{ne(),function(){if($())throw new b(h.AlreadyListening,"Connection is already listening")}(),q=C.Listening,e.listen(Z)},inspect:()=>{r.default().console.log("inspect")}};return ce.onNotification(g.type,(e=>{M!==d.Off&&O&&O.log(e.message,M===d.Verbose?e.verbose:void 0)})),ce.onNotification(l.type,(e=>{const t=D.get(e.token);t?t(e.value):z.fire(e)})),ce}},3911:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}}},7135:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const r=n(147);!function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class o{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let r=0,o=this._callbacks.length;r<o;r++)if(this._callbacks[r]===e){if(this._contexts[r]===t)return this._callbacks.splice(r,1),void this._contexts.splice(r,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),o=this._contexts.slice(0);for(let i=0,a=n.length;i<a;i++)try{t.push(n[i].apply(o[i],e))}catch(e){r.default().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class i{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),r.dispose=i._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=i,i._noop=function(){}},7574:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))}},6184:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(n=t.Touch||(t.Touch={}));class r{constructor(){this[Symbol.toStringTag]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=n.None){const r=this._map.get(e);if(r)return t!==n.None&&this.touch(r,t),r.value}set(e,t,r=n.None){let o=this._map.get(e);if(o)o.value=t,r!==n.None&&this.touch(o,r);else{switch(o={key:e,value:t,next:void 0,previous:void 0},r){case n.None:this.addItemLast(o);break;case n.First:this.addItemFirst(o);break;case n.Last:default:this.addItemLast(o)}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.key,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return r}values(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:n.value,done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this._state;let n=this._head;const r={[Symbol.iterator]:()=>r,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){const e={value:[n.key,n.value],done:!1};return n=n.next,e}return{value:void 0,done:!0}}};return r}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===n.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=r,t.LRUCache=class extends r{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=n.AsNew){return super.get(e,t)}peek(e){return super.get(e,n.None)}set(e,t){return super.set(e,t,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},5530:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(0===this._chunks.length)return;let e=0,t=0,n=0,r=0;e:for(;t<this._chunks.length;){const o=this._chunks[t];for(n=0;n<o.length;){switch(o[n]){case 13:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case 10:switch(e){case 1:e=2;break;case 3:e=4,n++;break e;default:e=0}break;default:e=0}n++}r+=o.byteLength,t++}if(4!==e)return;const o=this._read(r+n),i=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return i;for(let e=0;e<a.length-2;e++){const t=a[e],n=t.indexOf(":");if(-1===n)throw new Error("Message header must separate key and value using :");const r=t.substr(0,n),o=t.substr(n+1).trim();i.set(r,o)}return i}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const r=this._chunks[0];if(r.byteLength>e){const o=r.slice(0,e);t.set(o,n),n+=e,this._chunks[0]=r.slice(e),this._totalLength-=e,e-=e}else t.set(r,n),n+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,e-=r.byteLength}return t}}},6525:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const r=n(147),o=n(7574),i=n(7135);var a;(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&o.func(t.listen)&&o.func(t.dispose)&&o.func(t.onError)&&o.func(t.onClose)&&o.func(t.onPartialMessage)};class s{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter,this.partialMessageEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=s,function(e){e.fromOptions=function(e){var t;let n,o;const i=new Map;let a;const s=new Map;if(void 0===e||"string"==typeof e)n=null!=e?e:"utf-8";else{if(n=null!==(t=e.charset)&&void 0!==t?t:"utf-8",void 0!==e.contentDecoder&&(o=e.contentDecoder,i.set(o.name,o)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)i.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(a=e.contentTypeDecoder,s.set(a.name,a)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===a&&(a=r.default().applicationJson.decoder,s.set(a.name,a)),{charset:n,contentDecoder:o,contentDecoders:i,contentTypeDecoder:a,contentTypeDecoders:s}}}(a||(a={})),t.ReadableStreamMessageReader=class extends s{constructor(e,t){super(),this.readable=e,this.options=a.fromOptions(t),this.buffer=r.default().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders();if(!e)return;const t=e.get("Content-Length");if(!t)throw new Error("Header must provide a Content-Length property.");const n=parseInt(t);if(isNaN(n))throw new Error("Content-Length value must be a number.");this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();let t;this.clearPartialMessageTimer(),this.nextMessageLength=-1,t=void 0!==this.options.contentDecoder?this.options.contentDecoder.decode(e):Promise.resolve(e),t.then((e=>{this.options.contentTypeDecoder.decode(e,this.options).then((e=>{this.callback(e)}),(e=>{this.fireError(e)}))}),(e=>{this.fireError(e)}))}}clearPartialMessageTimer(){this.partialMessageTimer&&(r.default().timer.clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=r.default().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},6654:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const r=n(147),o=n(7574),i=n(142),a=n(7135);var s;(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&o.func(t.dispose)&&o.func(t.onClose)&&o.func(t.onError)&&o.func(t.write)};class c{constructor(){this.errorEmitter=new a.Emitter,this.closeEmitter=new a.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${o.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=c,function(e){e.fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:r.default().applicationJson.encoder}:{charset:null!==(t=e.charset)&&void 0!==t?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!==(n=e.contentTypeEncoder)&&void 0!==n?n:r.default().applicationJson.encoder}}}(s||(s={})),t.WriteableStreamMessageWriter=class extends c{constructor(e,t){super(),this.writable=e,this.options=s.fromOptions(t),this.errorCount=0,this.writeSemaphore=new i.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},839:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isResponseMessage=t.isNotificationMessage=t.isRequestMessage=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const r=n(7574);var o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=e.jsonrpcReservedErrorRangeStart,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=e.jsonrpcReservedErrorRangeEnd}(o=t.ErrorCodes||(t.ErrorCodes={}));class i extends Error{constructor(e,t,n){super(t),this.code=r.number(e)?e:o.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,i.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=i;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class s{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=s,t.RequestType0=class extends s{constructor(e){super(e,0)}},t.RequestType=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends s{constructor(e){super(e,2)}},t.RequestType3=class extends s{constructor(e){super(e,3)}},t.RequestType4=class extends s{constructor(e){super(e,4)}},t.RequestType5=class extends s{constructor(e){super(e,5)}},t.RequestType6=class extends s{constructor(e){super(e,6)}},t.RequestType7=class extends s{constructor(e){super(e,7)}},t.RequestType8=class extends s{constructor(e){super(e,8)}},t.RequestType9=class extends s{constructor(e){super(e,9)}},t.NotificationType=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends s{constructor(e){super(e,0)}},t.NotificationType1=class extends s{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends s{constructor(e){super(e,2)}},t.NotificationType3=class extends s{constructor(e){super(e,3)}},t.NotificationType4=class extends s{constructor(e){super(e,4)}},t.NotificationType5=class extends s{constructor(e){super(e,5)}},t.NotificationType6=class extends s{constructor(e){super(e,6)}},t.NotificationType7=class extends s{constructor(e){super(e,7)}},t.NotificationType8=class extends s{constructor(e){super(e,8)}},t.NotificationType9=class extends s{constructor(e){super(e,9)}},t.isRequestMessage=function(e){const t=e;return t&&r.string(t.method)&&(r.string(t.id)||r.number(t.id))},t.isNotificationMessage=function(e){const t=e;return t&&r.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(r.string(t.id)||r.number(t.id)||null===t.id)}},147:(e,t)=>{let n;function r(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(r||(r={})),t.default=r},142:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const r=n(147);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&r.default().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},4389:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.createServerSocketTransport=t.createClientSocketTransport=t.createServerPipeTransport=t.createClientPipeTransport=t.generateRandomPipeName=t.StreamMessageWriter=t.StreamMessageReader=t.SocketMessageWriter=t.SocketMessageReader=t.IPCMessageWriter=t.IPCMessageReader=void 0;const i=n(3034);i.default.install();const a=n(3870),s=n(5622),c=n(2087),u=n(6417),l=n(1631);o(n(3870),t);class p extends a.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){return this.process.on("message",e),a.Disposable.create((()=>this.process.off("message",e)))}}t.IPCMessageReader=p;class d extends a.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){try{return"function"==typeof this.process.send&&this.process.send(e,void 0,void 0,(t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0})),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.IPCMessageWriter=d;class m extends a.ReadableStreamMessageReader{constructor(e,t="utf-8"){super(i.default().stream.asReadableStream(e),t)}}t.SocketMessageReader=m;class y extends a.WriteableStreamMessageWriter{constructor(e,t){super(i.default().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}}t.SocketMessageWriter=y;class g extends a.ReadableStreamMessageReader{constructor(e,t){super(i.default().stream.asReadableStream(e),t)}}t.StreamMessageReader=g;class h extends a.WriteableStreamMessageWriter{constructor(e,t){super(i.default().stream.asWritableStream(e),t)}}t.StreamMessageWriter=h;const f=process.env.XDG_RUNTIME_DIR,T=new Map([["linux",107],["darwin",103]]);t.generateRandomPipeName=function(){const e=u.randomBytes(21).toString("hex");if("win32"===process.platform)return`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`;let t;t=f?s.join(f,`vscode-ipc-${e}.sock`):s.join(c.tmpdir(),`vscode-${e}.sock`);const n=T.get(process.platform);return void 0!==n&&t.length>=n&&i.default().console.warn(`WARNING: IPC handle "${t}" is longer than ${n} characters.`),t},t.createClientPipeTransport=function(e,t="utf-8"){let n;const r=new Promise(((e,t)=>{n=e}));return new Promise(((o,i)=>{let a=l.createServer((e=>{a.close(),n([new m(e,t),new y(e,t)])}));a.on("error",i),a.listen(e,(()=>{a.removeListener("error",i),o({onConnected:()=>r})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const n=l.createConnection(e);return[new m(n,t),new y(n,t)]},t.createClientSocketTransport=function(e,t="utf-8"){let n;const r=new Promise(((e,t)=>{n=e}));return new Promise(((o,i)=>{const a=l.createServer((e=>{a.close(),n([new m(e,t),new y(e,t)])}));a.on("error",i),a.listen(e,"127.0.0.1",(()=>{a.removeListener("error",i),o({onConnected:()=>r})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const n=l.createConnection(e,"127.0.0.1");return[new m(n,t),new y(n,t)]},t.createMessageConnection=function(e,t,n,r){n||(n=a.NullLogger);const o=function(e){const t=e;return void 0!==t.read&&void 0!==t.addListener}(e)?new g(e):e,i=function(e){const t=e;return void 0!==t.write&&void 0!==t.addListener}(t)?new h(t):t;return a.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),a.createMessageConnection(o,i,n,r)}},3034:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(147),o=n(1669),i=n(3911),a=n(5530);class s extends a.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return s.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new o.TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}}s.emptyBuffer=Buffer.allocUnsafe(0);class c{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),i.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),i.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),i.Disposable.create((()=>this.stream.off("end",e)))}onData(e){return this.stream.on("data",e),i.Disposable.create((()=>this.stream.off("data",e)))}}class u{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),i.Disposable.create((()=>this.stream.off("close",e)))}onError(e){return this.stream.on("error",e),i.Disposable.create((()=>this.stream.off("error",e)))}onEnd(e){return this.stream.on("end",e),i.Disposable.create((()=>this.stream.off("end",e)))}write(e,t){return new Promise(((n,r)=>{const o=e=>{null==e?n():r(e)};"string"==typeof e?this.stream.write(e,t,o):this.stream.write(e,o)}))}end(){this.stream.end()}}const l=Object.freeze({messageBuffer:Object.freeze({create:e=>new s(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(e,void 0,0),t.charset))}catch(e){return Promise.reject(e)}}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{try{return e instanceof Buffer?Promise.resolve(JSON.parse(e.toString(t.charset))):Promise.resolve(JSON.parse(new o.TextDecoder(t.charset).decode(e)))}catch(e){return Promise.reject(e)}}})}),stream:Object.freeze({asReadableStream:e=>new c(e),asWritableStream:e=>new u(e)}),console,timer:Object.freeze({setTimeout:(e,t,...n)=>setTimeout(e,t,...n),clearTimeout(e){clearTimeout(e)},setImmediate:(e,...t)=>setImmediate(e,...t),clearImmediate(e){clearImmediate(e)}})});function p(){return l}!function(e){e.install=function(){r.default.install(l)}}(p||(p={})),t.default=p},5028:(e,t,n)=>{e.exports=n(4389)},1661:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,o(n(4389),t),o(n(1674),t),o(n(6140),t),o(n(542),t);var i,a=n(3767);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return a.createProtocolConnection}}),(i=t.LSPErrorCodes||(t.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,i.ContentModified=-32801,i.RequestCancelled=-32800,i.lspReservedErrorRangeEnd=-32800},3767:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(4389);t.createProtocolConnection=function(e,t,n,o){return r.ConnectionStrategy.is(o)&&(o={connectionStrategy:o}),r.createMessageConnection(e,t,n,o)}},6140:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=void 0;const r=n(4389);t.RegistrationType=class{constructor(e){this.method=e}};class o extends r.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=o;class i extends r.RequestType{constructor(e){super(e,r.ParameterStructures.byName)}}t.ProtocolRequestType=i;class a extends r.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class s extends r.NotificationType{constructor(e){super(e,r.ParameterStructures.byName)}}t.ProtocolNotificationType=s},2918:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const r=n(6140);var o,i,a;(a=t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",a.type=new r.ProtocolRequestType(a.method),(i=t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",i.type=new r.ProtocolRequestType(i.method),(o=t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",o.type=new r.ProtocolRequestType(o.method)},3390:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const r=n(6140);var o;(o=t.DocumentColorRequest||(t.DocumentColorRequest={})).method="textDocument/documentColor",o.type=new r.ProtocolRequestType(o.method),(t.ColorPresentationRequest||(t.ColorPresentationRequest={})).type=new r.ProtocolRequestType("textDocument/colorPresentation")},5934:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const r=n(6140);(t.ConfigurationRequest||(t.ConfigurationRequest={})).type=new r.ProtocolRequestType("workspace/configuration")},764:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const r=n(6140);var o;(o=t.DeclarationRequest||(t.DeclarationRequest={})).method="textDocument/declaration",o.type=new r.ProtocolRequestType(o.method)},7846:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const r=n(6140);var o,i,a,s,c,u,l;(l=t.FileOperationPatternKind||(t.FileOperationPatternKind={})).file="file",l.folder="folder",(u=t.WillCreateFilesRequest||(t.WillCreateFilesRequest={})).method="workspace/willCreateFiles",u.type=new r.ProtocolRequestType(u.method),(c=t.DidCreateFilesNotification||(t.DidCreateFilesNotification={})).method="workspace/didCreateFiles",c.type=new r.ProtocolNotificationType(c.method),(s=t.WillRenameFilesRequest||(t.WillRenameFilesRequest={})).method="workspace/willRenameFiles",s.type=new r.ProtocolRequestType(s.method),(a=t.DidRenameFilesNotification||(t.DidRenameFilesNotification={})).method="workspace/didRenameFiles",a.type=new r.ProtocolNotificationType(a.method),(i=t.DidDeleteFilesNotification||(t.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",i.type=new r.ProtocolNotificationType(i.method),(o=t.WillDeleteFilesRequest||(t.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",o.type=new r.ProtocolRequestType(o.method)},3394:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRequest=t.FoldingRangeKind=void 0;const r=n(6140);var o,i;(i=t.FoldingRangeKind||(t.FoldingRangeKind={})).Comment="comment",i.Imports="imports",i.Region="region",(o=t.FoldingRangeRequest||(t.FoldingRangeRequest={})).method="textDocument/foldingRange",o.type=new r.ProtocolRequestType(o.method)},2122:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const r=n(6140);var o;(o=t.ImplementationRequest||(t.ImplementationRequest={})).method="textDocument/implementation",o.type=new r.ProtocolRequestType(o.method)},542:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeError=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.DocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=void 0;const r=n(9533),o=n(6140),i=n(2122);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return i.ImplementationRequest}});const a=n(1589);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const s=n(9795);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return s.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return s.DidChangeWorkspaceFoldersNotification}});const c=n(5934);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return c.ConfigurationRequest}});const u=n(3390);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return u.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return u.ColorPresentationRequest}});const l=n(3394);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return l.FoldingRangeRequest}});const p=n(764);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return p.DeclarationRequest}});const d=n(5206);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return d.SelectionRangeRequest}});const m=n(1862);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return m.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return m.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return m.WorkDoneProgressCancelNotification}});const y=n(2918);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return y.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return y.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return y.CallHierarchyPrepareRequest}});const g=n(9434);Object.defineProperty(t,"SemanticTokenTypes",{enumerable:!0,get:function(){return g.SemanticTokenTypes}}),Object.defineProperty(t,"SemanticTokenModifiers",{enumerable:!0,get:function(){return g.SemanticTokenModifiers}}),Object.defineProperty(t,"SemanticTokens",{enumerable:!0,get:function(){return g.SemanticTokens}}),Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return g.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return g.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return g.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return g.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return g.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return g.SemanticTokensRegistrationType}});const h=n(5726);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return h.ShowDocumentRequest}});const f=n(6305);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return f.LinkedEditingRangeRequest}});const T=n(7846);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return T.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return T.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return T.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return T.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return T.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return T.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return T.WillDeleteFilesRequest}});const v=n(3443);var _,C,b,k,S,x,N,R,E,P,w,D,F,O,I,A,L,M,j,q,V,W,U,z,B,G,H,K,$,J,X,Y,Q,Z,ee,te,ne,re,oe,ie;Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return v.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return v.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return v.MonikerRequest}}),function(e){e.is=function(e){const t=e;return r.string(t.language)||r.string(t.scheme)||r.string(t.pattern)}}(_=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!r.string(t)&&!_.is(t))return!1;return!0}}(C=t.DocumentSelector||(t.DocumentSelector={})),(t.RegistrationRequest||(t.RegistrationRequest={})).type=new o.ProtocolRequestType("client/registerCapability"),(t.UnregistrationRequest||(t.UnregistrationRequest={})).type=new o.ProtocolRequestType("client/unregisterCapability"),(ie=t.ResourceOperationKind||(t.ResourceOperationKind={})).Create="create",ie.Rename="rename",ie.Delete="delete",(oe=t.FailureHandlingKind||(t.FailureHandlingKind={})).Abort="abort",oe.Transactional="transactional",oe.TextOnlyTransactional="textOnlyTransactional",oe.Undo="undo",(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})).hasId=function(e){const t=e;return t&&r.string(t.id)&&t.id.length>0},(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})).is=function(e){const t=e;return t&&(null===t.documentSelector||C.is(t.documentSelector))},(re=t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})).is=function(e){const t=e;return r.objectLiteral(t)&&(void 0===t.workDoneProgress||r.boolean(t.workDoneProgress))},re.hasWorkDoneProgress=function(e){const t=e;return t&&r.boolean(t.workDoneProgress)},(t.InitializeRequest||(t.InitializeRequest={})).type=new o.ProtocolRequestType("initialize"),(t.InitializeError||(t.InitializeError={})).unknownProtocolVersion=1,(t.InitializedNotification||(t.InitializedNotification={})).type=new o.ProtocolNotificationType("initialized"),(t.ShutdownRequest||(t.ShutdownRequest={})).type=new o.ProtocolRequestType0("shutdown"),(t.ExitNotification||(t.ExitNotification={})).type=new o.ProtocolNotificationType0("exit"),(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeConfiguration"),(ne=t.MessageType||(t.MessageType={})).Error=1,ne.Warning=2,ne.Info=3,ne.Log=4,(t.ShowMessageNotification||(t.ShowMessageNotification={})).type=new o.ProtocolNotificationType("window/showMessage"),(t.ShowMessageRequest||(t.ShowMessageRequest={})).type=new o.ProtocolRequestType("window/showMessageRequest"),(t.LogMessageNotification||(t.LogMessageNotification={})).type=new o.ProtocolNotificationType("window/logMessage"),(t.TelemetryEventNotification||(t.TelemetryEventNotification={})).type=new o.ProtocolNotificationType("telemetry/event"),(te=t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})).None=0,te.Full=1,te.Incremental=2,(ee=t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",ee.type=new o.ProtocolNotificationType(ee.method),(Z=t.TextDocumentContentChangeEvent||(t.TextDocumentContentChangeEvent={})).isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},Z.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength},(Q=t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})).method="textDocument/didChange",Q.type=new o.ProtocolNotificationType(Q.method),(Y=t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})).method="textDocument/didClose",Y.type=new o.ProtocolNotificationType(Y.method),(X=t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})).method="textDocument/didSave",X.type=new o.ProtocolNotificationType(X.method),(J=t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})).Manual=1,J.AfterDelay=2,J.FocusOut=3,($=t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})).method="textDocument/willSave",$.type=new o.ProtocolNotificationType($.method),(K=t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",K.type=new o.ProtocolRequestType(K.method),(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})).type=new o.ProtocolNotificationType("workspace/didChangeWatchedFiles"),(H=t.FileChangeType||(t.FileChangeType={})).Created=1,H.Changed=2,H.Deleted=3,(G=t.WatchKind||(t.WatchKind={})).Create=1,G.Change=2,G.Delete=4,(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})).type=new o.ProtocolNotificationType("textDocument/publishDiagnostics"),(B=t.CompletionTriggerKind||(t.CompletionTriggerKind={})).Invoked=1,B.TriggerCharacter=2,B.TriggerForIncompleteCompletions=3,(z=t.CompletionRequest||(t.CompletionRequest={})).method="textDocument/completion",z.type=new o.ProtocolRequestType(z.method),(U=t.CompletionResolveRequest||(t.CompletionResolveRequest={})).method="completionItem/resolve",U.type=new o.ProtocolRequestType(U.method),(W=t.HoverRequest||(t.HoverRequest={})).method="textDocument/hover",W.type=new o.ProtocolRequestType(W.method),(V=t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})).Invoked=1,V.TriggerCharacter=2,V.ContentChange=3,(q=t.SignatureHelpRequest||(t.SignatureHelpRequest={})).method="textDocument/signatureHelp",q.type=new o.ProtocolRequestType(q.method),(j=t.DefinitionRequest||(t.DefinitionRequest={})).method="textDocument/definition",j.type=new o.ProtocolRequestType(j.method),(M=t.ReferencesRequest||(t.ReferencesRequest={})).method="textDocument/references",M.type=new o.ProtocolRequestType(M.method),(L=t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})).method="textDocument/documentHighlight",L.type=new o.ProtocolRequestType(L.method),(A=t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})).method="textDocument/documentSymbol",A.type=new o.ProtocolRequestType(A.method),(I=t.CodeActionRequest||(t.CodeActionRequest={})).method="textDocument/codeAction",I.type=new o.ProtocolRequestType(I.method),(O=t.CodeActionResolveRequest||(t.CodeActionResolveRequest={})).method="codeAction/resolve",O.type=new o.ProtocolRequestType(O.method),(F=t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})).method="workspace/symbol",F.type=new o.ProtocolRequestType(F.method),(D=t.CodeLensRequest||(t.CodeLensRequest={})).method="textDocument/codeLens",D.type=new o.ProtocolRequestType(D.method),(w=t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})).method="codeLens/resolve",w.type=new o.ProtocolRequestType(w.method),(P=t.CodeLensRefreshRequest||(t.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",P.type=new o.ProtocolRequestType0(P.method),(E=t.DocumentLinkRequest||(t.DocumentLinkRequest={})).method="textDocument/documentLink",E.type=new o.ProtocolRequestType(E.method),(R=t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})).method="documentLink/resolve",R.type=new o.ProtocolRequestType(R.method),(N=t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})).method="textDocument/formatting",N.type=new o.ProtocolRequestType(N.method),(x=t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",x.type=new o.ProtocolRequestType(x.method),(S=t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",S.type=new o.ProtocolRequestType(S.method),(t.PrepareSupportDefaultBehavior||(t.PrepareSupportDefaultBehavior={})).Identifier=1,(k=t.RenameRequest||(t.RenameRequest={})).method="textDocument/rename",k.type=new o.ProtocolRequestType(k.method),(b=t.PrepareRenameRequest||(t.PrepareRenameRequest={})).method="textDocument/prepareRename",b.type=new o.ProtocolRequestType(b.method),(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})).type=new o.ProtocolRequestType("workspace/executeCommand"),(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={})).type=new o.ProtocolRequestType("workspace/applyEdit")},6305:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const r=n(6140);var o;(o=t.LinkedEditingRangeRequest||(t.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",o.type=new r.ProtocolRequestType(o.method)},3443:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const r=n(6140);var o,i,a;(a=t.UniquenessLevel||(t.UniquenessLevel={})).document="document",a.project="project",a.group="group",a.scheme="scheme",a.global="global",(i=t.MonikerKind||(t.MonikerKind={})).import="import",i.export="export",i.local="local",(o=t.MonikerRequest||(t.MonikerRequest={})).method="textDocument/moniker",o.type=new r.ProtocolRequestType(o.method)},1862:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const r=n(4389),o=n(6140);var i;(i=t.WorkDoneProgress||(t.WorkDoneProgress={})).type=new r.ProgressType,i.is=function(e){return e===i.type},(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})).type=new o.ProtocolRequestType("window/workDoneProgress/create"),(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={})).type=new o.ProtocolNotificationType("window/workDoneProgress/cancel")},5206:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const r=n(6140);var o;(o=t.SelectionRangeRequest||(t.SelectionRangeRequest={})).method="textDocument/selectionRange",o.type=new r.ProtocolRequestType(o.method)},9434:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=void 0;const r=n(6140);var o,i,a,s,c,u,l;(l=t.SemanticTokenTypes||(t.SemanticTokenTypes={})).namespace="namespace",l.type="type",l.class="class",l.enum="enum",l.interface="interface",l.struct="struct",l.typeParameter="typeParameter",l.parameter="parameter",l.variable="variable",l.property="property",l.enumMember="enumMember",l.event="event",l.function="function",l.method="method",l.macro="macro",l.keyword="keyword",l.modifier="modifier",l.comment="comment",l.string="string",l.number="number",l.regexp="regexp",l.operator="operator",(u=t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})).declaration="declaration",u.definition="definition",u.readonly="readonly",u.static="static",u.deprecated="deprecated",u.abstract="abstract",u.async="async",u.modification="modification",u.documentation="documentation",u.defaultLibrary="defaultLibrary",(t.SemanticTokens||(t.SemanticTokens={})).is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])},(t.TokenFormat||(t.TokenFormat={})).Relative="relative",(c=t.SemanticTokensRegistrationType||(t.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",c.type=new r.RegistrationType(c.method),(s=t.SemanticTokensRequest||(t.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",s.type=new r.ProtocolRequestType(s.method),(a=t.SemanticTokensDeltaRequest||(t.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",a.type=new r.ProtocolRequestType(a.method),(i=t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",i.type=new r.ProtocolRequestType(i.method),(o=t.SemanticTokensRefreshRequest||(t.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",o.type=new r.ProtocolRequestType0(o.method)},5726:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const r=n(6140);var o;(o=t.ShowDocumentRequest||(t.ShowDocumentRequest={})).method="window/showDocument",o.type=new r.ProtocolRequestType(o.method)},1589:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const r=n(6140);var o;(o=t.TypeDefinitionRequest||(t.TypeDefinitionRequest={})).method="textDocument/typeDefinition",o.type=new r.ProtocolRequestType(o.method)},9795:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const r=n(6140);(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})).type=new r.ProtocolRequestType0("workspace/workspaceFolders"),(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={})).type=new r.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")},9533:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},273:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const i=n(5028);o(n(5028),t),o(n(1661),t),t.createProtocolConnection=function(e,t,n,r){return i.createMessageConnection(e,t,n,r)}},6560:(e,t,n)=>{e.exports=n(273)},1674:(e,t,n)=>{var r,o,i,a,s,c,u,l,p,d,m,y,g,h,f,T,v,_,C,b,k,S,x,N,R,E;n.r(t),n.d(t,{integer:()=>r,uinteger:()=>o,Position:()=>i,Range:()=>a,Location:()=>s,LocationLink:()=>c,Color:()=>u,ColorInformation:()=>l,ColorPresentation:()=>p,FoldingRangeKind:()=>d,FoldingRange:()=>m,DiagnosticRelatedInformation:()=>y,DiagnosticSeverity:()=>g,DiagnosticTag:()=>h,CodeDescription:()=>f,Diagnostic:()=>T,Command:()=>v,TextEdit:()=>_,ChangeAnnotation:()=>C,ChangeAnnotationIdentifier:()=>b,AnnotatedTextEdit:()=>k,TextDocumentEdit:()=>S,CreateFile:()=>x,RenameFile:()=>N,DeleteFile:()=>R,WorkspaceEdit:()=>E,WorkspaceChange:()=>se,TextDocumentIdentifier:()=>P,VersionedTextDocumentIdentifier:()=>w,OptionalVersionedTextDocumentIdentifier:()=>D,TextDocumentItem:()=>F,MarkupKind:()=>O,MarkupContent:()=>I,CompletionItemKind:()=>A,InsertTextFormat:()=>L,CompletionItemTag:()=>M,InsertReplaceEdit:()=>j,InsertTextMode:()=>q,CompletionItem:()=>V,CompletionList:()=>W,MarkedString:()=>U,Hover:()=>z,ParameterInformation:()=>B,SignatureInformation:()=>G,DocumentHighlightKind:()=>H,DocumentHighlight:()=>K,SymbolKind:()=>$,SymbolTag:()=>J,SymbolInformation:()=>X,DocumentSymbol:()=>Y,CodeActionKind:()=>Q,CodeActionContext:()=>Z,CodeAction:()=>ee,CodeLens:()=>te,FormattingOptions:()=>ne,DocumentLink:()=>re,SelectionRange:()=>oe,EOL:()=>ue,TextDocument:()=>ce}),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647}(r||(r={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647}(o||(o={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=o.MAX_VALUE),t===Number.MAX_VALUE&&(t=o.MAX_VALUE),{line:e,character:t}},e.is=function(e){var t=e;return le.objectLiteral(t)&&le.uinteger(t.line)&&le.uinteger(t.character)}}(i||(i={})),function(e){e.create=function(e,t,n,r){if(le.uinteger(e)&&le.uinteger(t)&&le.uinteger(n)&&le.uinteger(r))return{start:i.create(e,t),end:i.create(n,r)};if(i.is(e)&&i.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+n+", "+r+"]")},e.is=function(e){var t=e;return le.objectLiteral(t)&&i.is(t.start)&&i.is(t.end)}}(a||(a={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return le.defined(t)&&a.is(t.range)&&(le.string(t.uri)||le.undefined(t.uri))}}(s||(s={})),function(e){e.create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},e.is=function(e){var t=e;return le.defined(t)&&a.is(t.targetRange)&&le.string(t.targetUri)&&(a.is(t.targetSelectionRange)||le.undefined(t.targetSelectionRange))&&(a.is(t.originSelectionRange)||le.undefined(t.originSelectionRange))}}(c||(c={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){var t=e;return le.numberRange(t.red,0,1)&&le.numberRange(t.green,0,1)&&le.numberRange(t.blue,0,1)&&le.numberRange(t.alpha,0,1)}}(u||(u={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return a.is(t.range)&&u.is(t.color)}}(l||(l={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){var t=e;return le.string(t.label)&&(le.undefined(t.textEdit)||_.is(t))&&(le.undefined(t.additionalTextEdits)||le.typedArray(t.additionalTextEdits,_.is))}}(p||(p={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(d||(d={})),function(e){e.create=function(e,t,n,r,o){var i={startLine:e,endLine:t};return le.defined(n)&&(i.startCharacter=n),le.defined(r)&&(i.endCharacter=r),le.defined(o)&&(i.kind=o),i},e.is=function(e){var t=e;return le.uinteger(t.startLine)&&le.uinteger(t.startLine)&&(le.undefined(t.startCharacter)||le.uinteger(t.startCharacter))&&(le.undefined(t.endCharacter)||le.uinteger(t.endCharacter))&&(le.undefined(t.kind)||le.string(t.kind))}}(m||(m={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return le.defined(t)&&s.is(t.location)&&le.string(t.message)}}(y||(y={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(g||(g={})),function(e){e.Unnecessary=1,e.Deprecated=2}(h||(h={})),function(e){e.is=function(e){var t=e;return null!=t&&le.string(t.href)}}(f||(f={})),function(e){e.create=function(e,t,n,r,o,i){var a={range:e,message:t};return le.defined(n)&&(a.severity=n),le.defined(r)&&(a.code=r),le.defined(o)&&(a.source=o),le.defined(i)&&(a.relatedInformation=i),a},e.is=function(e){var t,n=e;return le.defined(n)&&a.is(n.range)&&le.string(n.message)&&(le.number(n.severity)||le.undefined(n.severity))&&(le.integer(n.code)||le.string(n.code)||le.undefined(n.code))&&(le.undefined(n.codeDescription)||le.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(le.string(n.source)||le.undefined(n.source))&&(le.undefined(n.relatedInformation)||le.typedArray(n.relatedInformation,y.is))}}(T||(T={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o={title:e,command:t};return le.defined(n)&&n.length>0&&(o.arguments=n),o},e.is=function(e){var t=e;return le.defined(t)&&le.string(t.title)&&le.string(t.command)}}(v||(v={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return le.objectLiteral(t)&&le.string(t.newText)&&a.is(t.range)}}(_||(_={})),function(e){e.create=function(e,t,n){var r={label:e};return void 0!==t&&(r.needsConfirmation=t),void 0!==n&&(r.description=n),r},e.is=function(e){var t=e;return void 0!==t&&le.objectLiteral(t)&&le.string(t.label)&&(le.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(le.string(t.description)||void 0===t.description)}}(C||(C={})),function(e){e.is=function(e){return"string"==typeof e}}(b||(b={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){var t=e;return _.is(t)&&(C.is(t.annotationId)||b.is(t.annotationId))}}(k||(k={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return le.defined(t)&&D.is(t.textDocument)&&Array.isArray(t.edits)}}(S||(S={})),function(e){e.create=function(e,t,n){var r={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){var t=e;return t&&"create"===t.kind&&le.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||le.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||le.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(x||(x={})),function(e){e.create=function(e,t,n,r){var o={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(o.options=n),void 0!==r&&(o.annotationId=r),o},e.is=function(e){var t=e;return t&&"rename"===t.kind&&le.string(t.oldUri)&&le.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||le.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||le.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(N||(N={})),function(e){e.create=function(e,t,n){var r={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){var t=e;return t&&"delete"===t.kind&&le.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||le.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||le.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||b.is(t.annotationId))}}(R||(R={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return le.string(e.kind)?x.is(e)||N.is(e)||R.is(e):S.is(e)})))}}(E||(E={}));var P,w,D,F,O,I,A,L,M,j,q,V,W,U,z,B,G,H,K,$,J,X,Y,Q,Z,ee,te,ne,re,oe,ie=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var r,o;if(void 0===n?r=_.insert(e,t):b.is(n)?(o=n,r=k.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),r=k.insert(e,t,o)),this.edits.push(r),void 0!==o)return o},e.prototype.replace=function(e,t,n){var r,o;if(void 0===n?r=_.replace(e,t):b.is(n)?(o=n,r=k.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),r=k.replace(e,t,o)),this.edits.push(r),void 0!==o)return o},e.prototype.delete=function(e,t){var n,r;if(void 0===t?n=_.del(e):b.is(t)?(r=t,n=k.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(t),n=k.del(e,r)),this.edits.push(n),void 0!==r)return r},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")},e}(),ae=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(b.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error("Id "+n+" is already in use.");if(void 0===t)throw new Error("No annotation provided for id "+n);return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),se=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new ae(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((function(e){if(S.is(e)){var n=new ie(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}}))):e.changes&&Object.keys(e.changes).forEach((function(n){var r=new ie(e.changes[n]);t._textEditChanges[n]=r}))):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(D.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version};if(!(r=this._textEditChanges[t.uri])){var n={textDocument:t,edits:o=[]};this._workspaceEdit.documentChanges.push(n),r=new ie(o,this._changeAnnotations),this._textEditChanges[t.uri]=r}return r}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var r;if(!(r=this._textEditChanges[e])){var o=[];this._workspaceEdit.changes[e]=o,r=new ie(o),this._textEditChanges[e]=r}return r},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new ae,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,o,i;if(C.is(t)||b.is(t)?r=t:n=t,void 0===r?o=x.create(e,n):(i=b.is(r)?r:this._changeAnnotations.manage(r),o=x.create(e,n,i)),this._workspaceEdit.documentChanges.push(o),void 0!==i)return i},e.prototype.renameFile=function(e,t,n,r){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var o,i,a;if(C.is(n)||b.is(n)?o=n:r=n,void 0===o?i=N.create(e,t,r):(a=b.is(o)?o:this._changeAnnotations.manage(o),i=N.create(e,t,r,a)),this._workspaceEdit.documentChanges.push(i),void 0!==a)return a},e.prototype.deleteFile=function(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var r,o,i;if(C.is(t)||b.is(t)?r=t:n=t,void 0===r?o=R.create(e,n):(i=b.is(r)?r:this._changeAnnotations.manage(r),o=R.create(e,n,i)),this._workspaceEdit.documentChanges.push(o),void 0!==i)return i},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return le.defined(t)&&le.string(t.uri)}}(P||(P={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return le.defined(t)&&le.string(t.uri)&&le.integer(t.version)}}(w||(w={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return le.defined(t)&&le.string(t.uri)&&(null===t.version||le.integer(t.version))}}(D||(D={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){var t=e;return le.defined(t)&&le.string(t.uri)&&le.string(t.languageId)&&le.integer(t.version)&&le.string(t.text)}}(F||(F={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(O||(O={})),function(e){e.is=function(t){var n=t;return n===e.PlainText||n===e.Markdown}}(O||(O={})),function(e){e.is=function(e){var t=e;return le.objectLiteral(e)&&O.is(t.kind)&&le.string(t.value)}}(I||(I={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(A||(A={})),function(e){e.PlainText=1,e.Snippet=2}(L||(L={})),function(e){e.Deprecated=1}(M||(M={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){var t=e;return t&&le.string(t.newText)&&a.is(t.insert)&&a.is(t.replace)}}(j||(j={})),function(e){e.asIs=1,e.adjustIndentation=2}(q||(q={})),function(e){e.create=function(e){return{label:e}}}(V||(V={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(W||(W={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return le.string(t)||le.objectLiteral(t)&&le.string(t.language)&&le.string(t.value)}}(U||(U={})),function(e){e.is=function(e){var t=e;return!!t&&le.objectLiteral(t)&&(I.is(t.contents)||U.is(t.contents)||le.typedArray(t.contents,U.is))&&(void 0===e.range||a.is(e.range))}}(z||(z={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(B||(B={})),function(e){e.create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o={label:e};return le.defined(t)&&(o.documentation=t),le.defined(n)?o.parameters=n:o.parameters=[],o}}(G||(G={})),function(e){e.Text=1,e.Read=2,e.Write=3}(H||(H={})),function(e){e.create=function(e,t){var n={range:e};return le.number(t)&&(n.kind=t),n}}(K||(K={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}($||($={})),function(e){e.Deprecated=1}(J||(J={})),function(e){e.create=function(e,t,n,r,o){var i={name:e,kind:t,location:{uri:r,range:n}};return o&&(i.containerName=o),i}}(X||(X={})),function(e){e.create=function(e,t,n,r,o,i){var a={name:e,detail:t,kind:n,range:r,selectionRange:o};return void 0!==i&&(a.children=i),a},e.is=function(e){var t=e;return t&&le.string(t.name)&&le.number(t.kind)&&a.is(t.range)&&a.is(t.selectionRange)&&(void 0===t.detail||le.string(t.detail))&&(void 0===t.deprecated||le.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(Y||(Y={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(Q||(Q={})),function(e){e.create=function(e,t){var n={diagnostics:e};return null!=t&&(n.only=t),n},e.is=function(e){var t=e;return le.defined(t)&&le.typedArray(t.diagnostics,T.is)&&(void 0===t.only||le.typedArray(t.only,le.string))}}(Z||(Z={})),function(e){e.create=function(e,t,n){var r={title:e},o=!0;return"string"==typeof t?(o=!1,r.kind=t):v.is(t)?r.command=t:r.edit=t,o&&void 0!==n&&(r.kind=n),r},e.is=function(e){var t=e;return t&&le.string(t.title)&&(void 0===t.diagnostics||le.typedArray(t.diagnostics,T.is))&&(void 0===t.kind||le.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||v.is(t.command))&&(void 0===t.isPreferred||le.boolean(t.isPreferred))&&(void 0===t.edit||E.is(t.edit))}}(ee||(ee={})),function(e){e.create=function(e,t){var n={range:e};return le.defined(t)&&(n.data=t),n},e.is=function(e){var t=e;return le.defined(t)&&a.is(t.range)&&(le.undefined(t.command)||v.is(t.command))}}(te||(te={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return le.defined(t)&&le.uinteger(t.tabSize)&&le.boolean(t.insertSpaces)}}(ne||(ne={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){var t=e;return le.defined(t)&&a.is(t.range)&&(le.undefined(t.target)||le.string(t.target))}}(re||(re={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var n=t;return void 0!==n&&a.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(oe||(oe={}));var ce,ue=["\n","\r\n","\r"];!function(e){function t(e,n){if(e.length<=1)return e;var r=e.length/2|0,o=e.slice(0,r),i=e.slice(r);t(o,n),t(i,n);for(var a=0,s=0,c=0;a<o.length&&s<i.length;){var u=n(o[a],i[s]);e[c++]=u<=0?o[a++]:i[s++]}for(;a<o.length;)e[c++]=o[a++];for(;s<i.length;)e[c++]=i[s++];return e}e.create=function(e,t,n,r){return new pe(e,t,n,r)},e.is=function(e){var t=e;return!!(le.defined(t)&&le.string(t.uri)&&(le.undefined(t.languageId)||le.string(t.languageId))&&le.uinteger(t.lineCount)&&le.func(t.getText)&&le.func(t.positionAt)&&le.func(t.offsetAt))},e.applyEdits=function(e,n){for(var r=e.getText(),o=t(n,(function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),i=r.length,a=o.length-1;a>=0;a--){var s=o[a],c=e.offsetAt(s.range.start),u=e.offsetAt(s.range.end);if(!(u<=i))throw new Error("Overlapping edit");r=r.substring(0,c)+s.newText+r.substring(u,r.length),i=c}return r}}(ce||(ce={}));var le,pe=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var o=t.charAt(r);n="\r"===o||"\n"===o,"\r"===o&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return i.create(0,e);for(;n<r;){var o=Math.floor((n+r)/2);t[o]>e?r=o:n=o+1}var a=n-1;return i.create(a,e-t[a])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,r){return"[object Number]"===t.call(e)&&n<=e&&e<=r},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(le||(le={}))},6265:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.SemanticTokensBuilder=void 0;const i=n(9817);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return i.SemanticTokensBuilder}}),o(n(273),t),o(n(9891),t),(t.ProposedFeatures||(t.ProposedFeatures={})).all={__brand:"features"}},7985:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const r=n(273);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>{this.connection.onRequest(r.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))},onIncomingCalls:e=>{const t=r.CallHierarchyIncomingCallsRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=r.CallHierarchyOutgoingCallsRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2507:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const r=n(273),o=n(289);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?o.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(r.ConfigurationRequest.type,t).then((t=>Array.isArray(e)?t:t[0]))}}},828:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const r=n(273);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){this.connection.onNotification(r.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){this.connection.onNotification(r.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){this.connection.onNotification(r.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(r.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(r.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(r.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},2776:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const r=n(273);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){this.connection.onRequest(r.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},8120:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const r=n(273);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=r.MonikerRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2731:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const r=n(273),o=n(7560);class i{constructor(e,t){this._connection=e,this._token=t,i.Instances.set(this._token,this)}begin(e,t,n,o){let i={kind:"begin",title:e,percentage:t,message:n,cancellable:o};this._connection.sendProgress(r.WorkDoneProgress.type,this._token,i)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(r.WorkDoneProgress.type,this._token,n)}done(){i.Instances.delete(this._token),this._connection.sendProgress(r.WorkDoneProgress.type,this._token,{kind:"end"})}}i.Instances=new Map;class a extends i{constructor(e,t){super(e,t),this._source=new r.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class s{constructor(){}begin(){}report(){}done(){}}class c extends s{constructor(){super(),this._source=new r.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var u;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new s;const n=t.workDoneToken;return delete t.workDoneToken,new i(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){var t;!0===(null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.workDoneProgress)&&(this._progressSupported=!0,this.connection.onNotification(r.WorkDoneProgressCancelNotification.type,(e=>{let t=i.Instances.get(e.token);(t instanceof a||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new s:new i(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=o.generateUuid();return this.connection.sendRequest(r.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new a(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new r.ProgressType}(u||(u={}));class l{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(u.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new l(e,n)}},9817:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensFeature=void 0;const r=n(273);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{on:e=>{const t=r.SemanticTokensRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=r.SemanticTokensDeltaRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=r.SemanticTokensRangeRequest.type;this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}},t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,r,o){let i=e,a=t;this._dataLen>0&&(i-=this._prevLine,0===i&&(a-=this._prevChar)),this._data[this._dataLen++]=i,this._data[this._dataLen++]=a,this._data[this._dataLen++]=n,this._data[this._dataLen++]=r,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){if(void 0!==this._prevData){const e=this._prevData.length,t=this._data.length;let n=0;for(;n<t&&n<e&&this._prevData[n]===this._data[n];)n++;if(n<t&&n<e){let r=0;for(;r<t&&r<e&&this._prevData[e-1-r]===this._data[t-1-r];)r++;const o=this._data.slice(n,t-r);return{resultId:this.id,edits:[{start:n,deleteCount:e-r-n,data:o}]}}return n<t?{resultId:this.id,edits:[{start:n,deleteCount:0,data:this._data.slice(n)}]}:n<e?{resultId:this.id,edits:[{start:n,deleteCount:e-n}]}:{resultId:this.id,edits:[]}}return this.build()}}},9891:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=t.TextDocuments=void 0;const r=n(273),o=n(289),i=n(7560),a=n(2731),s=n(2507),c=n(8634),u=n(7985),l=n(9817),p=n(5421),d=n(828),m=n(2776),y=n(8120);function g(e){if(null!==e)return e}t.TextDocuments=class{constructor(e){this._documents=Object.create(null),this._configuration=e,this._onDidChangeContent=new r.Emitter,this._onDidOpen=new r.Emitter,this._onDidClose=new r.Emitter,this._onDidSave=new r.Emitter,this._onWillSave=new r.Emitter}get onDidChangeContent(){return this._onDidChangeContent.event}get onDidOpen(){return this._onDidOpen.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._documents[e]}all(){return Object.keys(this._documents).map((e=>this._documents[e]))}keys(){return Object.keys(this._documents)}listen(e){e.__textDocumentSync=r.TextDocumentSyncKind.Full,e.onDidOpenTextDocument((e=>{let t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._documents[t.uri]=n;let r=Object.freeze({document:n});this._onDidOpen.fire(r),this._onDidChangeContent.fire(r)})),e.onDidChangeTextDocument((e=>{let t=e.textDocument,n=e.contentChanges;if(0===n.length)return;let r=this._documents[t.uri];const{version:o}=t;if(null==o)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);r=this._configuration.update(r,n,o),this._documents[t.uri]=r,this._onDidChangeContent.fire(Object.freeze({document:r}))})),e.onDidCloseTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&(delete this._documents[e.textDocument.uri],this._onDidClose.fire(Object.freeze({document:t})))})),e.onWillSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))})),e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._documents[e.textDocument.uri];return n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]})),e.onDidSaveTextDocument((e=>{let t=this._documents[e.textDocument.uri];t&&this._onDidSave.fire(Object.freeze({document:t}))}))}},t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class h{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(r.MessageType.Error,e)}warn(e){this.send(r.MessageType.Warning,e)}info(e){this.send(r.MessageType.Info,e)}log(e){this.send(r.MessageType.Log,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(r.LogMessageNotification.type,{type:e,message:t})}}const f=p.ShowDocumentFeature(a.ProgressFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:r.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(g)}showWarningMessage(e,...t){let n={type:r.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(g)}showInformationMessage(e,...t){let n={type:r.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(g)}}));(t.BulkRegistration||(t.BulkRegistration={})).create=function(){return new T};class T{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=o.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const r=i.generateUuid();this._registrations.push({id:r,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}(t.BulkUnregistration||(t.BulkUnregistration={})).create=function(){return new v(void 0,[])};class v{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(r.UnregistrationRequest.type,t).then(void 0,(e=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=o.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let i={unregisterations:[n]};return this._connection.sendRequest(r.UnregistrationRequest.type,i).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class _{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof T?this.registerMany(e):e instanceof v?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const a=o.string(t)?t:t.method,s=i.generateUuid();let c={registrations:[{id:s,method:a,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(r.RegistrationRequest.type,c).then((t=>(e.add({id:s,method:a}),e)),(e=>(this.connection.console.info(`Registering request handler for ${a} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=o.string(e)?e:e.method,a=i.generateUuid();let s={registrations:[{id:a,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(r.RegistrationRequest.type,s).then((e=>r.Disposable.create((()=>{this.unregisterSingle(a,n)}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(r.UnregistrationRequest.type,n).then(void 0,(t=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(r.RegistrationRequest.type,t).then((()=>new v(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const C=d.FileOperationsFeature(c.WorkspaceFoldersFeature(s.ConfigurationFeature(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(r.ApplyWorkspaceEditRequest.type,t)}})));class b{constructor(){this._trace=r.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==r.Trace.Off&&this.connection.sendNotification(r.LogTraceNotification.type,{message:e,verbose:this._trace===r.Trace.Verbose?t:void 0})}}class k{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(r.TelemetryEventNotification.type,e)}}class S{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return a.attachWorkDone(this.connection,e)}attachPartialResultProgress(e,t){return a.attachPartialResult(this.connection,t)}}t._LanguagesImpl=S;const x=y.MonikerFeature(m.LinkedEditingRangeFeature(l.SemanticTokensFeature(u.CallHierarchyFeature(S))));function N(e,t){return function(n){return t(e(n))}}function R(e,t){return function(n){return t(e(n))}}function E(e,t){return function(n){return t(e(n))}}function P(e,t){return function(n){return t(e(n))}}function w(e,t){return function(n){return t(e(n))}}function D(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=N,t.combineTelemetryFeatures=R,t.combineTracerFeatures=E,t.combineClientFeatures=P,t.combineWindowFeatures=w,t.combineWorkspaceFeatures=D,t.combineLanguagesFeatures=function(e,t){return function(n){return t(e(n))}},t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,N),tracer:n(e.tracer,t.tracer,E),telemetry:n(e.telemetry,t.telemetry,R),client:n(e.client,t.client,P),window:n(e.window,t.window,w),workspace:n(e.workspace,t.workspace,D)}},t.createConnection=function(e,t,n){const i=n&&n.console?new(n.console(h)):new h,s=e(i);i.rawAttach(s);const c=n&&n.tracer?new(n.tracer(b)):new b,u=n&&n.telemetry?new(n.telemetry(k)):new k,l=n&&n.client?new(n.client(_)):new _,p=n&&n.window?new(n.window(f)):new f,d=n&&n.workspace?new(n.workspace(C)):new C,m=n&&n.languages?new(n.languages(x)):new x,y=[i,c,u,l,p,d,m];function g(e){return e instanceof Promise?e:o.thenable(e)?new Promise(((t,n)=>{e.then((e=>t(e)),(e=>n(e)))})):Promise.resolve(e)}let T,v,S,N={listen:()=>s.listen(),sendRequest:(e,...t)=>s.sendRequest(o.string(e)?e:e.method,...t),onRequest:(e,t)=>s.onRequest(e,t),sendNotification:(e,t)=>{const n=o.string(e)?e:e.method;1===arguments.length?s.sendNotification(n):s.sendNotification(n,t)},onNotification:(e,t)=>s.onNotification(e,t),onProgress:s.onProgress,sendProgress:s.sendProgress,onInitialize:e=>v=e,onInitialized:e=>s.onNotification(r.InitializedNotification.type,e),onShutdown:e=>T=e,onExit:e=>S=e,get console(){return i},get telemetry(){return u},get tracer(){return c},get client(){return l},get window(){return p},get workspace(){return d},get languages(){return m},onDidChangeConfiguration:e=>s.onNotification(r.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>s.onNotification(r.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>s.onNotification(r.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>s.onNotification(r.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>s.onNotification(r.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>s.onNotification(r.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>s.onRequest(r.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>s.onNotification(r.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>s.sendNotification(r.PublishDiagnosticsNotification.type,e),onHover:e=>s.onRequest(r.HoverRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onCompletion:e=>s.onRequest(r.CompletionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCompletionResolve:e=>s.onRequest(r.CompletionResolveRequest.type,e),onSignatureHelp:e=>s.onRequest(r.SignatureHelpRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDeclaration:e=>s.onRequest(r.DeclarationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDefinition:e=>s.onRequest(r.DefinitionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onTypeDefinition:e=>s.onRequest(r.TypeDefinitionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onImplementation:e=>s.onRequest(r.ImplementationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onReferences:e=>s.onRequest(r.ReferencesRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentHighlight:e=>s.onRequest(r.DocumentHighlightRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentSymbol:e=>s.onRequest(r.DocumentSymbolRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onWorkspaceSymbol:e=>s.onRequest(r.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeAction:e=>s.onRequest(r.CodeActionRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeActionResolve:e=>s.onRequest(r.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>s.onRequest(r.CodeLensRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onCodeLensResolve:e=>s.onRequest(r.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>s.onRequest(r.DocumentFormattingRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDocumentRangeFormatting:e=>s.onRequest(r.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onDocumentOnTypeFormatting:e=>s.onRequest(r.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>s.onRequest(r.RenameRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),onPrepareRename:e=>s.onRequest(r.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>s.onRequest(r.DocumentLinkRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onDocumentLinkResolve:e=>s.onRequest(r.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>s.onRequest(r.DocumentColorRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onColorPresentation:e=>s.onRequest(r.ColorPresentationRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onFoldingRanges:e=>s.onRequest(r.FoldingRangeRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onSelectionRanges:e=>s.onRequest(r.SelectionRangeRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),a.attachPartialResult(s,t)))),onExecuteCommand:e=>s.onRequest(r.ExecuteCommandRequest.type,((t,n)=>e(t,n,a.attachWorkDone(s,t),void 0))),dispose:()=>s.dispose()};for(let e of y)e.attach(N);return s.onRequest(r.InitializeRequest.type,(e=>{t.initialize(e),o.string(e.trace)&&(c.trace=r.Trace.fromString(e.trace));for(let t of y)t.initialize(e.capabilities);if(v)return g(v(e,(new r.CancellationTokenSource).token,a.attachWorkDone(s,e),void 0)).then((e=>{if(e instanceof r.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=o.number(N.__textDocumentSync)?N.__textDocumentSync:r.TextDocumentSyncKind.None:o.number(n.textDocumentSync)||o.number(n.textDocumentSync.change)||(n.textDocumentSync.change=o.number(N.__textDocumentSync)?N.__textDocumentSync:r.TextDocumentSyncKind.None);for(let e of y)e.fillServerCapabilities(n);return t}));{let e={capabilities:{textDocumentSync:r.TextDocumentSyncKind.None}};for(let t of y)t.fillServerCapabilities(e.capabilities);return e}})),s.onRequest(r.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,T?T((new r.CancellationTokenSource).token):void 0))),s.onNotification(r.ExitNotification.type,(()=>{try{S&&S()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),s.onNotification(r.SetTraceNotification.type,(e=>{c.trace=r.Trace.fromString(e.value)})),N}},5421:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const r=n(273);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(r.ShowDocumentRequest.type,e)}}},289:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return"function"==typeof e}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=r,t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&r(e.then)}},7560:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class r extends n{constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}}function o(){return new r}r._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],r._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=o;const i=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return i.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return o().asHex()}},8634:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const r=n(273);t.WorkspaceFoldersFeature=e=>class extends e{initialize(e){let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new r.Emitter,this.connection.onNotification(r.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}getWorkspaceFolders(){return this.connection.sendRequest(r.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._unregistration||(this._unregistration=this.connection.client.register(r.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},7613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveModulePath=t.FileSystem=t.resolveGlobalYarnPath=t.resolveGlobalNodePath=t.resolve=t.uriToFilePath=void 0;const r=n(8835),o=n(5622),i=n(5747),a=n(3129);function s(){return"win32"===process.platform}function c(e,t,n,r){const s=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise(((c,u)=>{let l=process.env,p=Object.create(null);Object.keys(l).forEach((e=>p[e]=l[e])),t&&i.existsSync(t)&&(p.NODE_PATH?p.NODE_PATH=t+o.delimiter+p.NODE_PATH:p.NODE_PATH=t,r&&r(`NODE_PATH value is: ${p.NODE_PATH}`)),p.ELECTRON_RUN_AS_NODE="1";try{let t=a.fork("",[],{cwd:n,env:p,execArgv:["-e",s]});if(void 0===t.pid)return void u(new Error(`Starting process to resolve node module  ${e} failed`));t.on("error",(e=>{u(e)})),t.on("message",(n=>{"r"===n.c&&(t.send({c:"e"}),n.s?c(n.r):u(new Error(`Failed to resolve module: ${e}`)))}));let r={c:"rs",a:e};t.send(r)}catch(e){u(e)}}))}function u(e){let t="npm";const n=Object.create(null);Object.keys(process.env).forEach((e=>n[e]=process.env[e])),n.NO_UPDATE_NOTIFIER="true";const r={encoding:"utf8",env:n};s()&&(t="npm.cmd",r.shell=!0);let i=()=>{};try{process.on("SIGPIPE",i);let n=a.spawnSync(t,["config","get","prefix"],r).stdout;if(!n)return void(e&&e("'npm config get prefix' didn't return a value."));let c=n.trim();return e&&e(`'npm config get prefix' value is: ${c}`),c.length>0?s()?o.join(c,"node_modules"):o.join(c,"lib","node_modules"):void 0}catch(e){return}finally{process.removeListener("SIGPIPE",i)}}var l;t.uriToFilePath=function(e){let t=r.parse(e);if("file:"!==t.protocol||!t.path)return;let n=t.path.split("/");for(var i=0,a=n.length;i<a;i++)n[i]=decodeURIComponent(n[i]);if("win32"===process.platform&&n.length>1){let e=n[0],t=n[1];0===e.length&&t.length>1&&":"===t[1]&&n.shift()}return o.normalize(n.join("/"))},t.resolve=c,t.resolveGlobalNodePath=u,t.resolveGlobalYarnPath=function(e){let t="yarn",n={encoding:"utf8"};s()&&(t="yarn.cmd",n.shell=!0);let r=()=>{};try{process.on("SIGPIPE",r);let i=a.spawnSync(t,["global","dir","--json"],n),s=i.stdout;if(!s)return void(e&&(e("'yarn global dir' didn't return a value."),i.stderr&&e(i.stderr)));let c=s.trim().split(/\r?\n/);for(let e of c)try{let t=JSON.parse(e);if("log"===t.type)return o.join(t.data,"node_modules")}catch(e){}return}catch(e){return}finally{process.removeListener("SIGPIPE",r)}},function(e){let t;function n(){return void 0!==t||(t=!("win32"===process.platform||i.existsSync(__filename.toUpperCase())&&i.existsSync(__filename.toLowerCase()))),t}e.isCaseSensitive=n,e.isParent=function(e,t){return n()?0===o.normalize(t).indexOf(o.normalize(e)):0===o.normalize(t).toLowerCase().indexOf(o.normalize(e).toLowerCase())}}(l=t.FileSystem||(t.FileSystem={})),t.resolveModulePath=function(e,t,n,r){return n?(o.isAbsolute(n)||(n=o.join(e,n)),c(t,n,n,r).then((e=>l.isParent(n,e)?e:Promise.reject(new Error(`Failed to load ${t} from node path location.`)))).then(void 0,(n=>c(t,u(r),e,r)))):c(t,u(r),e,r)}},5809:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.Files=void 0;const i=n(289),a=n(9891),s=n(7613),c=n(6560);var u;o(n(6560),t),o(n(6265),t),(u=t.Files||(t.Files={})).uriToFilePath=s.uriToFilePath,u.resolveGlobalNodePath=s.resolveGlobalNodePath,u.resolveGlobalYarnPath=s.resolveGlobalYarnPath,u.resolve=s.resolve,u.resolveModulePath=s.resolveModulePath;let l,p=!1;!function(){const e="--clientProcessId";function t(e){try{let t=parseInt(e);isNaN(t)||(l=setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(p?0:1)}}),3e3))}catch(e){}}for(let n=2;n<process.argv.length;n++){let r=process.argv[n];if(r===e&&n+1<process.argv.length)return void t(process.argv[n+1]);{let n=r.split("=");n[0]===e&&t(n[1])}}}();const d={initialize:e=>{const t=e.processId;i.number(t)&&void 0===l&&setInterval((()=>{try{process.kill(t,0)}catch(e){process.exit(p?0:1)}}),3e3)},get shutdownReceived(){return p},set shutdownReceived(e){p=e},exit:e=>{process.exit(e)}};t.createConnection=function(e,t,n,r){let o,s,u,l;return void 0!==e&&"features"===e.__brand&&(o=e,e=t,t=n,n=r),c.ConnectionStrategy.is(e)||c.ConnectionOptions.is(e)?l=e:(s=e,u=t,l=n),function(e,t,n,r){if(!e&&!t&&process.argv.length>2){let n,r,i=process.argv.slice(2);for(let a=0;a<i.length;a++){let s=i[a];if("--node-ipc"===s){e=new c.IPCMessageReader(process),t=new c.IPCMessageWriter(process);break}if("--stdio"===s){e=process.stdin,t=process.stdout;break}if("--socket"===s){n=parseInt(i[a+1]);break}if("--pipe"===s){r=i[a+1];break}var o=s.split("=");if("--socket"===o[0]){n=parseInt(o[1]);break}if("--pipe"===o[0]){r=o[1];break}}if(n){let r=c.createServerSocketTransport(n);e=r[0],t=r[1]}else if(r){let n=c.createServerPipeTransport(r);e=n[0],t=n[1]}}var s="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!e)throw new Error("Connection input stream is not set. "+s);if(!t)throw new Error("Connection output stream is not set. "+s);if(i.func(e.read)&&i.func(e.on)){let t=e;t.on("end",(()=>{process.exit(p?0:1)})),t.on("close",(()=>{process.exit(p?0:1)}))}return a.createConnection((r=>c.createProtocolConnection(e,t,r,n)),d,r)}(s,u,l,o)}},8212:(e,t,n)=>{e.exports=n(5809)},2357:e=>{e.exports=require("assert")},3129:e=>{e.exports=require("child_process")},6417:e=>{e.exports=require("crypto")},5747:e=>{e.exports=require("fs")},1631:e=>{e.exports=require("net")},2087:e=>{e.exports=require("os")},5622:e=>{e.exports=require("path")},8835:e=>{e.exports=require("url")},1669:e=>{e.exports=require("util")}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=n(8212),t=n(5212);let r=!1,o=e.createConnection(new e.IPCMessageReader(process),new e.IPCMessageWriter(process)),i=new Map;function a(n,a){let s,c=[],u=new t.CompilerOptions;r?u.enableAllFeatures():u.enableDefaultFeatures();let l=new t.Parser(a,c,u).parse();s=new t.Analyzer(l,c,u).analyzeProgram();let p=c.map((n=>{const r=function(n){switch(n.type){case t.DiagnosticType.ParserError:case t.DiagnosticType.AnalyzerError:case t.DiagnosticType.InternalError:return e.DiagnosticSeverity.Error;case t.DiagnosticType.Warning:return e.DiagnosticSeverity.Warning;case t.DiagnosticType.Informational:return e.DiagnosticSeverity.Information;case t.DiagnosticType.UnreferencedCode:return e.DiagnosticSeverity.Hint}}(n),o=e.Diagnostic.create(e.Range.create(e.Position.create(n.range.start.line,n.range.start.character),e.Position.create(n.range.end.line,n.range.end.character)),n.message,r);return r===e.DiagnosticSeverity.Hint&&(o.tags=[1]),o}));o.sendDiagnostics({uri:n,diagnostics:p}),s&&i.set(n,{programText:a,analyzerResult:s})}o.onInitialize((n=>({capabilities:{textDocumentSync:e.TextDocumentSyncKind.Full,hoverProvider:!0,definitionProvider:!0,completionProvider:{triggerCharacters:[".","`"],resolveProvider:!1},semanticTokensProvider:{legend:t.SemanticTokenProvider.getLegend(),range:!1,full:{delta:!1}}}}))),o.languages.semanticTokens.on((e=>{const n=i.get(e.textDocument.uri);return n?{data:t.SemanticTokenProvider.getTokens(n.analyzerResult)}:{data:[]}})),o.onHover((e=>{const n=i.get(e.textDocument.uri);if(!n)return;const r=t.HoverProvider.getHoverForPosition(n.analyzerResult,new t.TextPosition(e.position.line,e.position.character));return r?{contents:r.parts.map((e=>e.isInkling?{language:"inkling",value:e.text}:e.text)),range:r.range}:void 0})),o.onDefinition((n=>{const r=i.get(n.textDocument.uri);if(!r)return;const o=t.DefinitionProvider.getDefinitionForPosition(r.analyzerResult,new t.TextPosition(n.position.line,n.position.character));return o?[e.Location.create(n.textDocument.uri,o)]:void 0})),o.onCompletion((n=>{const r=i.get(n.textDocument.uri);if(r)return{isIncomplete:!0,items:t.CompletionProvider.getCompletionsForPosition(r.programText,r.analyzerResult,new t.TextPosition(n.position.line,n.position.character)).map((n=>{const r=e.CompletionItem.create(n.label);return r.kind=function(n){switch(n){case t.CompletionItemKind.Constant:return e.CompletionItemKind.Constant;case t.CompletionItemKind.Variable:return e.CompletionItemKind.Variable;case t.CompletionItemKind.Function:return e.CompletionItemKind.Function;case t.CompletionItemKind.Field:return e.CompletionItemKind.Field;case t.CompletionItemKind.Namespace:return e.CompletionItemKind.Module;case t.CompletionItemKind.Keyword:return e.CompletionItemKind.Keyword;case t.CompletionItemKind.Type:case t.CompletionItemKind.Concept:case t.CompletionItemKind.Simulator:case t.CompletionItemKind.Data:default:return e.CompletionItemKind.Reference}}(n.kind),r.detail=n.detail,r.sortText=n.sortText,r.textEdit=n.textEdit,r.additionalTextEdits=n.additionalTextEdits,r}))}})),o.onDidChangeTextDocument((e=>{a(e.textDocument.uri,e.contentChanges[0].text)})),o.onDidOpenTextDocument((e=>{a(e.textDocument.uri,e.textDocument.text)})),o.onDidCloseTextDocument((e=>{o.sendDiagnostics({uri:e.textDocument.uri,diagnostics:[]}),i.delete(e.textDocument.uri)})),o.onDidChangeConfiguration((e=>{let t=e.settings;r=t.inkling.enableAllFeatures||!1,i.forEach(((e,t)=>{a(t,e.programText)}))})),o.onExecuteCommand((n=>"inkling.formatDocument"===n.command?n.arguments&&n.arguments.length>0&&n.arguments[0].text?function(e){let n=[];const r=new t.CompilerOptions(!0),o=new t.Parser(e,n,r).parse();if(!(n.length>0))return new t.Printer({}).printNode(o.parseTree)}(n.arguments[0].text):(o.console.error("inkling.formatDocument arguments incorrect"),new e.ResponseError(1,"File parameter not specified")):new e.ResponseError(1,"Unsupported command"))),o.listen()})()})();